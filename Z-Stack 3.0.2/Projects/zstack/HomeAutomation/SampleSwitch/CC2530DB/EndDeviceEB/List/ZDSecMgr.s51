///////////////////////////////////////////////////////////////////////////////
//
// IAR C/C++ Compiler V10.30.1.6000 for 8051              06/Aug/2020  10:11:27
// Copyright 2004-2018 IAR Systems AB.
// PC-locked license - IAR Embedded Workbench for 8051
//
//    Core               =  plain
//    Code model         =  banked
//    Data model         =  large
//    Calling convention =  xdata reentrant
//    Constant location  =  data_rom
//    Dptr setup         =  1,16
//                          
//    Source file        =  D:\AA\Z-Stack 3.0.2\Components\stack\zdo\ZDSecMgr.c
//    Command line       =  
//        -f C:\Users\sunli\AppData\Local\Temp\EW119F.tmp ("D:\AA\Z-Stack
//        3.0.2\Components\stack\zdo\ZDSecMgr.c" -D SECURE=1 -D TC_LINKKEY_JOIN
//        -D NV_INIT -D NV_RESTORE -D POWER_SAVING -D NWK_AUTO_POLL -D
//        xZTOOL_P1 -D xMT_TASK -D xMT_APP_FUNC -D xMT_SYS_FUNC -D xMT_ZDO_FUNC
//        -D xMT_ZDO_MGMT -D xMT_APP_CNF_FUNC -D LCD_SUPPORTED=DEBUG -D
//        MULTICAST_ENABLED=FALSE -D ZCL_READ -D ZCL_DISCOVER -D ZCL_WRITE -D
//        ZCL_BASIC -D ZCL_IDENTIFY -D ZCL_ON_OFF -D ZCL_GROUPS -D
//        BDB_TL_INITIATOR -D INTER_PAN -lC "D:\AA\Z-Stack
//        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\EndDeviceEB\List"
//        -lA "D:\AA\Z-Stack
//        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\EndDeviceEB\List"
//        --diag_suppress Pe001,Pa010 -o "D:\AA\Z-Stack
//        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\EndDeviceEB\Obj"
//        -e --debug --core=plain --dptr=16,1 --data_model=large
//        --code_model=banked --calling_convention=xdata_reentrant
//        --place_constants=data_rom --nr_virtual_regs 16 -f "D:\AA\Z-Stack
//        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\Tools\CC2530DB\f8wEndev.cfg"
//        (-DCPU32MHZ -DROOT=__near_func -DMAC_CFG_TX_DATA_MAX=3
//        -DMAC_CFG_TX_MAX=6 -DMAC_CFG_RX_MAX=3) -f "D:\AA\Z-Stack
//        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\Tools\CC2530DB\f8wConfig.cfg"
//        (-DZIGBEEPRO -DSECURE=1 -DZG_SECURE_DYNAMIC=0 -DREFLECTOR
//        -DDEFAULT_CHANLIST=0x00000800 -DZDAPP_CONFIG_PAN_ID=0xFFFF
//        -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MASK=0x007F
//        -DBEACON_REQUEST_DELAY=100 -DBEACON_REQ_DELAY_MASK=0x00FF
//        -DLINK_STATUS_JITTER_MASK=0x007F -DROUTE_EXPIRY_TIME=30
//        -DAPSC_ACK_WAIT_DURATION_POLLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7
//        -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3
//        -DNWK_MAX_DATA_RETRIES=2 -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9
//        -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40 -DNWK_MAX_BINDING_ENTRIES=4
//        -DMAX_BINDING_CLUSTER_IDS=4 -DDEFAULT_KEY={0}
//        -DMAC_MAX_FRAME_SIZE=116 -DZDNWKMGR_MIN_TRANSMISSIONS=20
//        "-DCONST=const __code" -DGENERIC=__generic -DRFD_RCVC_ALWAYS_ON=FALSE
//        -DPOLL_RATE=0 -DQUEUED_POLL_RATE=0 -DRESPONSE_POLL_RATE=0
//        -DREJOIN_POLL_RATE=0 -DREJOIN_BACKOFF=900000 -DREJOIN_SCAN=900000
//        -DENABLE_LED4_DISABLE_S1) -f "D:\AA\Z-Stack
//        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\Tools\CC2530DB\f8wZCL.cfg"
//        -I "D:\AA\Z-Stack
//        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\" -I
//        "D:\AA\Z-Stack
//        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\Source\"
//        -I "D:\AA\Z-Stack
//        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\Source\"
//        -I "D:\AA\Z-Stack
//        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\ZMain\TI2530DB\"
//        -I "D:\AA\Z-Stack
//        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\hal\include\"
//        -I "D:\AA\Z-Stack
//        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\hal\target\CC2530EB\"
//        -I "D:\AA\Z-Stack
//        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\mac\include\"
//        -I "D:\AA\Z-Stack
//        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\mac\high_level\"
//        -I "D:\AA\Z-Stack
//        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\mac\low_level\srf04\"
//        -I "D:\AA\Z-Stack
//        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\mac\low_level\srf04\single_chip\"
//        -I "D:\AA\Z-Stack
//        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\mt\"
//        -I "D:\AA\Z-Stack
//        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\osal\include\"
//        -I "D:\AA\Z-Stack
//        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\services\saddr\"
//        -I "D:\AA\Z-Stack
//        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\services\sdata\"
//        -I "D:\AA\Z-Stack
//        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\stack\af\"
//        -I "D:\AA\Z-Stack
//        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\stack\bdb\"
//        -I "D:\AA\Z-Stack
//        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\stack\gp\"
//        -I "D:\AA\Z-Stack
//        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\stack\nwk\"
//        -I "D:\AA\Z-Stack
//        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\stack\sapi\"
//        -I "D:\AA\Z-Stack
//        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\stack\sec\"
//        -I "D:\AA\Z-Stack
//        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\stack\sys\"
//        -I "D:\AA\Z-Stack
//        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\stack\zcl\"
//        -I "D:\AA\Z-Stack
//        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\stack\zdo\"
//        -I "D:\AA\Z-Stack
//        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\zmac\"
//        -I "D:\AA\Z-Stack
//        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\zmac\f8w\"
//        -On --require_prototypes --no_cse --no_unroll --no_inline
//        --no_code_motion --no_tbaa --no_cross_call)
//    Locale             =  Chinese (Simplified)_CHN.936
//    List file          =  
//        D:\AA\Z-Stack
//        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\EndDeviceEB\List\ZDSecMgr.s51
//
///////////////////////////////////////////////////////////////////////////////

        NAME ZDSecMgr

        RTMODEL "__SystemLibrary", "CLib"
        RTMODEL "__calling_convention", "xdata_reentrant"
        RTMODEL "__code_model", "banked"
        RTMODEL "__core", "plain"
        RTMODEL "__data_model", "large"
        RTMODEL "__dptr_size", "16"
        RTMODEL "__extended_stack", "disabled"
        RTMODEL "__location_for_constants", "data"
        RTMODEL "__number_of_dptrs", "1"
        RTMODEL "__register_banks", "*"
        RTMODEL "__rt_version", "1"

        RSEG DOVERLAY:DATA:NOROOT(0)
        RSEG IOVERLAY:IDATA:NOROOT(0)
        RSEG ISTACK:IDATA:NOROOT(0)
        RSEG PSTACK:XDATA:NOROOT(0)
        RSEG XSTACK:XDATA:NOROOT(0)

        EXTERN ?V0
        EXTERN ?V1
        EXTERN ?V2
        EXTERN ?V3
        EXTERN ?V4
        EXTERN ?V5
        EXTERN ?V6
        EXTERN ?V7
        EXTERN ?V8
        EXTERN ?V9
        EXTERN ?V10
        EXTERN ?V11
        EXTERN ?V12
        EXTERN ?V13
        EXTERN ?V14
        EXTERN ?V15
        EXTERN ?ALLOC_XSTACK8
        EXTERN ?BANKED_ENTER_XDATA
        EXTERN ?BANKED_LEAVE_XDATA
        EXTERN ?BDISPATCH
        EXTERN ?BRET
        EXTERN ?CALL_IND
        EXTERN ?DEALLOC_XSTACK8
        EXTERN ?L_ADD_TO_X
        EXTERN ?L_ADD_X
        EXTERN ?L_MOV_X
        EXTERN ?MOVE_LONG8_XDATA_XDATA
        EXTERN ?PUSH_XSTACK8_X_TWO
        EXTERN ?PUSH_XSTACK_I_THREE
        EXTERN ?PUSH_XSTACK_I_TWO
        EXTERN ?UL_DIV_MOD
        EXTERN ?UL_GT_X
        EXTERN ?XLOAD_R0123
        EXTERN ?XSP
        EXTERN ?XSTACK_DISP0_8
        EXTERN ?XSTACK_DISP100_8
        EXTERN ?XSTACK_DISP101_8
        EXTERN ?XSTACK_DISP102_8
        EXTERN ?XSTORE_R0123
        EXTERN __INIT_XDATA_I
        EXTERN __INIT_XDATA_Z

        PUBLIC `??APSME_IsDefaultTCLK::?relay`
        FUNCTION `??APSME_IsDefaultTCLK::?relay`,0203H
        PUBLIC `??APSME_IsLinkKeyValid::?relay`
        FUNCTION `??APSME_IsLinkKeyValid::?relay`,0203H
        PUBLIC `??APSME_KeyFwdToChild::?relay`
        FUNCTION `??APSME_KeyFwdToChild::?relay`,0203H
        PUBLIC `??APSME_LinkKeyNVIdGet::?relay`
        FUNCTION `??APSME_LinkKeyNVIdGet::?relay`,0203H
        PUBLIC `??APSME_LinkKeySet::?relay`
        FUNCTION `??APSME_LinkKeySet::?relay`,0203H
        PUBLIC `??APSME_TCLinkKeyInit::?relay`
        FUNCTION `??APSME_TCLinkKeyInit::?relay`,0203H
        PUBLIC `??APSME_TCLinkKeyLoad::?relay`
        FUNCTION `??APSME_TCLinkKeyLoad::?relay`,0203H
        PUBLIC `??APSME_TCLinkKeySync::?relay`
        FUNCTION `??APSME_TCLinkKeySync::?relay`,0203H
        PUBLIC `??ZDSecMgrAPSRemove::?relay`
        FUNCTION `??ZDSecMgrAPSRemove::?relay`,0203H
        PUBLIC `??ZDSecMgrAddLinkKey::?relay`
        FUNCTION `??ZDSecMgrAddLinkKey::?relay`,0203H
        PUBLIC `??ZDSecMgrAddrClear::?relay`
        FUNCTION `??ZDSecMgrAddrClear::?relay`,0203H
        PUBLIC `??ZDSecMgrAddrStore::?relay`
        FUNCTION `??ZDSecMgrAddrStore::?relay`,0203H
        PUBLIC `??ZDSecMgrAppConfKeyReq::?relay`
        FUNCTION `??ZDSecMgrAppConfKeyReq::?relay`,0203H
        PUBLIC `??ZDSecMgrAppKeyGet::?relay`
        FUNCTION `??ZDSecMgrAppKeyGet::?relay`,0203H
        PUBLIC `??ZDSecMgrAppKeyReq::?relay`
        FUNCTION `??ZDSecMgrAppKeyReq::?relay`,0203H
        PUBLIC `??ZDSecMgrApsLinkKeyInit::?relay`
        FUNCTION `??ZDSecMgrApsLinkKeyInit::?relay`,0203H
        PUBLIC `??ZDSecMgrAssocDeviceAuth::?relay`
        FUNCTION `??ZDSecMgrAssocDeviceAuth::?relay`,0203H
        PUBLIC `??ZDSecMgrAuthNwkKey::?relay`
        FUNCTION `??ZDSecMgrAuthNwkKey::?relay`,0203H
        PUBLIC `??ZDSecMgrAuthenticationCheck::?relay`
        FUNCTION `??ZDSecMgrAuthenticationCheck::?relay`,0203H
        PUBLIC `??ZDSecMgrAuthenticationSet::?relay`
        FUNCTION `??ZDSecMgrAuthenticationSet::?relay`,0203H
        PUBLIC `??ZDSecMgrClearNVKeyValues::?relay`
        FUNCTION `??ZDSecMgrClearNVKeyValues::?relay`,0203H
        PUBLIC `??ZDSecMgrConfig::?relay`
        FUNCTION `??ZDSecMgrConfig::?relay`,0203H
        PUBLIC `??ZDSecMgrDeviceJoin::?relay`
        FUNCTION `??ZDSecMgrDeviceJoin::?relay`,0203H
        PUBLIC `??ZDSecMgrDeviceJoinDirect::?relay`
        FUNCTION `??ZDSecMgrDeviceJoinDirect::?relay`,0203H
        PUBLIC `??ZDSecMgrDeviceJoinFwd::?relay`
        FUNCTION `??ZDSecMgrDeviceJoinFwd::?relay`,0203H
        PUBLIC `??ZDSecMgrDeviceNew::?relay`
        FUNCTION `??ZDSecMgrDeviceNew::?relay`,0203H
        PUBLIC `??ZDSecMgrDeviceRemove::?relay`
        FUNCTION `??ZDSecMgrDeviceRemove::?relay`,0203H
        PUBLIC `??ZDSecMgrDeviceRemoveByExtAddr::?relay`
        FUNCTION `??ZDSecMgrDeviceRemoveByExtAddr::?relay`,0203H
        PUBLIC `??ZDSecMgrDeviceValidate::?relay`
        FUNCTION `??ZDSecMgrDeviceValidate::?relay`,0203H
        PUBLIC `??ZDSecMgrDeviceValidateRM::?relay`
        FUNCTION `??ZDSecMgrDeviceValidateRM::?relay`,0203H
        PUBLIC `??ZDSecMgrEntryFree::?relay`
        FUNCTION `??ZDSecMgrEntryFree::?relay`,0203H
        PUBLIC `??ZDSecMgrEntryInit::?relay`
        FUNCTION `??ZDSecMgrEntryInit::?relay`,0203H
        PUBLIC `??ZDSecMgrEntryLookup::?relay`
        FUNCTION `??ZDSecMgrEntryLookup::?relay`,0203H
        PUBLIC `??ZDSecMgrEntryLookupAMI::?relay`
        FUNCTION `??ZDSecMgrEntryLookupAMI::?relay`,0203H
        PUBLIC `??ZDSecMgrEntryLookupAMIGetIndex::?relay`
        FUNCTION `??ZDSecMgrEntryLookupAMIGetIndex::?relay`,0203H
        PUBLIC `??ZDSecMgrEntryLookupExt::?relay`
        FUNCTION `??ZDSecMgrEntryLookupExt::?relay`,0203H
        PUBLIC `??ZDSecMgrEntryLookupExtGetIndex::?relay`
        FUNCTION `??ZDSecMgrEntryLookupExtGetIndex::?relay`,0203H
        PUBLIC `??ZDSecMgrEntryNew::?relay`
        FUNCTION `??ZDSecMgrEntryNew::?relay`,0203H
        PUBLIC `??ZDSecMgrExtAddrLookup::?relay`
        FUNCTION `??ZDSecMgrExtAddrLookup::?relay`,0203H
        PUBLIC `??ZDSecMgrExtAddrStore::?relay`
        FUNCTION `??ZDSecMgrExtAddrStore::?relay`,0203H
        PUBLIC `??ZDSecMgrGenerateKeyFromSeed::?relay`
        FUNCTION `??ZDSecMgrGenerateKeyFromSeed::?relay`,0203H
        PUBLIC `??ZDSecMgrGenerateRndKey::?relay`
        FUNCTION `??ZDSecMgrGenerateRndKey::?relay`,0203H
        PUBLIC `??ZDSecMgrGenerateSeed::?relay`
        FUNCTION `??ZDSecMgrGenerateSeed::?relay`,0203H
        PUBLIC `??ZDSecMgrInit::?relay`
        FUNCTION `??ZDSecMgrInit::?relay`,0203H
        PUBLIC `??ZDSecMgrInitNV::?relay`
        FUNCTION `??ZDSecMgrInitNV::?relay`,0203H
        PUBLIC `??ZDSecMgrInitNVKeyTables::?relay`
        FUNCTION `??ZDSecMgrInitNVKeyTables::?relay`,0203H
        PUBLIC `??ZDSecMgrNewDeviceEvent::?relay`
        FUNCTION `??ZDSecMgrNewDeviceEvent::?relay`,0203H
        PUBLIC `??ZDSecMgrNwkKeyInit::?relay`
        FUNCTION `??ZDSecMgrNwkKeyInit::?relay`,0203H
        PUBLIC `??ZDSecMgrPermitJoining::?relay`
        FUNCTION `??ZDSecMgrPermitJoining::?relay`,0203H
        PUBLIC `??ZDSecMgrPermitJoiningTimeout::?relay`
        FUNCTION `??ZDSecMgrPermitJoiningTimeout::?relay`,0203H
        PUBLIC `??ZDSecMgrReadKeyFromNv::?relay`
        FUNCTION `??ZDSecMgrReadKeyFromNv::?relay`,0203H
        PUBLIC `??ZDSecMgrRemoveDeviceInd::?relay`
        FUNCTION `??ZDSecMgrRemoveDeviceInd::?relay`,0203H
        PUBLIC `??ZDSecMgrRequestAppKey::?relay`
        FUNCTION `??ZDSecMgrRequestAppKey::?relay`,0203H
        PUBLIC `??ZDSecMgrRequestKeyInd::?relay`
        FUNCTION `??ZDSecMgrRequestKeyInd::?relay`,0203H
        FUNCTION `??ZDSecMgrRestoreFromNV::?relay`,0203H
        PUBLIC `??ZDSecMgrSaveApsLinkKey::?relay`
        FUNCTION `??ZDSecMgrSaveApsLinkKey::?relay`,0203H
        PUBLIC `??ZDSecMgrSaveTCLinkKey::?relay`
        FUNCTION `??ZDSecMgrSaveTCLinkKey::?relay`,0203H
        PUBLIC `??ZDSecMgrSendNwkKey::?relay`
        FUNCTION `??ZDSecMgrSendNwkKey::?relay`,0203H
        PUBLIC `??ZDSecMgrSetDefaultNV::?relay`
        FUNCTION `??ZDSecMgrSetDefaultNV::?relay`,0203H
        PUBLIC `??ZDSecMgrSetupPartner::?relay`
        FUNCTION `??ZDSecMgrSetupPartner::?relay`,0203H
        PUBLIC `??ZDSecMgrSwitchKeyInd::?relay`
        FUNCTION `??ZDSecMgrSwitchKeyInd::?relay`,0203H
        PUBLIC `??ZDSecMgrTCDataLoad::?relay`
        FUNCTION `??ZDSecMgrTCDataLoad::?relay`,0203H
        PUBLIC `??ZDSecMgrTCExtAddrCheck::?relay`
        FUNCTION `??ZDSecMgrTCExtAddrCheck::?relay`,0203H
        PUBLIC `??ZDSecMgrTclkReq::?relay`
        FUNCTION `??ZDSecMgrTclkReq::?relay`,0203H
        PUBLIC `??ZDSecMgrTransportKeyInd::?relay`
        FUNCTION `??ZDSecMgrTransportKeyInd::?relay`,0203H
        PUBLIC `??ZDSecMgrUpdateDeviceInd::?relay`
        FUNCTION `??ZDSecMgrUpdateDeviceInd::?relay`,0203H
        FUNCTION `??ZDSecMgrUpdateNV::?relay`,0203H
        PUBLIC `??ZDSecMgrUpdateTCAddress::?relay`
        FUNCTION `??ZDSecMgrUpdateTCAddress::?relay`,0203H
        PUBLIC `??ZDSecMgrVerifyKeyInd::?relay`
        FUNCTION `??ZDSecMgrVerifyKeyInd::?relay`,0203H
        FUNCTION `??ZDSecMgrWriteNV::?relay`,0203H
        PUBLIC APSME_IsDefaultTCLK
        FUNCTION APSME_IsDefaultTCLK,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        PUBLIC APSME_IsLinkKeyValid
        FUNCTION APSME_IsLinkKeyValid,0a1203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 37, STACK
        PUBLIC APSME_KeyFwdToChild
        FUNCTION APSME_KeyFwdToChild,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        PUBLIC APSME_LinkKeyNVIdGet
        FUNCTION APSME_LinkKeyNVIdGet,0a1203H
        ARGFRAME XSTACK, 33, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 13, STACK
        PUBLIC APSME_LinkKeySet
        FUNCTION APSME_LinkKeySet,0a1203H
        ARGFRAME XSTACK, 54, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 26, STACK
        PUBLIC APSME_TCLinkKeyInit
        FUNCTION APSME_TCLinkKeyInit,0a1203H
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 39, STACK
        PUBLIC APSME_TCLinkKeyLoad
        FUNCTION APSME_TCLinkKeyLoad,0a1203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME XSTACK, 61, STACK
        PUBLIC APSME_TCLinkKeySync
        FUNCTION APSME_TCLinkKeySync,0a1203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME XSTACK, 53, STACK
        PUBLIC ApsLinkKeyFrmCntr
        PUBLIC TCLinkKeyFrmCntr
        PUBLIC TrustCenterLinkKey
        PUBLIC ZDSecMgrAPSRemove
        FUNCTION ZDSecMgrAPSRemove,0a1203H
        ARGFRAME XSTACK, 2, STACK
        LOCFRAME XSTACK, 20, STACK
        PUBLIC ZDSecMgrAddLinkKey
        FUNCTION ZDSecMgrAddLinkKey,0a1203H
        ARGFRAME XSTACK, 2, STACK
        LOCFRAME XSTACK, 20, STACK
        PUBLIC ZDSecMgrAddrClear
        FUNCTION ZDSecMgrAddrClear,0a1203H
        ARGFRAME XSTACK, 35, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 24, STACK
        PUBLIC ZDSecMgrAddrStore
        FUNCTION ZDSecMgrAddrStore,0a1203H
        ARGFRAME XSTACK, 56, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 26, STACK
        PUBLIC ZDSecMgrAppConfKeyReq
        FUNCTION ZDSecMgrAppConfKeyReq,0203H
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 3, STACK
        LOCFRAME XSTACK, 6, STACK
        PUBLIC ZDSecMgrAppKeyGet
        FUNCTION ZDSecMgrAppKeyGet,0a1203H
        ARGFRAME XSTACK, 57, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME XSTACK, 14, STACK
        PUBLIC ZDSecMgrAppKeyReq
        FUNCTION ZDSecMgrAppKeyReq,0a1203H
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 57, STACK
        PUBLIC ZDSecMgrAppKeyType
        PUBLIC ZDSecMgrApsLinkKeyInit
        FUNCTION ZDSecMgrApsLinkKeyInit,0a1203H
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 40, STACK
        PUBLIC ZDSecMgrAssocDeviceAuth
        FUNCTION ZDSecMgrAssocDeviceAuth,0203H
        ARGFRAME XSTACK, 36, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 2, STACK
        PUBLIC ZDSecMgrAuthNwkKey
        FUNCTION ZDSecMgrAuthNwkKey,021203H
        ARGFRAME XSTACK, 54, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 2, STACK
        PUBLIC ZDSecMgrAuthenticationCheck
        FUNCTION ZDSecMgrAuthenticationCheck,0a1203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        PUBLIC ZDSecMgrAuthenticationSet
        FUNCTION ZDSecMgrAuthenticationSet,0a1203H
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME XSTACK, 12, STACK
        PUBLIC ZDSecMgrClearNVKeyValues
        FUNCTION ZDSecMgrClearNVKeyValues,0a1203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 52, STACK
        PUBLIC ZDSecMgrConfig
        FUNCTION ZDSecMgrConfig,021203H
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 2, STACK
        PUBLIC ZDSecMgrDeviceJoin
        FUNCTION ZDSecMgrDeviceJoin,0a1203H
        ARGFRAME XSTACK, 36, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 32, STACK
        PUBLIC ZDSecMgrDeviceJoinDirect
        FUNCTION ZDSecMgrDeviceJoinDirect,0a1203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 40, STACK
        PUBLIC ZDSecMgrDeviceJoinFwd
        FUNCTION ZDSecMgrDeviceJoinFwd,0a1203H
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 31, STACK
        PUBLIC ZDSecMgrDeviceNew
        FUNCTION ZDSecMgrDeviceNew,0a1203H
        ARGFRAME XSTACK, 35, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 9, STACK
        PUBLIC ZDSecMgrDeviceRemove
        FUNCTION ZDSecMgrDeviceRemove,0a1203H
        ARGFRAME XSTACK, 29, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 33, STACK
        PUBLIC ZDSecMgrDeviceRemoveByExtAddr
        FUNCTION ZDSecMgrDeviceRemoveByExtAddr,0a1203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 11, STACK
        PUBLIC ZDSecMgrDeviceValidate
        FUNCTION ZDSecMgrDeviceValidate,0a1203H
        ARGFRAME XSTACK, 29, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 9, STACK
        PUBLIC ZDSecMgrDeviceValidateRM
        FUNCTION ZDSecMgrDeviceValidateRM,0203H
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 2, STACK
        PUBLIC ZDSecMgrEntries
        PUBLIC ZDSecMgrEntryFree
        FUNCTION ZDSecMgrEntryFree,0a1203H
        ARGFRAME XSTACK, 11, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 20, STACK
        PUBLIC ZDSecMgrEntryInit
        FUNCTION ZDSecMgrEntryInit,0a1203H
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 9, STACK
        PUBLIC ZDSecMgrEntryLookup
        FUNCTION ZDSecMgrEntryLookup,0a1203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 25, STACK
        PUBLIC ZDSecMgrEntryLookupAMI
        FUNCTION ZDSecMgrEntryLookupAMI,080203H
        ARGFRAME XSTACK, 54, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 9, STACK
        PUBLIC ZDSecMgrEntryLookupAMIGetIndex
        FUNCTION ZDSecMgrEntryLookupAMIGetIndex,080203H
        ARGFRAME XSTACK, 16, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 9, STACK
        PUBLIC ZDSecMgrEntryLookupExt
        FUNCTION ZDSecMgrEntryLookupExt,0a1203H
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 13, STACK
        PUBLIC ZDSecMgrEntryLookupExtGetIndex
        FUNCTION ZDSecMgrEntryLookupExtGetIndex,0a1203H
        ARGFRAME XSTACK, 24, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 16, STACK
        PUBLIC ZDSecMgrEntryNew
        FUNCTION ZDSecMgrEntryNew,0203H
        ARGFRAME XSTACK, 54, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 9, STACK
        PUBLIC ZDSecMgrExtAddrLookup
        FUNCTION ZDSecMgrExtAddrLookup,0a1203H
        ARGFRAME XSTACK, 54, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 24, STACK
        PUBLIC ZDSecMgrExtAddrStore
        FUNCTION ZDSecMgrExtAddrStore,0a1203H
        ARGFRAME XSTACK, 2, STACK
        LOCFRAME XSTACK, 26, STACK
        PUBLIC ZDSecMgrGenerateKeyFromSeed
        FUNCTION ZDSecMgrGenerateKeyFromSeed,0a1203H
        ARGFRAME XSTACK, 69, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 36, STACK
        PUBLIC ZDSecMgrGenerateRndKey
        FUNCTION ZDSecMgrGenerateRndKey,0a1203H
        ARGFRAME XSTACK, 26, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME XSTACK, 14, STACK
        PUBLIC ZDSecMgrGenerateSeed
        FUNCTION ZDSecMgrGenerateSeed,0a1203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 30, STACK
        PUBLIC ZDSecMgrInit
        FUNCTION ZDSecMgrInit,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        PUBLIC ZDSecMgrInitNV
        FUNCTION ZDSecMgrInitNV,0a1203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 16, STACK
        PUBLIC ZDSecMgrInitNVKeyTables
        FUNCTION ZDSecMgrInitNVKeyTables,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        PUBLIC ZDSecMgrNewDeviceEvent
        FUNCTION ZDSecMgrNewDeviceEvent,0a1203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME XSTACK, 35, STACK
        PUBLIC ZDSecMgrNwkKeyInit
        FUNCTION ZDSecMgrNwkKeyInit,0a1203H
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 66, STACK
        PUBLIC ZDSecMgrPermitJoining
        FUNCTION ZDSecMgrPermitJoining,0203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME ISTACK, 2, STACK
        PUBLIC ZDSecMgrPermitJoiningEnabled
        PUBLIC ZDSecMgrPermitJoiningTimed
        PUBLIC ZDSecMgrPermitJoiningTimeout
        FUNCTION ZDSecMgrPermitJoiningTimeout,0203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME ISTACK, 2, STACK
        PUBLIC ZDSecMgrReadKeyFromNv
        FUNCTION ZDSecMgrReadKeyFromNv,0a1203H
        ARGFRAME XSTACK, 54, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 19, STACK
        PUBLIC ZDSecMgrRemoveDeviceInd
        FUNCTION ZDSecMgrRemoveDeviceInd,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 17, STACK
        PUBLIC ZDSecMgrRequestAppKey
        FUNCTION ZDSecMgrRequestAppKey,0a1203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 13, STACK
        PUBLIC ZDSecMgrRequestKeyInd
        FUNCTION ZDSecMgrRequestKeyInd,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        FUNCTION ZDSecMgrRestoreFromNV,0a1203H
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 22, STACK
        PUBLIC ZDSecMgrSaveApsLinkKey
        FUNCTION ZDSecMgrSaveApsLinkKey,0a1203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 16, STACK
        PUBLIC ZDSecMgrSaveTCLinkKey
        FUNCTION ZDSecMgrSaveTCLinkKey,0a1203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 16, STACK
        PUBLIC ZDSecMgrSendNwkKey
        FUNCTION ZDSecMgrSendNwkKey,0a1203H
        ARGFRAME XSTACK, 29, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME XSTACK, 50, STACK
        PUBLIC ZDSecMgrSetDefaultNV
        FUNCTION ZDSecMgrSetDefaultNV,0a1203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 23, STACK
        PUBLIC ZDSecMgrSetupPartner
        FUNCTION ZDSecMgrSetupPartner,0a1203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 25, STACK
        PUBLIC ZDSecMgrSwitchKeyInd
        FUNCTION ZDSecMgrSwitchKeyInd,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        PUBLIC ZDSecMgrTCAuthenticated
        PUBLIC ZDSecMgrTCDataLoad
        FUNCTION ZDSecMgrTCDataLoad,0a1203H
        ARGFRAME XSTACK, 54, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 27, STACK
        PUBLIC ZDSecMgrTCExtAddr
        PUBLIC ZDSecMgrTCExtAddrCheck
        FUNCTION ZDSecMgrTCExtAddrCheck,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 17, STACK
        PUBLIC ZDSecMgrTclkReq
        FUNCTION ZDSecMgrTclkReq,0a1203H
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 71, STACK
        PUBLIC ZDSecMgrTransportKeyInd
        FUNCTION ZDSecMgrTransportKeyInd,0a1203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 58, STACK
        PUBLIC ZDSecMgrUpdateDeviceInd
        FUNCTION ZDSecMgrUpdateDeviceInd,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 17, STACK
        FUNCTION ZDSecMgrUpdateNV,0a1203H
        ARGFRAME XSTACK, 16, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 16, STACK
        PUBLIC ZDSecMgrUpdateTCAddress
        FUNCTION ZDSecMgrUpdateTCAddress,0a1203H
        ARGFRAME XSTACK, 54, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 22, STACK
        PUBLIC ZDSecMgrVerifyKeyInd
        FUNCTION ZDSecMgrVerifyKeyInd,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        FUNCTION ZDSecMgrWriteNV,0a1203H
        ARGFRAME XSTACK, 54, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 16, STACK
        PUBWEAK __Constant_1
        PUBWEAK __Constant_3e9
        PUBWEAK __Constant_a
        PUBWEAK __Constant_b
        PUBLIC gZDSECMGR_TC_ATTEMPT_DEFAULT_KEY
        PUBLIC gZDSECMGR_TC_DEVICE_IC_MAX
        PUBLIC gZDSECMGR_TC_DEVICE_MAX
        PUBLIC requestLinkKeyTimeout
        PUBLIC requestNewTrustCenterLinkKey
        
          CFI Names cfiNames0
          CFI StackFrame CFA_SP SP IDATA
          CFI StackFrame CFA_PSP16 PSP16 XDATA
          CFI StackFrame CFA_XSP16 XSP16 XDATA
          CFI StaticOverlayFrame CFA_IOVERLAY IOVERLAY
          CFI StaticOverlayFrame CFA_DOVERLAY DOVERLAY
          CFI Resource `PSW.CY`:1, `B.BR0`:1, `B.BR1`:1, `B.BR2`:1, `B.BR3`:1
          CFI Resource `B.BR4`:1, `B.BR5`:1, `B.BR6`:1, `B.BR7`:1, `VB.BR8`:1
          CFI Resource `VB.BR9`:1, `VB.BR10`:1, `VB.BR11`:1, `VB.BR12`:1
          CFI Resource `VB.BR13`:1, `VB.BR14`:1, `VB.BR15`:1, VB:8, B:8, A:8
          CFI Resource PSW:8, DPL0:8, DPH0:8, R0:8, R1:8, R2:8, R3:8, R4:8, R5:8
          CFI Resource R6:8, R7:8, V0:8, V1:8, V2:8, V3:8, V4:8, V5:8, V6:8, V7:8
          CFI Resource V8:8, V9:8, V10:8, V11:8, V12:8, V13:8, V14:8, V15:8, SP:8
          CFI Resource PSPH:8, PSPL:8, PSP16:16, XSPH:8, XSPL:8, XSP16:16
          CFI VirtualResource ?RET:24
          CFI Resource ?BRET_EXT:8
          CFI VirtualResource ?RET_HIGH:8, ?RET_LOW:8
          CFI ResourceParts PSP16 PSPH, PSPL
          CFI ResourceParts XSP16 XSPH, XSPL
          CFI ResourceParts ?RET ?BRET_EXT, ?RET_HIGH, ?RET_LOW
          CFI EndNames cfiNames0
        
          CFI Common cfiCommon0 Using cfiNames0
          CFI CodeAlign 1
          CFI DataAlign -1
          CFI ReturnAddress ?RET CODE
          CFI CFA_DOVERLAY Used
          CFI CFA_IOVERLAY Used
          CFI CFA_SP SP+-3
          CFI CFA_PSP16 PSP16+0
          CFI CFA_XSP16 XSP16+0
          CFI `PSW.CY` SameValue
          CFI `B.BR0` SameValue
          CFI `B.BR1` SameValue
          CFI `B.BR2` SameValue
          CFI `B.BR3` SameValue
          CFI `B.BR4` SameValue
          CFI `B.BR5` SameValue
          CFI `B.BR6` SameValue
          CFI `B.BR7` SameValue
          CFI `VB.BR8` SameValue
          CFI `VB.BR9` SameValue
          CFI `VB.BR10` SameValue
          CFI `VB.BR11` SameValue
          CFI `VB.BR12` SameValue
          CFI `VB.BR13` SameValue
          CFI `VB.BR14` SameValue
          CFI `VB.BR15` SameValue
          CFI VB SameValue
          CFI B Undefined
          CFI A Undefined
          CFI PSW SameValue
          CFI DPL0 SameValue
          CFI DPH0 SameValue
          CFI R0 Undefined
          CFI R1 Undefined
          CFI R2 Undefined
          CFI R3 Undefined
          CFI R4 Undefined
          CFI R5 Undefined
          CFI R6 SameValue
          CFI R7 SameValue
          CFI V0 SameValue
          CFI V1 SameValue
          CFI V2 SameValue
          CFI V3 SameValue
          CFI V4 SameValue
          CFI V5 SameValue
          CFI V6 SameValue
          CFI V7 SameValue
          CFI V8 SameValue
          CFI V9 SameValue
          CFI V10 SameValue
          CFI V11 SameValue
          CFI V12 SameValue
          CFI V13 SameValue
          CFI V14 SameValue
          CFI V15 SameValue
          CFI PSPH Undefined
          CFI PSPL Undefined
          CFI XSPH Undefined
          CFI XSPL Undefined
          CFI ?RET Concat
          CFI ?BRET_EXT Frame(CFA_SP, 3)
          CFI ?RET_HIGH Frame(CFA_SP, 2)
          CFI ?RET_LOW Frame(CFA_SP, 1)
          CFI EndCommon cfiCommon0
        
APSME_EraseICEntry  SYMBOL "APSME_EraseICEntry"
`??APSME_EraseICEntry::?relay` SYMBOL "?relay", APSME_EraseICEntry
APSME_GetRequest    SYMBOL "APSME_GetRequest"
`??APSME_GetRequest::?relay` SYMBOL "?relay", APSME_GetRequest
APSME_IsDistributedSecurity SYMBOL "APSME_IsDistributedSecurity"
`??APSME_IsDistributedSecurity::?relay` SYMBOL "?relay", APSME_IsDistributedSecurity
APSME_LookupExtAddr SYMBOL "APSME_LookupExtAddr"
`??APSME_LookupExtAddr::?relay` SYMBOL "?relay", APSME_LookupExtAddr
APSME_LookupNwkAddr SYMBOL "APSME_LookupNwkAddr"
`??APSME_LookupNwkAddr::?relay` SYMBOL "?relay", APSME_LookupNwkAddr
APSME_RemoveDeviceReq SYMBOL "APSME_RemoveDeviceReq"
`??APSME_RemoveDeviceReq::?relay` SYMBOL "?relay", APSME_RemoveDeviceReq
APSME_RequestKeyReq SYMBOL "APSME_RequestKeyReq"
`??APSME_RequestKeyReq::?relay` SYMBOL "?relay", APSME_RequestKeyReq
APSME_SearchTCLinkKeyEntry SYMBOL "APSME_SearchTCLinkKeyEntry"
`??APSME_SearchTCLinkKeyEntry::?relay` SYMBOL "?relay", APSME_SearchTCLinkKeyEntry
APSME_SecurityCM_ED SYMBOL "APSME_SecurityCM_ED"
`??APSME_SecurityCM_ED::?relay` SYMBOL "?relay", APSME_SecurityCM_ED
APSME_SetRequest    SYMBOL "APSME_SetRequest"
`??APSME_SetRequest::?relay` SYMBOL "?relay", APSME_SetRequest
APSME_TransportKeyReq SYMBOL "APSME_TransportKeyReq"
`??APSME_TransportKeyReq::?relay` SYMBOL "?relay", APSME_TransportKeyReq
APSME_UpdateDeviceReq SYMBOL "APSME_UpdateDeviceReq"
`??APSME_UpdateDeviceReq::?relay` SYMBOL "?relay", APSME_UpdateDeviceReq
AddrMgrEntryGet     SYMBOL "AddrMgrEntryGet"
`??AddrMgrEntryGet::?relay` SYMBOL "?relay", AddrMgrEntryGet
AddrMgrEntryLookupExt SYMBOL "AddrMgrEntryLookupExt"
`??AddrMgrEntryLookupExt::?relay` SYMBOL "?relay", AddrMgrEntryLookupExt
AddrMgrEntryLookupNwk SYMBOL "AddrMgrEntryLookupNwk"
`??AddrMgrEntryLookupNwk::?relay` SYMBOL "?relay", AddrMgrEntryLookupNwk
AddrMgrEntryRelease SYMBOL "AddrMgrEntryRelease"
`??AddrMgrEntryRelease::?relay` SYMBOL "?relay", AddrMgrEntryRelease
AddrMgrEntryUpdate  SYMBOL "AddrMgrEntryUpdate"
`??AddrMgrEntryUpdate::?relay` SYMBOL "?relay", AddrMgrEntryUpdate
AddrMgrExtAddrLookup SYMBOL "AddrMgrExtAddrLookup"
`??AddrMgrExtAddrLookup::?relay` SYMBOL "?relay", AddrMgrExtAddrLookup
AddrMgrExtAddrSet   SYMBOL "AddrMgrExtAddrSet"
`??AddrMgrExtAddrSet::?relay` SYMBOL "?relay", AddrMgrExtAddrSet
AddrMgrExtAddrValid SYMBOL "AddrMgrExtAddrValid"
`??AddrMgrExtAddrValid::?relay` SYMBOL "?relay", AddrMgrExtAddrValid
AssocGetWithExt     SYMBOL "AssocGetWithExt"
`??AssocGetWithExt::?relay` SYMBOL "?relay", AssocGetWithExt
AssocGetWithShort   SYMBOL "AssocGetWithShort"
`??AssocGetWithShort::?relay` SYMBOL "?relay", AssocGetWithShort
AssocRemove         SYMBOL "AssocRemove"
`??AssocRemove::?relay` SYMBOL "?relay", AssocRemove
NLME_GetExtAddr     SYMBOL "NLME_GetExtAddr"
`??NLME_GetExtAddr::?relay` SYMBOL "?relay", NLME_GetExtAddr
NLME_GetShortAddr   SYMBOL "NLME_GetShortAddr"
`??NLME_GetShortAddr::?relay` SYMBOL "?relay", NLME_GetShortAddr
NLME_LeaveReq       SYMBOL "NLME_LeaveReq"
`??NLME_LeaveReq::?relay` SYMBOL "?relay", NLME_LeaveReq
NLME_ReadNwkKeyInfo SYMBOL "NLME_ReadNwkKeyInfo"
`??NLME_ReadNwkKeyInfo::?relay` SYMBOL "?relay", NLME_ReadNwkKeyInfo
SSP_GetTrueRand     SYMBOL "SSP_GetTrueRand"
`??SSP_GetTrueRand::?relay` SYMBOL "?relay", SSP_GetTrueRand
SSP_Init            SYMBOL "SSP_Init"
`??SSP_Init::?relay` SYMBOL "?relay", SSP_Init
SSP_SwitchNwkKey    SYMBOL "SSP_SwitchNwkKey"
`??SSP_SwitchNwkKey::?relay` SYMBOL "?relay", SSP_SwitchNwkKey
SSP_UpdateNwkKey    SYMBOL "SSP_UpdateNwkKey"
`??SSP_UpdateNwkKey::?relay` SYMBOL "?relay", SSP_UpdateNwkKey
ZDApp_NVUpdate      SYMBOL "ZDApp_NVUpdate"
`??ZDApp_NVUpdate::?relay` SYMBOL "?relay", ZDApp_NVUpdate
ZDP_IEEEAddrReq     SYMBOL "ZDP_IEEEAddrReq"
`??ZDP_IEEEAddrReq::?relay` SYMBOL "?relay", ZDP_IEEEAddrReq
ZDP_NwkAddrReq      SYMBOL "ZDP_NwkAddrReq"
`??ZDP_NwkAddrReq::?relay` SYMBOL "?relay", ZDP_NwkAddrReq
bdb_doTrustCenterRequireKeyExchange SYMBOL "bdb_doTrustCenterRequireKeyExchange"
`??bdb_doTrustCenterRequireKeyExchange::?relay` SYMBOL "?relay", bdb_doTrustCenterRequireKeyExchange
bdb_tcLinkKeyExchangeAttempt SYMBOL "bdb_tcLinkKeyExchangeAttempt"
`??bdb_tcLinkKeyExchangeAttempt::?relay` SYMBOL "?relay", bdb_tcLinkKeyExchangeAttempt
osal_isbufset       SYMBOL "osal_isbufset"
`??osal_isbufset::?relay` SYMBOL "?relay", osal_isbufset
osal_mem_alloc      SYMBOL "osal_mem_alloc"
`??osal_mem_alloc::?relay` SYMBOL "?relay", osal_mem_alloc
osal_mem_free       SYMBOL "osal_mem_free"
`??osal_mem_free::?relay` SYMBOL "?relay", osal_mem_free
osal_memcmp         SYMBOL "osal_memcmp"
`??osal_memcmp::?relay` SYMBOL "?relay", osal_memcmp
osal_memcpy         SYMBOL "osal_memcpy"
`??osal_memcpy::?relay` SYMBOL "?relay", osal_memcpy
osal_memset         SYMBOL "osal_memset"
`??osal_memset::?relay` SYMBOL "?relay", osal_memset
osal_nv_item_init   SYMBOL "osal_nv_item_init"
`??osal_nv_item_init::?relay` SYMBOL "?relay", osal_nv_item_init
osal_nv_read        SYMBOL "osal_nv_read"
`??osal_nv_read::?relay` SYMBOL "?relay", osal_nv_read
osal_nv_write       SYMBOL "osal_nv_write"
`??osal_nv_write::?relay` SYMBOL "?relay", osal_nv_write
osal_rand           SYMBOL "osal_rand"
`??osal_rand::?relay` SYMBOL "?relay", osal_rand
osal_set_event      SYMBOL "osal_set_event"
`??osal_set_event::?relay` SYMBOL "?relay", osal_set_event
sAddrExtCmp         SYMBOL "sAddrExtCmp"
`??sAddrExtCmp::?relay` SYMBOL "?relay", sAddrExtCmp
sAddrExtCpy         SYMBOL "sAddrExtCpy"
`??sAddrExtCpy::?relay` SYMBOL "?relay", sAddrExtCpy
zgReadStartupOptions SYMBOL "zgReadStartupOptions"
`??zgReadStartupOptions::?relay` SYMBOL "?relay", zgReadStartupOptions
APSME_IsDefaultTCLK SYMBOL "APSME_IsDefaultTCLK"
`??APSME_IsDefaultTCLK::?relay` SYMBOL "?relay", APSME_IsDefaultTCLK
APSME_IsLinkKeyValid SYMBOL "APSME_IsLinkKeyValid"
`??APSME_IsLinkKeyValid::?relay` SYMBOL "?relay", APSME_IsLinkKeyValid
APSME_KeyFwdToChild SYMBOL "APSME_KeyFwdToChild"
`??APSME_KeyFwdToChild::?relay` SYMBOL "?relay", APSME_KeyFwdToChild
APSME_LinkKeyNVIdGet SYMBOL "APSME_LinkKeyNVIdGet"
`??APSME_LinkKeyNVIdGet::?relay` SYMBOL "?relay", APSME_LinkKeyNVIdGet
APSME_LinkKeySet    SYMBOL "APSME_LinkKeySet"
`??APSME_LinkKeySet::?relay` SYMBOL "?relay", APSME_LinkKeySet
APSME_TCLinkKeyInit SYMBOL "APSME_TCLinkKeyInit"
`??APSME_TCLinkKeyInit::?relay` SYMBOL "?relay", APSME_TCLinkKeyInit
APSME_TCLinkKeyLoad SYMBOL "APSME_TCLinkKeyLoad"
`??APSME_TCLinkKeyLoad::?relay` SYMBOL "?relay", APSME_TCLinkKeyLoad
APSME_TCLinkKeySync SYMBOL "APSME_TCLinkKeySync"
`??APSME_TCLinkKeySync::?relay` SYMBOL "?relay", APSME_TCLinkKeySync
ZDSecMgrAPSRemove   SYMBOL "ZDSecMgrAPSRemove"
`??ZDSecMgrAPSRemove::?relay` SYMBOL "?relay", ZDSecMgrAPSRemove
ZDSecMgrAddLinkKey  SYMBOL "ZDSecMgrAddLinkKey"
`??ZDSecMgrAddLinkKey::?relay` SYMBOL "?relay", ZDSecMgrAddLinkKey
ZDSecMgrAddrClear   SYMBOL "ZDSecMgrAddrClear"
`??ZDSecMgrAddrClear::?relay` SYMBOL "?relay", ZDSecMgrAddrClear
ZDSecMgrAddrStore   SYMBOL "ZDSecMgrAddrStore"
`??ZDSecMgrAddrStore::?relay` SYMBOL "?relay", ZDSecMgrAddrStore
ZDSecMgrAppConfKeyReq SYMBOL "ZDSecMgrAppConfKeyReq"
`??ZDSecMgrAppConfKeyReq::?relay` SYMBOL "?relay", ZDSecMgrAppConfKeyReq
ZDSecMgrAppKeyGet   SYMBOL "ZDSecMgrAppKeyGet"
`??ZDSecMgrAppKeyGet::?relay` SYMBOL "?relay", ZDSecMgrAppKeyGet
ZDSecMgrAppKeyReq   SYMBOL "ZDSecMgrAppKeyReq"
`??ZDSecMgrAppKeyReq::?relay` SYMBOL "?relay", ZDSecMgrAppKeyReq
ZDSecMgrApsLinkKeyInit SYMBOL "ZDSecMgrApsLinkKeyInit"
`??ZDSecMgrApsLinkKeyInit::?relay` SYMBOL "?relay", ZDSecMgrApsLinkKeyInit
ZDSecMgrAssocDeviceAuth SYMBOL "ZDSecMgrAssocDeviceAuth"
`??ZDSecMgrAssocDeviceAuth::?relay` SYMBOL "?relay", ZDSecMgrAssocDeviceAuth
ZDSecMgrAuthNwkKey  SYMBOL "ZDSecMgrAuthNwkKey"
`??ZDSecMgrAuthNwkKey::?relay` SYMBOL "?relay", ZDSecMgrAuthNwkKey
ZDSecMgrAuthenticationCheck SYMBOL "ZDSecMgrAuthenticationCheck"
`??ZDSecMgrAuthenticationCheck::?relay` SYMBOL "?relay", ZDSecMgrAuthenticationCheck
ZDSecMgrAuthenticationSet SYMBOL "ZDSecMgrAuthenticationSet"
`??ZDSecMgrAuthenticationSet::?relay` SYMBOL "?relay", ZDSecMgrAuthenticationSet
ZDSecMgrClearNVKeyValues SYMBOL "ZDSecMgrClearNVKeyValues"
`??ZDSecMgrClearNVKeyValues::?relay` SYMBOL "?relay", ZDSecMgrClearNVKeyValues
ZDSecMgrConfig      SYMBOL "ZDSecMgrConfig"
`??ZDSecMgrConfig::?relay` SYMBOL "?relay", ZDSecMgrConfig
ZDSecMgrDeviceJoin  SYMBOL "ZDSecMgrDeviceJoin"
`??ZDSecMgrDeviceJoin::?relay` SYMBOL "?relay", ZDSecMgrDeviceJoin
ZDSecMgrDeviceJoinDirect SYMBOL "ZDSecMgrDeviceJoinDirect"
`??ZDSecMgrDeviceJoinDirect::?relay` SYMBOL "?relay", ZDSecMgrDeviceJoinDirect
ZDSecMgrDeviceJoinFwd SYMBOL "ZDSecMgrDeviceJoinFwd"
`??ZDSecMgrDeviceJoinFwd::?relay` SYMBOL "?relay", ZDSecMgrDeviceJoinFwd
ZDSecMgrDeviceNew   SYMBOL "ZDSecMgrDeviceNew"
`??ZDSecMgrDeviceNew::?relay` SYMBOL "?relay", ZDSecMgrDeviceNew
ZDSecMgrDeviceRemove SYMBOL "ZDSecMgrDeviceRemove"
`??ZDSecMgrDeviceRemove::?relay` SYMBOL "?relay", ZDSecMgrDeviceRemove
ZDSecMgrDeviceRemoveByExtAddr SYMBOL "ZDSecMgrDeviceRemoveByExtAddr"
`??ZDSecMgrDeviceRemoveByExtAddr::?relay` SYMBOL "?relay", ZDSecMgrDeviceRemoveByExtAddr
ZDSecMgrDeviceValidate SYMBOL "ZDSecMgrDeviceValidate"
`??ZDSecMgrDeviceValidate::?relay` SYMBOL "?relay", ZDSecMgrDeviceValidate
ZDSecMgrDeviceValidateRM SYMBOL "ZDSecMgrDeviceValidateRM"
`??ZDSecMgrDeviceValidateRM::?relay` SYMBOL "?relay", ZDSecMgrDeviceValidateRM
ZDSecMgrEntryFree   SYMBOL "ZDSecMgrEntryFree"
`??ZDSecMgrEntryFree::?relay` SYMBOL "?relay", ZDSecMgrEntryFree
ZDSecMgrEntryInit   SYMBOL "ZDSecMgrEntryInit"
`??ZDSecMgrEntryInit::?relay` SYMBOL "?relay", ZDSecMgrEntryInit
ZDSecMgrEntryLookup SYMBOL "ZDSecMgrEntryLookup"
`??ZDSecMgrEntryLookup::?relay` SYMBOL "?relay", ZDSecMgrEntryLookup
ZDSecMgrEntryLookupAMI SYMBOL "ZDSecMgrEntryLookupAMI"
`??ZDSecMgrEntryLookupAMI::?relay` SYMBOL "?relay", ZDSecMgrEntryLookupAMI
ZDSecMgrEntryLookupAMIGetIndex SYMBOL "ZDSecMgrEntryLookupAMIGetIndex"
`??ZDSecMgrEntryLookupAMIGetIndex::?relay` SYMBOL "?relay", ZDSecMgrEntryLookupAMIGetIndex
ZDSecMgrEntryLookupExt SYMBOL "ZDSecMgrEntryLookupExt"
`??ZDSecMgrEntryLookupExt::?relay` SYMBOL "?relay", ZDSecMgrEntryLookupExt
ZDSecMgrEntryLookupExtGetIndex SYMBOL "ZDSecMgrEntryLookupExtGetIndex"
`??ZDSecMgrEntryLookupExtGetIndex::?relay` SYMBOL "?relay", ZDSecMgrEntryLookupExtGetIndex
ZDSecMgrEntryNew    SYMBOL "ZDSecMgrEntryNew"
`??ZDSecMgrEntryNew::?relay` SYMBOL "?relay", ZDSecMgrEntryNew
ZDSecMgrExtAddrLookup SYMBOL "ZDSecMgrExtAddrLookup"
`??ZDSecMgrExtAddrLookup::?relay` SYMBOL "?relay", ZDSecMgrExtAddrLookup
ZDSecMgrExtAddrStore SYMBOL "ZDSecMgrExtAddrStore"
`??ZDSecMgrExtAddrStore::?relay` SYMBOL "?relay", ZDSecMgrExtAddrStore
ZDSecMgrGenerateKeyFromSeed SYMBOL "ZDSecMgrGenerateKeyFromSeed"
`??ZDSecMgrGenerateKeyFromSeed::?relay` SYMBOL "?relay", ZDSecMgrGenerateKeyFromSeed
ZDSecMgrGenerateRndKey SYMBOL "ZDSecMgrGenerateRndKey"
`??ZDSecMgrGenerateRndKey::?relay` SYMBOL "?relay", ZDSecMgrGenerateRndKey
ZDSecMgrGenerateSeed SYMBOL "ZDSecMgrGenerateSeed"
`??ZDSecMgrGenerateSeed::?relay` SYMBOL "?relay", ZDSecMgrGenerateSeed
ZDSecMgrInit        SYMBOL "ZDSecMgrInit"
`??ZDSecMgrInit::?relay` SYMBOL "?relay", ZDSecMgrInit
ZDSecMgrInitNV      SYMBOL "ZDSecMgrInitNV"
`??ZDSecMgrInitNV::?relay` SYMBOL "?relay", ZDSecMgrInitNV
ZDSecMgrInitNVKeyTables SYMBOL "ZDSecMgrInitNVKeyTables"
`??ZDSecMgrInitNVKeyTables::?relay` SYMBOL "?relay", ZDSecMgrInitNVKeyTables
ZDSecMgrNewDeviceEvent SYMBOL "ZDSecMgrNewDeviceEvent"
`??ZDSecMgrNewDeviceEvent::?relay` SYMBOL "?relay", ZDSecMgrNewDeviceEvent
ZDSecMgrNwkKeyInit  SYMBOL "ZDSecMgrNwkKeyInit"
`??ZDSecMgrNwkKeyInit::?relay` SYMBOL "?relay", ZDSecMgrNwkKeyInit
ZDSecMgrPermitJoining SYMBOL "ZDSecMgrPermitJoining"
`??ZDSecMgrPermitJoining::?relay` SYMBOL "?relay", ZDSecMgrPermitJoining
ZDSecMgrPermitJoiningTimeout SYMBOL "ZDSecMgrPermitJoiningTimeout"
`??ZDSecMgrPermitJoiningTimeout::?relay` SYMBOL "?relay", ZDSecMgrPermitJoiningTimeout
ZDSecMgrReadKeyFromNv SYMBOL "ZDSecMgrReadKeyFromNv"
`??ZDSecMgrReadKeyFromNv::?relay` SYMBOL "?relay", ZDSecMgrReadKeyFromNv
ZDSecMgrRemoveDeviceInd SYMBOL "ZDSecMgrRemoveDeviceInd"
`??ZDSecMgrRemoveDeviceInd::?relay` SYMBOL "?relay", ZDSecMgrRemoveDeviceInd
ZDSecMgrRequestAppKey SYMBOL "ZDSecMgrRequestAppKey"
`??ZDSecMgrRequestAppKey::?relay` SYMBOL "?relay", ZDSecMgrRequestAppKey
ZDSecMgrRequestKeyInd SYMBOL "ZDSecMgrRequestKeyInd"
`??ZDSecMgrRequestKeyInd::?relay` SYMBOL "?relay", ZDSecMgrRequestKeyInd
ZDSecMgrSaveApsLinkKey SYMBOL "ZDSecMgrSaveApsLinkKey"
`??ZDSecMgrSaveApsLinkKey::?relay` SYMBOL "?relay", ZDSecMgrSaveApsLinkKey
ZDSecMgrSaveTCLinkKey SYMBOL "ZDSecMgrSaveTCLinkKey"
`??ZDSecMgrSaveTCLinkKey::?relay` SYMBOL "?relay", ZDSecMgrSaveTCLinkKey
ZDSecMgrSendNwkKey  SYMBOL "ZDSecMgrSendNwkKey"
`??ZDSecMgrSendNwkKey::?relay` SYMBOL "?relay", ZDSecMgrSendNwkKey
ZDSecMgrSetDefaultNV SYMBOL "ZDSecMgrSetDefaultNV"
`??ZDSecMgrSetDefaultNV::?relay` SYMBOL "?relay", ZDSecMgrSetDefaultNV
ZDSecMgrSetupPartner SYMBOL "ZDSecMgrSetupPartner"
`??ZDSecMgrSetupPartner::?relay` SYMBOL "?relay", ZDSecMgrSetupPartner
ZDSecMgrSwitchKeyInd SYMBOL "ZDSecMgrSwitchKeyInd"
`??ZDSecMgrSwitchKeyInd::?relay` SYMBOL "?relay", ZDSecMgrSwitchKeyInd
ZDSecMgrTCDataLoad  SYMBOL "ZDSecMgrTCDataLoad"
`??ZDSecMgrTCDataLoad::?relay` SYMBOL "?relay", ZDSecMgrTCDataLoad
ZDSecMgrTCExtAddrCheck SYMBOL "ZDSecMgrTCExtAddrCheck"
`??ZDSecMgrTCExtAddrCheck::?relay` SYMBOL "?relay", ZDSecMgrTCExtAddrCheck
ZDSecMgrTclkReq     SYMBOL "ZDSecMgrTclkReq"
`??ZDSecMgrTclkReq::?relay` SYMBOL "?relay", ZDSecMgrTclkReq
ZDSecMgrTransportKeyInd SYMBOL "ZDSecMgrTransportKeyInd"
`??ZDSecMgrTransportKeyInd::?relay` SYMBOL "?relay", ZDSecMgrTransportKeyInd
ZDSecMgrUpdateDeviceInd SYMBOL "ZDSecMgrUpdateDeviceInd"
`??ZDSecMgrUpdateDeviceInd::?relay` SYMBOL "?relay", ZDSecMgrUpdateDeviceInd
ZDSecMgrUpdateTCAddress SYMBOL "ZDSecMgrUpdateTCAddress"
`??ZDSecMgrUpdateTCAddress::?relay` SYMBOL "?relay", ZDSecMgrUpdateTCAddress
ZDSecMgrVerifyKeyInd SYMBOL "ZDSecMgrVerifyKeyInd"
`??ZDSecMgrVerifyKeyInd::?relay` SYMBOL "?relay", ZDSecMgrVerifyKeyInd

        EXTERN `??APSME_EraseICEntry::?relay`
        FUNCTION `??APSME_EraseICEntry::?relay`,00H
        EXTERN `??APSME_GetRequest::?relay`
        FUNCTION `??APSME_GetRequest::?relay`,00H
        EXTERN `??APSME_IsDistributedSecurity::?relay`
        FUNCTION `??APSME_IsDistributedSecurity::?relay`,00H
        EXTERN `??APSME_LookupExtAddr::?relay`
        FUNCTION `??APSME_LookupExtAddr::?relay`,00H
        EXTERN `??APSME_LookupNwkAddr::?relay`
        FUNCTION `??APSME_LookupNwkAddr::?relay`,00H
        EXTERN `??APSME_RemoveDeviceReq::?relay`
        FUNCTION `??APSME_RemoveDeviceReq::?relay`,00H
        EXTERN `??APSME_RequestKeyReq::?relay`
        FUNCTION `??APSME_RequestKeyReq::?relay`,00H
        EXTERN `??APSME_SearchTCLinkKeyEntry::?relay`
        FUNCTION `??APSME_SearchTCLinkKeyEntry::?relay`,00H
        EXTERN `??APSME_SecurityCM_ED::?relay`
        FUNCTION `??APSME_SecurityCM_ED::?relay`,00H
        EXTERN `??APSME_SetRequest::?relay`
        FUNCTION `??APSME_SetRequest::?relay`,00H
        EXTERN `??APSME_TransportKeyReq::?relay`
        FUNCTION `??APSME_TransportKeyReq::?relay`,00H
        EXTERN `??APSME_UpdateDeviceReq::?relay`
        FUNCTION `??APSME_UpdateDeviceReq::?relay`,00H
        EXTERN `??AddrMgrEntryGet::?relay`
        FUNCTION `??AddrMgrEntryGet::?relay`,00H
        EXTERN `??AddrMgrEntryLookupExt::?relay`
        FUNCTION `??AddrMgrEntryLookupExt::?relay`,00H
        EXTERN `??AddrMgrEntryLookupNwk::?relay`
        FUNCTION `??AddrMgrEntryLookupNwk::?relay`,00H
        EXTERN `??AddrMgrEntryRelease::?relay`
        FUNCTION `??AddrMgrEntryRelease::?relay`,00H
        EXTERN `??AddrMgrEntryUpdate::?relay`
        FUNCTION `??AddrMgrEntryUpdate::?relay`,00H
        EXTERN `??AddrMgrExtAddrLookup::?relay`
        FUNCTION `??AddrMgrExtAddrLookup::?relay`,00H
        EXTERN `??AddrMgrExtAddrSet::?relay`
        FUNCTION `??AddrMgrExtAddrSet::?relay`,00H
        EXTERN `??AddrMgrExtAddrValid::?relay`
        FUNCTION `??AddrMgrExtAddrValid::?relay`,00H
        EXTERN `??AssocGetWithExt::?relay`
        FUNCTION `??AssocGetWithExt::?relay`,00H
        EXTERN `??AssocGetWithShort::?relay`
        FUNCTION `??AssocGetWithShort::?relay`,00H
        EXTERN `??AssocRemove::?relay`
        FUNCTION `??AssocRemove::?relay`,00H
        EXTERN `??NLME_GetExtAddr::?relay`
        FUNCTION `??NLME_GetExtAddr::?relay`,00H
        EXTERN `??NLME_GetShortAddr::?relay`
        FUNCTION `??NLME_GetShortAddr::?relay`,00H
        EXTERN `??NLME_LeaveReq::?relay`
        FUNCTION `??NLME_LeaveReq::?relay`,00H
        EXTERN `??NLME_ReadNwkKeyInfo::?relay`
        FUNCTION `??NLME_ReadNwkKeyInfo::?relay`,00H
        EXTERN `??SSP_GetTrueRand::?relay`
        FUNCTION `??SSP_GetTrueRand::?relay`,00H
        EXTERN `??SSP_Init::?relay`
        FUNCTION `??SSP_Init::?relay`,00H
        EXTERN `??SSP_SwitchNwkKey::?relay`
        FUNCTION `??SSP_SwitchNwkKey::?relay`,00H
        EXTERN `??SSP_UpdateNwkKey::?relay`
        FUNCTION `??SSP_UpdateNwkKey::?relay`,00H
        EXTERN `??ZDApp_NVUpdate::?relay`
        FUNCTION `??ZDApp_NVUpdate::?relay`,00H
        EXTERN `??ZDP_IEEEAddrReq::?relay`
        FUNCTION `??ZDP_IEEEAddrReq::?relay`,00H
        EXTERN `??ZDP_NwkAddrReq::?relay`
        FUNCTION `??ZDP_NwkAddrReq::?relay`,00H
        EXTERN `??bdb_doTrustCenterRequireKeyExchange::?relay`
        FUNCTION `??bdb_doTrustCenterRequireKeyExchange::?relay`,00H
        EXTERN `??bdb_tcLinkKeyExchangeAttempt::?relay`
        FUNCTION `??bdb_tcLinkKeyExchangeAttempt::?relay`,00H
        EXTERN `??osal_isbufset::?relay`
        FUNCTION `??osal_isbufset::?relay`,00H
        EXTERN `??osal_mem_alloc::?relay`
        FUNCTION `??osal_mem_alloc::?relay`,00H
        EXTERN `??osal_mem_free::?relay`
        FUNCTION `??osal_mem_free::?relay`,00H
        EXTERN `??osal_memcmp::?relay`
        FUNCTION `??osal_memcmp::?relay`,00H
        EXTERN `??osal_memcpy::?relay`
        FUNCTION `??osal_memcpy::?relay`,00H
        EXTERN `??osal_memset::?relay`
        FUNCTION `??osal_memset::?relay`,00H
        EXTERN `??osal_nv_item_init::?relay`
        FUNCTION `??osal_nv_item_init::?relay`,00H
        EXTERN `??osal_nv_read::?relay`
        FUNCTION `??osal_nv_read::?relay`,00H
        EXTERN `??osal_nv_write::?relay`
        FUNCTION `??osal_nv_write::?relay`,00H
        EXTERN `??osal_rand::?relay`
        FUNCTION `??osal_rand::?relay`,00H
        EXTERN `??osal_set_event::?relay`
        FUNCTION `??osal_set_event::?relay`,00H
        EXTERN `??sAddrExtCmp::?relay`
        FUNCTION `??sAddrExtCmp::?relay`,00H
        EXTERN `??sAddrExtCpy::?relay`
        FUNCTION `??sAddrExtCpy::?relay`,00H
        EXTERN `??zgReadStartupOptions::?relay`
        FUNCTION `??zgReadStartupOptions::?relay`,00H
        EXTERN APSME_EraseICEntry
        FUNCTION APSME_EraseICEntry,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 54, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN APSME_GetRequest
        FUNCTION APSME_GetRequest,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 31, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN APSME_IsDistributedSecurity
        FUNCTION APSME_IsDistributedSecurity,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 25, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN APSME_LookupExtAddr
        FUNCTION APSME_LookupExtAddr,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 69, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN APSME_LookupNwkAddr
        FUNCTION APSME_LookupNwkAddr,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 69, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN APSME_RemoveDeviceReq
        FUNCTION APSME_RemoveDeviceReq,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 31, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN APSME_RequestKeyReq
        FUNCTION APSME_RequestKeyReq,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 13, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN APSME_SearchTCLinkKeyEntry
        FUNCTION APSME_SearchTCLinkKeyEntry,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 71, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN APSME_SecurityCM_ED
        FUNCTION APSME_SecurityCM_ED,0202H
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN APSME_SetRequest
        FUNCTION APSME_SetRequest,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN APSME_TransportKeyReq
        FUNCTION APSME_TransportKeyReq,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 69, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN APSME_UpdateDeviceReq
        FUNCTION APSME_UpdateDeviceReq,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 29, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN AddrMgrEntryGet
        FUNCTION AddrMgrEntryGet,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 35, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN AddrMgrEntryLookupExt
        FUNCTION AddrMgrEntryLookupExt,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 25, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN AddrMgrEntryLookupNwk
        FUNCTION AddrMgrEntryLookupNwk,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 57, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN AddrMgrEntryRelease
        FUNCTION AddrMgrEntryRelease,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 57, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN AddrMgrEntryUpdate
        FUNCTION AddrMgrEntryUpdate,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 26, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN AddrMgrExtAddrLookup
        FUNCTION AddrMgrExtAddrLookup,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN AddrMgrExtAddrSet
        FUNCTION AddrMgrExtAddrSet,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 26, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN AddrMgrExtAddrValid
        FUNCTION AddrMgrExtAddrValid,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 57, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN AssocGetWithExt
        FUNCTION AssocGetWithExt,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 31, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN AssocGetWithShort
        FUNCTION AssocGetWithShort,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 36, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN AssocRemove
        FUNCTION AssocRemove,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 35, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN NLME_GetExtAddr
        FUNCTION NLME_GetExtAddr,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN NLME_GetShortAddr
        FUNCTION NLME_GetShortAddr,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 46, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN NLME_LeaveReq
        FUNCTION NLME_LeaveReq,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 31, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN NLME_ReadNwkKeyInfo
        FUNCTION NLME_ReadNwkKeyInfo,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 50, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN SSP_GetTrueRand
        FUNCTION SSP_GetTrueRand,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN SSP_Init
        FUNCTION SSP_Init,0202H
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN SSP_SwitchNwkKey
        FUNCTION SSP_SwitchNwkKey,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 54, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN SSP_UpdateNwkKey
        FUNCTION SSP_UpdateNwkKey,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 54, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN ZDAppTaskID
        EXTERN ZDApp_NVUpdate
        FUNCTION ZDApp_NVUpdate,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN ZDP_IEEEAddrReq
        FUNCTION ZDP_IEEEAddrReq,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 25, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN ZDP_NwkAddrReq
        FUNCTION ZDP_NwkAddrReq,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 54, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN _NIB
        EXTERN bdb_doTrustCenterRequireKeyExchange
        FUNCTION bdb_doTrustCenterRequireKeyExchange,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 50, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN bdb_tcLinkKeyExchangeAttempt
        FUNCTION bdb_tcLinkKeyExchangeAttempt,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 54, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN defaultTCLinkKey
        EXTERN devState
        EXTERN distributedDefaultKey
        EXTERN gMAX_NWK_SEC_MATERIAL_TABLE_ENTRIES
        EXTERN osal_isbufset
        FUNCTION osal_isbufset,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_mem_alloc
        FUNCTION osal_mem_alloc,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 33, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_mem_free
        FUNCTION osal_mem_free,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 33, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_memcmp
        FUNCTION osal_memcmp,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 36, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_memcpy
        FUNCTION osal_memcpy,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 60, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_memset
        FUNCTION osal_memset,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 69, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_nv_item_init
        FUNCTION osal_nv_item_init,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 64, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_nv_read
        FUNCTION osal_nv_read,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 39, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_nv_write
        FUNCTION osal_nv_write,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 66, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_rand
        FUNCTION osal_rand,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 57, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_set_event
        FUNCTION osal_set_event,0202H
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 57, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN sAddrExtCmp
        FUNCTION sAddrExtCmp,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN sAddrExtCpy
        FUNCTION sAddrExtCpy,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 25, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN zdoCBFunc
        EXTERN zgApsLinkKeyType
        EXTERN zgApsTrustCenterAddr
        EXTERN zgDeviceLogicalType
        EXTERN zgPreConfigKeys
        EXTERN zgReadStartupOptions
        FUNCTION zgReadStartupOptions,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 62, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN zgSecurePermitJoin

// D:\AA\Z-Stack 3.0.2\Components\stack\zdo\ZDSecMgr.c
//    1 /******************************************************************************
//    2   Filename:       ZDSecMgr.c
//    3   Revised:        $Date: 2014-06-05 11:25:00 -0700 (Thu, 05 Jun 2014) $
//    4   Revision:       $Revision: 38833 $
//    5 
//    6   Description:    The ZigBee Device Security Manager.
//    7 
//    8 
//    9   Copyright 2005-2014 Texas Instruments Incorporated. All rights reserved.
//   10 
//   11   IMPORTANT: Your use of this Software is limited to those specific rights
//   12   granted under the terms of a software license agreement between the user
//   13   who downloaded the software, his/her employer (which must be your employer)
//   14   and Texas Instruments Incorporated (the "License"). You may not use this
//   15   Software unless you agree to abide by the terms of the License. The License
//   16   limits your use, and you acknowledge, that the Software may not be modified,
//   17   copied or distributed unless embedded on a Texas Instruments microcontroller
//   18   or used solely and exclusively in conjunction with a Texas Instruments radio
//   19   frequency transceiver, which is integrated into your product. Other than for
//   20   the foregoing purpose, you may not use, reproduce, copy, prepare derivative
//   21   works of, modify, distribute, perform, display or sell this Software and/or
//   22   its documentation for any purpose.
//   23 
//   24   YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
//   25   PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
//   26   INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE,
//   27   NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
//   28   TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
//   29   NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
//   30   LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
//   31   INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
//   32   OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
//   33   OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
//   34   (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
//   35 
//   36   Should you have any questions regarding your right to use this Software,
//   37   contact Texas Instruments Incorporated at www.TI.com.
//   38 ******************************************************************************/
//   39 
//   40 #ifdef __cplusplus
//   41 extern "C"
//   42 {
//   43 #endif
//   44 
//   45 /******************************************************************************
//   46  * INCLUDES
//   47  */
//   48 #include "ZComDef.h"
//   49 #include "OSAL.h"
//   50 #include "OSAL_Nv.h"
//   51 #include "ZGlobals.h"
//   52 #include "ssp.h"
//   53 #include "nwk_globals.h"
//   54 #include "nwk.h"
//   55 #include "NLMEDE.h"
//   56 #include "AddrMgr.h"
//   57 #include "AssocList.h"
//   58 #include "APSMEDE.h"
//   59 #include "ZDConfig.h"
//   60 #include "ZDSecMgr.h"
//   61   
//   62 #include "bdb.h"
//   63 #include "bdb_interface.h"
//   64 
//   65 /******************************************************************************
//   66  * CONSTANTS
//   67  */
//   68 // maximum number of devices managed by this Security Manager
//   69 #if !defined ( ZDSECMGR_DEVICE_MAX )
//   70   #define ZDSECMGR_DEVICE_MAX 3
//   71 #endif
//   72 
//   73 // maximum number of LINK keys this device may store
//   74 #define ZDSECMGR_ENTRY_MAX ZDSECMGR_DEVICE_MAX
//   75 
//   76 // total number of stored devices
//   77 #if !defined ( ZDSECMGR_STORED_DEVICES )
//   78   #define ZDSECMGR_STORED_DEVICES 3
//   79 #endif
//   80 
//   81 // Joining Device Policies: r21 spec 4.9.1
//   82 // This boolean indicates whether the device will request a new Trust Center Link key after joining.
//   83 // TC link key cannot be requested if join is performed on distributed nwk

        RSEG XDATA_I:XDATA:NOROOT(0)
//   84 bool  requestNewTrustCenterLinkKey = TRUE;  
requestNewTrustCenterLinkKey:
        DATA8
        DS 1
        REQUIRE `?<Initializer for requestNewTrustCenterLinkKey`
        REQUIRE __INIT_XDATA_I
//   85 //This integer indicates the maximum time in seconds that a device will wait for a response to a 
//   86 //request for a Trust Center link key.

        RSEG XDATA_I:XDATA:NOROOT(0)
//   87 uint32  requestLinkKeyTimeout = BDBC_TC_LINK_KEY_EXANGE_TIMEOUT;
requestLinkKeyTimeout:
        DATA32
        DS 4
        REQUIRE `?<Initializer for requestLinkKeyTimeout>`
        REQUIRE __INIT_XDATA_I
//   88  //bool acceptNewUnsolicitedApplicationLinkKey;   
//   89 
//   90 // APSME Stub Implementations
//   91 #define ZDSecMgrLinkKeySet       APSME_LinkKeySet
//   92 #define ZDSecMgrLinkKeyNVIdGet   APSME_LinkKeyNVIdGet
//   93 #define ZDSecMgrKeyFwdToChild    APSME_KeyFwdToChild
//   94 #define ZDSecMgrIsLinkKeyValid   APSME_IsLinkKeyValid
//   95 
//   96 
//   97 
//   98 /******************************************************************************
//   99  * TYPEDEFS
//  100  */
//  101 typedef struct
//  102 {
//  103   uint16            ami;
//  104   uint16            keyNvId;   // index to the Link Key table in NV
//  105   ZDSecMgr_Authentication_Option authenticateOption;
//  106 } ZDSecMgrEntry_t;
//  107 
//  108 typedef struct
//  109 {
//  110   uint16          nwkAddr;
//  111   uint8*          extAddr;
//  112   uint16          parentAddr;
//  113   uint8           secure;
//  114   uint8           devStatus;
//  115 } ZDSecMgrDevice_t;
//  116 
//  117 /******************************************************************************
//  118  * EXTERNAL VARIABLES
//  119  */
//  120 extern CONST uint8 gMAX_NWK_SEC_MATERIAL_TABLE_ENTRIES;
//  121 extern pfnZdoCb zdoCBFunc[MAX_ZDO_CB_FUNC];
//  122 
//  123 
//  124 /******************************************************************************
//  125  * EXTERNAL FUNCTIONS
//  126  */
//  127 extern void   ZDApp_ResetTimerCancel( void );
//  128 /******************************************************************************
//  129  * LOCAL VARIABLES
//  130  */
//  131 #if 0 // Taken out because the following functionality is only used for test
//  132       // purpose. A more efficient (above) way is used. It can be put
//  133       // back in if customers request for a white/black list feature.
//  134 uint8 ZDSecMgrStoredDeviceList[ZDSECMGR_STORED_DEVICES][Z_EXTADDR_LEN] =
//  135 {
//  136   { 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 },
//  137   { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01 },
//  138   { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 },
//  139 };
//  140 #endif
//  141 

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
//  142 uint8 ZDSecMgrTCExtAddr[Z_EXTADDR_LEN]=
ZDSecMgrTCExtAddr:
        DS 8
        REQUIRE __INIT_XDATA_Z
//  143   { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };
//  144 

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
//  145 uint8 ZDSecMgrTCAuthenticated = FALSE;
ZDSecMgrTCAuthenticated:
        DS 1
        REQUIRE __INIT_XDATA_Z
//  146 

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA16
//  147 ZDSecMgrEntry_t* ZDSecMgrEntries  = NULL;
ZDSecMgrEntries:
        DS 2
        REQUIRE __INIT_XDATA_Z
//  148 
//  149 void ZDSecMgrAddrMgrCB( uint8 update, AddrMgrEntry_t* newEntry, AddrMgrEntry_t* oldEntry );
//  150 

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
//  151 uint8 ZDSecMgrPermitJoiningEnabled;
ZDSecMgrPermitJoiningEnabled:
        DS 1
        REQUIRE __INIT_XDATA_Z

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
//  152 uint8 ZDSecMgrPermitJoiningTimed;
ZDSecMgrPermitJoiningTimed:
        DS 1
        REQUIRE __INIT_XDATA_Z
//  153 

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
//  154 APSME_TCLKDevEntry_t TrustCenterLinkKey;
TrustCenterLinkKey:
        DS 19
        REQUIRE __INIT_XDATA_Z
//  155 

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
//  156 APSME_ApsLinkKeyFrmCntr_t ApsLinkKeyFrmCntr[ZDSECMGR_ENTRY_MAX];
ApsLinkKeyFrmCntr:
        DS 27
        REQUIRE __INIT_XDATA_Z

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
//  157 APSME_TCLinkKeyFrmCntr_t TCLinkKeyFrmCntr[ZDSECMGR_TC_DEVICE_MAX];
TCLinkKeyFrmCntr:
        DS 27
        REQUIRE __INIT_XDATA_Z
//  158 

        RSEG CODE_C:CODE:REORDER:NOROOT(0)
        DATA16
//  159  CONST uint16 gZDSECMGR_TC_DEVICE_MAX = ZDSECMGR_TC_DEVICE_MAX;
gZDSECMGR_TC_DEVICE_MAX:
        DW 3

        RSEG CODE_C:CODE:REORDER:NOROOT(0)
        DATA16
//  160  CONST uint16 gZDSECMGR_TC_DEVICE_IC_MAX = ZDSECMGR_TC_DEVICE_IC_MAX;
gZDSECMGR_TC_DEVICE_IC_MAX:
        DW 1

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
//  161  uint8  gZDSECMGR_TC_ATTEMPT_DEFAULT_KEY = ZDSECMGR_TC_ATTEMPT_DEFAULT_KEY;
gZDSECMGR_TC_ATTEMPT_DEFAULT_KEY:
        DS 1
        REQUIRE __INIT_XDATA_Z
//  162 /******************************************************************************
//  163  * PRIVATE FUNCTIONS
//  164  *
//  165  *   ZDSecMgrAddrStore
//  166  *   ZDSecMgrExtAddrStore
//  167  *   ZDSecMgrExtAddrLookup
//  168  *   ZDSecMgrEntryInit
//  169  *   ZDSecMgrEntryLookup
//  170  *   ZDSecMgrEntryLookupAMI
//  171  *   ZDSecMgrEntryLookupExt
//  172  *   ZDSecMgrEntryLookupExtGetIndex
//  173  *   ZDSecMgrEntryFree
//  174  *   ZDSecMgrEntryNew
//  175  *   ZDSecMgrAppKeyGet
//  176  *   ZDSecMgrAppKeyReq
//  177  *   ZDSecMgrTclkReq
//  178  *   ZDSecMgrAppConfKeyReq 
//  179  *   ZDSecMgrSendNwkKey
//  180  *   ZDSecMgrDeviceRemove
//  181  *   ZDSecMgrDeviceValidateRM
//  182  *   ZDSecMgrDeviceValidate
//  183  *   ZDSecMgrDeviceJoin
//  184  *   ZDSecMgrDeviceJoinDirect
//  185  *   ZDSecMgrDeviceJoinFwd
//  186  *   ZDSecMgrDeviceNew
//  187  *   ZDSecMgrAssocDeviceAuth
//  188  *   ZDSecMgrAuthNwkKey
//  189  *   APSME_TCLinkKeyInit
//  190  *   APSME_IsDefaultTCLK
//  191  */
//  192 
//  193 //-----------------------------------------------------------------------------
//  194 // address management
//  195 //-----------------------------------------------------------------------------
//  196 ZStatus_t ZDSecMgrAddrStore( uint16 nwkAddr, uint8* extAddr, uint16* ami );
//  197 ZStatus_t ZDSecMgrExtAddrStore( uint16 nwkAddr, uint8* extAddr, uint16* ami );
//  198 ZStatus_t ZDSecMgrExtAddrLookup( uint8* extAddr, uint16* ami );
//  199 
//  200 //-----------------------------------------------------------------------------
//  201 // Trust Center management
//  202 //-----------------------------------------------------------------------------
//  203 uint8 ZDSecMgrTCExtAddrCheck( uint8* extAddr );
//  204 void ZDSecMgrTCDataLoad( uint8* extAddr );
//  205 
//  206 //-----------------------------------------------------------------------------
//  207 // entry data
//  208 //-----------------------------------------------------------------------------
//  209 void ZDSecMgrEntryInit(uint8 state);
//  210 ZStatus_t ZDSecMgrEntryLookup( uint16 nwkAddr, ZDSecMgrEntry_t** entry );
//  211 ZStatus_t ZDSecMgrEntryLookupAMI( uint16 ami, ZDSecMgrEntry_t** entry );
//  212 ZStatus_t ZDSecMgrEntryLookupExt( uint8* extAddr, ZDSecMgrEntry_t** entry );
//  213 ZStatus_t ZDSecMgrEntryLookupExtGetIndex( uint8* extAddr, ZDSecMgrEntry_t** entry, uint16* entryIndex );
//  214 ZStatus_t ZDSecMgrEntryLookupAMIGetIndex( uint16 ami, uint16* entryIndex );
//  215 void ZDSecMgrEntryFree( ZDSecMgrEntry_t* entry );
//  216 ZStatus_t ZDSecMgrEntryNew( ZDSecMgrEntry_t** entry );
//  217 ZStatus_t ZDSecMgrAuthenticationSet( uint8* extAddr, ZDSecMgr_Authentication_Option option );
//  218 void ZDSecMgrApsLinkKeyInit(uint8 setDefault);
//  219 #if defined ( NV_RESTORE )
//  220 static void ZDSecMgrWriteNV(void);
//  221 static void ZDSecMgrRestoreFromNV(void);
//  222 static void ZDSecMgrUpdateNV( uint16 index );
//  223 #endif
//  224 
//  225 //-----------------------------------------------------------------------------
//  226 // key support
//  227 //-----------------------------------------------------------------------------
//  228 ZStatus_t ZDSecMgrAppKeyGet( uint16  initNwkAddr,
//  229                              uint8*  initExtAddr,
//  230                              uint16  partNwkAddr,
//  231                              uint8*  partExtAddr,
//  232                              uint8** key,
//  233                              uint8*  keyType );
//  234 void ZDSecMgrAppKeyReq( ZDO_RequestKeyInd_t* ind );
//  235 void ZDSecMgrTclkReq( ZDO_RequestKeyInd_t* ind );
//  236 void ZDSecMgrAppConfKeyReq( ZDO_VerifyKeyInd_t* ind );
//  237 ZStatus_t ZDSecMgrSendNwkKey( ZDSecMgrDevice_t* device );
//  238 void ZDSecMgrNwkKeyInit(uint8 setDefault);
//  239 
//  240 //-----------------------------------------------------------------------------
//  241 // device management
//  242 //-----------------------------------------------------------------------------
//  243 void ZDSecMgrDeviceRemove( ZDSecMgrDevice_t* device );
//  244 ZStatus_t ZDSecMgrDeviceValidateRM( ZDSecMgrDevice_t* device );
//  245 ZStatus_t ZDSecMgrDeviceValidate( ZDSecMgrDevice_t* device );
//  246 ZStatus_t ZDSecMgrDeviceJoin( ZDSecMgrDevice_t* device );
//  247 ZStatus_t ZDSecMgrDeviceJoinDirect( ZDSecMgrDevice_t* device );
//  248 ZStatus_t ZDSecMgrDeviceJoinFwd( ZDSecMgrDevice_t* device );
//  249 ZStatus_t ZDSecMgrDeviceNew( ZDSecMgrDevice_t* device );
//  250 
//  251 //-----------------------------------------------------------------------------
//  252 // association management
//  253 //-----------------------------------------------------------------------------
//  254 void ZDSecMgrAssocDeviceAuth( associated_devices_t* assoc );
//  255 
//  256 //-----------------------------------------------------------------------------
//  257 // authentication management
//  258 //-----------------------------------------------------------------------------
//  259 void ZDSecMgrAuthNwkKey( void );
//  260 
//  261 //-----------------------------------------------------------------------------
//  262 // APSME function
//  263 //-----------------------------------------------------------------------------
//  264 void APSME_TCLinkKeyInit( uint8 setDefault );
//  265 uint8 APSME_IsDefaultTCLK( uint8 *extAddr );
//  266 void ZDSecMgrGenerateSeed(uint8 setDefault );
//  267 void ZDSecMgrGenerateKeyFromSeed(uint8 *extAddr, uint8 shift, uint8 *key);
//  268 /******************************************************************************
//  269  * @fn          ZDSecMgrAddrStore
//  270  *
//  271  * @brief       Store device addresses.
//  272  *
//  273  * @param       nwkAddr - [in] NWK address
//  274  * @param       extAddr - [in] EXT address
//  275  * @param       ami     - [out] Address Manager index
//  276  *
//  277  * @return      ZStatus_t
//  278  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
//  279 ZStatus_t ZDSecMgrAddrStore( uint16 nwkAddr, uint8* extAddr, uint16* ami )
ZDSecMgrAddrStore:
          CFI Block cfiBlock0 Using cfiCommon0
          CFI Function ZDSecMgrAddrStore
        CODE
//  280 {
        FUNCALL ZDSecMgrAddrStore, AddrMgrExtAddrSet
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 26, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 26, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrAddrStore, AddrMgrEntryUpdate
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 26, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 26, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        REQUIRE ?V2
        REQUIRE ?V3
        REQUIRE ?V4
        MOV       A,#-0xd
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 13)
        ; Saved register size: 13
        ; Auto size: 13
        MOV       A,#-0xd
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 26)
        MOV       ?V2,R2
        MOV       ?V3,R3
        MOV       A,R4
        MOV       R6,A
        MOV       A,R5
        MOV       R7,A
        MOV       A,#0x1a
        LCALL     ?XSTACK_DISP0_8
        MOVX      A,@DPTR
        MOV       ?V0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       ?V1,A
//  281   ZStatus_t      status;
//  282   AddrMgrEntry_t entry;
//  283 
//  284 
//  285   // add entry
//  286   entry.user    = ADDRMGR_USER_SECURITY;
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOV       A,#0x2
        MOVX      @DPTR,A
//  287   entry.nwkAddr = nwkAddr;
        MOV       A,#0x1
        LCALL     ?XSTACK_DISP0_8
        MOV       A,?V2
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,?V3
        MOVX      @DPTR,A
//  288   AddrMgrExtAddrSet( entry.extAddr, extAddr );
        ; Setup parameters for call to function AddrMgrExtAddrSet
        MOV       A,R6
        MOV       R4,A
        MOV       A,R7
        MOV       R5,A
        MOV       A,#0x3
        LCALL     ?XSTACK_DISP0_8
        MOV       R2,DPL
        MOV       R3,DPH
        LCALL     `??AddrMgrExtAddrSet::?relay`; Banked call to: AddrMgrExtAddrSet
//  289 
//  290   if ( AddrMgrEntryUpdate( &entry ) == TRUE )
        ; Setup parameters for call to function AddrMgrEntryUpdate
        MOV       R2,?XSP + 0
        MOV       R3,?XSP + 1
        LCALL     `??AddrMgrEntryUpdate::?relay`; Banked call to: AddrMgrEntryUpdate
        MOV       A,R1
        XRL       A,#0x1
        JNZ       ??ZDSecMgrAddrStore_0
//  291   {
//  292     // return successful results
//  293     *ami   = entry.index;
        MOV       A,#0xb
        LCALL     ?XSTACK_DISP0_8
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       DPL,?V0
        MOV       DPH,?V1
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
//  294     status = ZSuccess;
        MOV       ?V4,#0x0
        SJMP      ??ZDSecMgrAddrStore_1
//  295   }
//  296   else
//  297   {
//  298     // return failed results
//  299     *ami   = entry.index;
??ZDSecMgrAddrStore_0:
        MOV       A,#0xb
        LCALL     ?XSTACK_DISP0_8
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       DPL,?V0
        MOV       DPH,?V1
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
//  300     status = ZNwkUnknownDevice;
        MOV       ?V4,#-0x38
//  301   }
//  302 
//  303   return status;
??ZDSecMgrAddrStore_1:
        MOV       R1,?V4
        MOV       A,#0xd
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 13)
        MOV       R7,#0x5
        LJMP      ?BANKED_LEAVE_XDATA
//  304 }
          CFI EndBlock cfiBlock0
//  305 
//  306 /******************************************************************************
//  307  * @fn          ZDSecMgrExtAddrStore
//  308  *
//  309  * @brief       Store EXT address.
//  310  *
//  311  * @param       extAddr - [in] EXT address
//  312  * @param       ami     - [out] Address Manager index
//  313  *
//  314  * @return      ZStatus_t
//  315  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
//  316 ZStatus_t ZDSecMgrExtAddrStore( uint16 nwkAddr, uint8* extAddr, uint16* ami )
ZDSecMgrExtAddrStore:
          CFI Block cfiBlock1 Using cfiCommon0
          CFI Function ZDSecMgrExtAddrStore
        CODE
//  317 {
        FUNCALL ZDSecMgrExtAddrStore, AddrMgrExtAddrSet
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 26, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 26, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrExtAddrStore, AddrMgrEntryUpdate
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 26, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 26, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        REQUIRE ?V2
        REQUIRE ?V3
        REQUIRE ?V4
        MOV       A,#-0xd
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 13)
        ; Saved register size: 13
        ; Auto size: 13
        MOV       A,#-0xd
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 26)
        MOV       ?V2,R2
        MOV       ?V3,R3
        MOV       A,R4
        MOV       R6,A
        MOV       A,R5
        MOV       R7,A
        MOV       A,#0x1a
        LCALL     ?XSTACK_DISP0_8
        MOVX      A,@DPTR
        MOV       ?V0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       ?V1,A
//  318   ZStatus_t      status;
//  319   AddrMgrEntry_t entry;
//  320 
//  321 
//  322   // add entry
//  323   entry.user    = ADDRMGR_USER_SECURITY;
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOV       A,#0x2
        MOVX      @DPTR,A
//  324   entry.nwkAddr = nwkAddr;
        MOV       A,#0x1
        LCALL     ?XSTACK_DISP0_8
        MOV       A,?V2
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,?V3
        MOVX      @DPTR,A
//  325   AddrMgrExtAddrSet( entry.extAddr, extAddr );
        ; Setup parameters for call to function AddrMgrExtAddrSet
        MOV       A,R6
        MOV       R4,A
        MOV       A,R7
        MOV       R5,A
        MOV       A,#0x3
        LCALL     ?XSTACK_DISP0_8
        MOV       R2,DPL
        MOV       R3,DPH
        LCALL     `??AddrMgrExtAddrSet::?relay`; Banked call to: AddrMgrExtAddrSet
//  326 
//  327   if ( AddrMgrEntryUpdate( &entry ) == TRUE )
        ; Setup parameters for call to function AddrMgrEntryUpdate
        MOV       R2,?XSP + 0
        MOV       R3,?XSP + 1
        LCALL     `??AddrMgrEntryUpdate::?relay`; Banked call to: AddrMgrEntryUpdate
        MOV       A,R1
        XRL       A,#0x1
        JNZ       ??ZDSecMgrExtAddrStore_0
//  328   {
//  329     // return successful results
//  330     *ami   = entry.index;
        MOV       A,#0xb
        LCALL     ?XSTACK_DISP0_8
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       DPL,?V0
        MOV       DPH,?V1
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
//  331     status = ZSuccess;
        MOV       ?V4,#0x0
        SJMP      ??ZDSecMgrExtAddrStore_1
//  332   }
//  333   else
//  334   {
//  335     // return failed results
//  336     *ami   = entry.index;
??ZDSecMgrExtAddrStore_0:
        MOV       A,#0xb
        LCALL     ?XSTACK_DISP0_8
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       DPL,?V0
        MOV       DPH,?V1
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
//  337     status = ZNwkUnknownDevice;
        MOV       ?V4,#-0x38
//  338   }
//  339 
//  340   return status;
??ZDSecMgrExtAddrStore_1:
        MOV       R1,?V4
        MOV       A,#0xd
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 13)
        MOV       R7,#0x5
        LJMP      ?BANKED_LEAVE_XDATA
//  341 }
          CFI EndBlock cfiBlock1
//  342 
//  343 /******************************************************************************
//  344  * @fn          ZDSecMgrExtAddrLookup
//  345  *
//  346  * @brief       Lookup index for specified EXT address.
//  347  *
//  348  * @param       extAddr - [in] EXT address
//  349  * @param       ami     - [out] Address Manager index
//  350  *
//  351  * @return      ZStatus_t
//  352  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
//  353 ZStatus_t ZDSecMgrExtAddrLookup( uint8* extAddr, uint16* ami )
ZDSecMgrExtAddrLookup:
          CFI Block cfiBlock2 Using cfiCommon0
          CFI Function ZDSecMgrExtAddrLookup
        CODE
//  354 {
        FUNCALL ZDSecMgrExtAddrLookup, AddrMgrExtAddrSet
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 24, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 24, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrExtAddrLookup, AddrMgrEntryLookupExt
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 24, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 24, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        REQUIRE ?V2
        MOV       A,#-0xb
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 11)
        ; Saved register size: 11
        ; Auto size: 13
        MOV       A,#-0xd
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 24)
        MOV       A,R2
        MOV       R6,A
        MOV       A,R3
        MOV       R7,A
        MOV       ?V0,R4
        MOV       ?V1,R5
//  355   ZStatus_t      status;
//  356   AddrMgrEntry_t entry;
//  357 
//  358 
//  359   // lookup entry
//  360   entry.user = ADDRMGR_USER_SECURITY;
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOV       A,#0x2
        MOVX      @DPTR,A
//  361   AddrMgrExtAddrSet( entry.extAddr, extAddr );
        ; Setup parameters for call to function AddrMgrExtAddrSet
        MOV       A,R6
        MOV       R4,A
        MOV       A,R7
        MOV       R5,A
        MOV       A,#0x3
        LCALL     ?XSTACK_DISP0_8
        MOV       R2,DPL
        MOV       R3,DPH
        LCALL     `??AddrMgrExtAddrSet::?relay`; Banked call to: AddrMgrExtAddrSet
//  362 
//  363   if ( AddrMgrEntryLookupExt( &entry ) == TRUE )
        ; Setup parameters for call to function AddrMgrEntryLookupExt
        MOV       R2,?XSP + 0
        MOV       R3,?XSP + 1
        LCALL     `??AddrMgrEntryLookupExt::?relay`; Banked call to: AddrMgrEntryLookupExt
        MOV       A,R1
        XRL       A,#0x1
        JNZ       ??ZDSecMgrExtAddrLookup_0
//  364   {
//  365     // return successful results
//  366     *ami   = entry.index;
        MOV       A,#0xb
        LCALL     ?XSTACK_DISP0_8
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       DPL,?V0
        MOV       DPH,?V1
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
//  367     status = ZSuccess;
        MOV       ?V2,#0x0
        SJMP      ??ZDSecMgrExtAddrLookup_1
//  368   }
//  369   else
//  370   {
//  371     // return failed results
//  372     *ami   = entry.index;
??ZDSecMgrExtAddrLookup_0:
        MOV       A,#0xb
        LCALL     ?XSTACK_DISP0_8
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       DPL,?V0
        MOV       DPH,?V1
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
//  373     status = ZNwkUnknownDevice;
        MOV       ?V2,#-0x38
//  374   }
//  375 
//  376   return status;
??ZDSecMgrExtAddrLookup_1:
        MOV       R1,?V2
        MOV       A,#0xd
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 11)
        MOV       R7,#0x3
        LJMP      ?BANKED_LEAVE_XDATA
//  377 }
          CFI EndBlock cfiBlock2
//  378 
//  379 /******************************************************************************
//  380  * @fn          ZDSecMgrAddrClear
//  381  *
//  382  * @brief       Clear security bit from Address Manager for specific device.
//  383  *
//  384  * @param       extAddr - [in] EXT address
//  385  *
//  386  * @return      ZStatus_t
//  387  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
//  388 ZStatus_t ZDSecMgrAddrClear( uint8* extAddr )
ZDSecMgrAddrClear:
          CFI Block cfiBlock3 Using cfiCommon0
          CFI Function ZDSecMgrAddrClear
        CODE
//  389 {
        FUNCALL ZDSecMgrAddrClear, ZDSecMgrExtAddrLookup
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 24, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 24, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrAddrClear, AddrMgrEntryRelease
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 24, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 24, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        MOV       A,#-0x9
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 15
        MOV       A,#-0xf
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 24)
        MOV       A,R2
        MOV       R6,A
        MOV       A,R3
        MOV       R7,A
//  390   ZStatus_t status;
//  391   uint16 entryAmi;
//  392 
//  393   // get Address Manager Index
//  394   status = ZDSecMgrExtAddrLookup( extAddr, &entryAmi );
        ; Setup parameters for call to function ZDSecMgrExtAddrLookup
        MOV       R4,?XSP + 0
        MOV       R5,?XSP + 1
        MOV       A,R6
        MOV       R2,A
        MOV       A,R7
        MOV       R3,A
        LCALL     `??ZDSecMgrExtAddrLookup::?relay`; Banked call to: ZDSecMgrExtAddrLookup
        MOV       A,R1
        MOV       ?V0,A
//  395 
//  396   if ( status == ZSuccess )
        MOV       A,?V0
        JNZ       ??ZDSecMgrAddrClear_0
//  397   {
//  398     AddrMgrEntry_t addrEntry;
//  399 
//  400     // Clear SECURITY User bit from the address manager
//  401     addrEntry.user = ADDRMGR_USER_SECURITY;
        MOV       A,#0x2
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x2
        MOVX      @DPTR,A
//  402     addrEntry.index = entryAmi;
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       A,#0xd
        LCALL     ?XSTACK_DISP0_8
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
//  403 
//  404     if ( AddrMgrEntryRelease( &addrEntry ) != TRUE )
        ; Setup parameters for call to function AddrMgrEntryRelease
        MOV       A,#0x2
        LCALL     ?XSTACK_DISP101_8
        LCALL     `??AddrMgrEntryRelease::?relay`; Banked call to: AddrMgrEntryRelease
        MOV       A,R1
        XRL       A,#0x1
        JZ        ??ZDSecMgrAddrClear_0
//  405     {
//  406       // return failure results
//  407       status = ZFailure;
        MOV       ?V0,#0x1
//  408     }
//  409   }
//  410 
//  411   return status;
??ZDSecMgrAddrClear_0:
        MOV       R1,?V0
        MOV       A,#0xf
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 9)
        MOV       R7,#0x1
        LJMP      ?BANKED_LEAVE_XDATA
//  412 }
          CFI EndBlock cfiBlock3
//  413 
//  414 /******************************************************************************
//  415  * @fn          ZDSecMgrEntryInit
//  416  *
//  417  * @brief       Initialize entry sub module
//  418  *
//  419  * @param       state - device initialization state
//  420  *
//  421  * @return      none
//  422  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
//  423 void ZDSecMgrEntryInit(uint8 state)
ZDSecMgrEntryInit:
          CFI Block cfiBlock4 Using cfiCommon0
          CFI Function ZDSecMgrEntryInit
        CODE
//  424 {
        FUNCALL ZDSecMgrEntryInit, osal_mem_alloc
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrEntryInit, ZDSecMgrRestoreFromNV
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        MOV       A,#-0x9
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
        MOV       ?V0,R1
//  425   if (ZDSecMgrEntries == NULL)
        MOV       DPTR,#ZDSecMgrEntries
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       A,R0
        ORL       A,R1
        JZ        $+5
        LJMP      ??ZDSecMgrEntryInit_0 & 0xFFFF
//  426   {
//  427     uint16 index;
//  428 
//  429     if ((ZDSecMgrEntries = osal_mem_alloc(sizeof(ZDSecMgrEntry_t) * ZDSECMGR_ENTRY_MAX)) == NULL)
        ; Setup parameters for call to function osal_mem_alloc
        MOV       R2,#0xf
        MOV       R3,#0x0
        LCALL     `??osal_mem_alloc::?relay`; Banked call to: osal_mem_alloc
        MOV       DPTR,#ZDSecMgrEntries
        MOV       A,R2
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R3
        MOVX      @DPTR,A
        MOV       DPTR,#ZDSecMgrEntries
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       A,R0
        ORL       A,R1
        JZ        ??ZDSecMgrEntryInit_1
//  430     {
//  431       return;
//  432     }
//  433 
//  434     for (index = 0; index < ZDSECMGR_ENTRY_MAX; index++)
        MOV       R6,#0x0
        MOV       R7,#0x0
??ZDSecMgrEntryInit_2:
        CLR       C
        MOV       A,R6
        SUBB      A,#0x3
        MOV       A,R7
        SUBB      A,#0x0
        JNC       ??ZDSecMgrEntryInit_0
//  435     {
//  436       ZDSecMgrEntries[index].ami = INVALID_NODE_ADDR;
        MOV       A,R6
        MOV       R0,A
        MOV       A,R7
        MOV       R1,A
        MOV       A,R0
        MOV       B,#0x5
        MUL       AB
        XCH       A,R0
        MOV       R2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R2
        MOV       R2,A
        MOV       B,#0x5
        MOV       A,R1
        MUL       AB
        ADD       A,R2
        MOV       R1,A
        MOV       DPTR,#ZDSecMgrEntries
        MOVX      A,@DPTR
        ADD       A,R0
        MOV       R2,A
        INC       DPTR
        MOVX      A,@DPTR
        ADDC      A,R1
        MOV       DPL,R2
        MOV       DPH,A
        MOV       A,#-0x2
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#-0x1
        MOVX      @DPTR,A
//  437 
//  438       ZDSecMgrEntries[index].keyNvId = SEC_NO_KEY_NV_ID;
        MOV       A,R6
        MOV       R0,A
        MOV       A,R7
        MOV       R1,A
        MOV       A,R0
        MOV       B,#0x5
        MUL       AB
        XCH       A,R0
        MOV       R2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R2
        MOV       R2,A
        MOV       B,#0x5
        MOV       A,R1
        MUL       AB
        ADD       A,R2
        MOV       R1,A
        MOV       DPTR,#ZDSecMgrEntries
        MOVX      A,@DPTR
        ADD       A,R0
        MOV       R2,A
        INC       DPTR
        MOVX      A,@DPTR
        ADDC      A,R1
        MOV       DPL,R2
        MOV       DPH,A
        INC       DPTR
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
//  439     }
        INC       R6
        MOV       A,R6
        JNZ       ??ZDSecMgrEntryInit_2
        INC       R7
        SJMP      ??ZDSecMgrEntryInit_2
//  440   }
//  441 
//  442 #if defined NV_RESTORE
//  443   if (state == ZDO_INITDEV_RESTORED_NETWORK_STATE)
??ZDSecMgrEntryInit_0:
        MOV       A,?V0
        JNZ       ??ZDSecMgrEntryInit_1
//  444   {
//  445     ZDSecMgrRestoreFromNV();
        ; Setup parameters for call to function ZDSecMgrRestoreFromNV
        LCALL     `??ZDSecMgrRestoreFromNV::?relay`; Banked call to: ZDSecMgrRestoreFromNV
//  446   }
//  447 #else
//  448   (void)state;
//  449 #endif
//  450 }
??ZDSecMgrEntryInit_1:
        MOV       R7,#0x1
        LJMP      ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock4
//  451 
//  452 /******************************************************************************
//  453  * @fn          ZDSecMgrEntryLookup
//  454  *
//  455  * @brief       Lookup entry index using specified NWK address.
//  456  *
//  457  * @param       nwkAddr - [in] NWK address
//  458  * @param       entry   - [out] valid entry
//  459  *
//  460  * @return      ZStatus_t
//  461  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
//  462 ZStatus_t ZDSecMgrEntryLookup( uint16 nwkAddr, ZDSecMgrEntry_t** entry )
ZDSecMgrEntryLookup:
          CFI Block cfiBlock5 Using cfiCommon0
          CFI Function ZDSecMgrEntryLookup
        CODE
//  463 {
        FUNCALL ZDSecMgrEntryLookup, AddrMgrEntryLookupNwk
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 25, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 25, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        REQUIRE ?V2
        REQUIRE ?V3
        MOV       A,#-0xc
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 12)
        ; Saved register size: 12
        ; Auto size: 13
        MOV       A,#-0xd
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 25)
        MOV       ?V2,R2
        MOV       ?V3,R3
        MOV       ?V0,R4
        MOV       ?V1,R5
//  464   uint16         index;
//  465   AddrMgrEntry_t addrMgrEntry;
//  466 
//  467   // initialize results
//  468   *entry = NULL;
        MOV       DPL,?V0
        MOV       DPH,?V1
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
//  469 
//  470   // verify data is available
//  471   if ( ZDSecMgrEntries != NULL )
        MOV       DPTR,#ZDSecMgrEntries
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       A,R0
        ORL       A,R1
        JNZ       $+5
        LJMP      ??ZDSecMgrEntryLookup_0 & 0xFFFF
//  472   {
//  473     addrMgrEntry.user    = ADDRMGR_USER_SECURITY;
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOV       A,#0x2
        MOVX      @DPTR,A
//  474     addrMgrEntry.nwkAddr = nwkAddr;
        MOV       A,#0x1
        LCALL     ?XSTACK_DISP0_8
        MOV       A,?V2
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,?V3
        MOVX      @DPTR,A
//  475 
//  476     if ( AddrMgrEntryLookupNwk( &addrMgrEntry ) == TRUE )
        ; Setup parameters for call to function AddrMgrEntryLookupNwk
        MOV       R2,?XSP + 0
        MOV       R3,?XSP + 1
        LCALL     `??AddrMgrEntryLookupNwk::?relay`; Banked call to: AddrMgrEntryLookupNwk
        MOV       A,R1
        XRL       A,#0x1
        JNZ       ??ZDSecMgrEntryLookup_0
//  477     {
//  478       for ( index = 0; index < ZDSECMGR_ENTRY_MAX ; index++ )
        MOV       R6,#0x0
        MOV       R7,#0x0
??ZDSecMgrEntryLookup_1:
        CLR       C
        MOV       A,R6
        SUBB      A,#0x3
        MOV       A,R7
        SUBB      A,#0x0
        JNC       ??ZDSecMgrEntryLookup_0
//  479       {
//  480         if ( addrMgrEntry.index == ZDSecMgrEntries[index].ami )
        MOV       A,#0xb
        LCALL     ?XSTACK_DISP0_8
        MOVX      A,@DPTR
        MOV       R2,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R3,A
        MOV       A,R6
        MOV       R0,A
        MOV       A,R7
        MOV       R1,A
        MOV       A,R0
        MOV       B,#0x5
        MUL       AB
        XCH       A,R0
        MOV       R4,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R4
        MOV       R4,A
        MOV       B,#0x5
        MOV       A,R1
        MUL       AB
        ADD       A,R4
        MOV       R1,A
        MOV       DPTR,#ZDSecMgrEntries
        MOVX      A,@DPTR
        ADD       A,R0
        MOV       R4,A
        INC       DPTR
        MOVX      A,@DPTR
        ADDC      A,R1
        MOV       DPL,R4
        MOV       DPH,A
        MOVX      A,@DPTR
        XRL       A,R2
        JNZ       ??ZDSecMgrEntryLookup_2
        INC       DPTR
        MOVX      A,@DPTR
        XRL       A,R3
??ZDSecMgrEntryLookup_2:
        JNZ       ??ZDSecMgrEntryLookup_3
//  481         {
//  482           // return successful results
//  483           *entry = &ZDSecMgrEntries[index];
        MOV       A,R6
        MOV       R0,A
        MOV       A,R7
        MOV       R1,A
        MOV       A,R0
        MOV       B,#0x5
        MUL       AB
        XCH       A,R0
        MOV       R2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R2
        MOV       R2,A
        MOV       B,#0x5
        MOV       A,R1
        MUL       AB
        ADD       A,R2
        MOV       R1,A
        MOV       DPTR,#ZDSecMgrEntries
        MOVX      A,@DPTR
        ADD       A,R0
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        ADDC      A,R1
        MOV       R1,A
        MOV       DPL,?V0
        MOV       DPH,?V1
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
//  484 
//  485           // break from loop
//  486           return ZSuccess;
        MOV       R1,#0x0
        SJMP      ??ZDSecMgrEntryLookup_4
//  487         }
//  488       }
??ZDSecMgrEntryLookup_3:
        INC       R6
        MOV       A,R6
        JNZ       ??ZDSecMgrEntryLookup_1
        INC       R7
        SJMP      ??ZDSecMgrEntryLookup_1
//  489     }
//  490   }
//  491 
//  492   return ZNwkUnknownDevice;
??ZDSecMgrEntryLookup_0:
        MOV       R1,#-0x38
??ZDSecMgrEntryLookup_4:
        MOV       A,#0xd
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 12)
        MOV       R7,#0x4
        LJMP      ?BANKED_LEAVE_XDATA
//  493 }
          CFI EndBlock cfiBlock5
//  494 
//  495 /******************************************************************************
//  496  * @fn          ZDSecMgrEntryLookupAMI
//  497  *
//  498  * @brief       Lookup entry using specified address index
//  499  *
//  500  * @param       ami   - [in] Address Manager index
//  501  * @param       entry - [out] valid entry
//  502  *
//  503  * @return      ZStatus_t
//  504  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
//  505 ZStatus_t ZDSecMgrEntryLookupAMI( uint16 ami, ZDSecMgrEntry_t** entry )
ZDSecMgrEntryLookupAMI:
          CFI Block cfiBlock6 Using cfiCommon0
          CFI Function ZDSecMgrEntryLookupAMI
        CODE
//  506 {
        REQUIRE ?V0
        MOV       A,#-0x9
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
        MOV       A,R2
        MOV       R6,A
        MOV       A,R3
        MOV       R7,A
//  507   uint16 index;
//  508 
//  509   // initialize results
//  510   *entry = NULL;
        MOV       DPL,R4
        MOV       DPH,R5
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
//  511 
//  512   // verify data is available
//  513   if ( ZDSecMgrEntries != NULL )
        MOV       DPTR,#ZDSecMgrEntries
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       A,R0
        ORL       A,R1
        JZ        ??ZDSecMgrEntryLookupAMI_0
//  514   {
//  515     for ( index = 0; index < ZDSECMGR_ENTRY_MAX ; index++ )
        MOV       R2,#0x0
        MOV       R3,#0x0
??ZDSecMgrEntryLookupAMI_1:
        CLR       C
        MOV       A,R2
        SUBB      A,#0x3
        MOV       A,R3
        SUBB      A,#0x0
        JNC       ??ZDSecMgrEntryLookupAMI_0
//  516     {
//  517       if ( ZDSecMgrEntries[index].ami == ami )
        MOV       A,R2
        MOV       R0,A
        MOV       A,R3
        MOV       R1,A
        MOV       A,R0
        MOV       B,#0x5
        MUL       AB
        XCH       A,R0
        MOV       ?V0,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,?V0
        MOV       ?V0,A
        MOV       B,#0x5
        MOV       A,R1
        MUL       AB
        ADD       A,?V0
        MOV       R1,A
        MOV       DPTR,#ZDSecMgrEntries
        MOVX      A,@DPTR
        ADD       A,R0
        MOV       ?V0,A
        INC       DPTR
        MOVX      A,@DPTR
        ADDC      A,R1
        MOV       DPL,?V0
        MOV       DPH,A
        MOVX      A,@DPTR
        XRL       A,R6
        JNZ       ??ZDSecMgrEntryLookupAMI_2
        INC       DPTR
        MOVX      A,@DPTR
        XRL       A,R7
??ZDSecMgrEntryLookupAMI_2:
        JNZ       ??ZDSecMgrEntryLookupAMI_3
//  518       {
//  519         // return successful results
//  520         *entry = &ZDSecMgrEntries[index];
        MOV       A,R2
        MOV       R0,A
        MOV       A,R3
        MOV       R1,A
        MOV       A,R0
        MOV       B,#0x5
        MUL       AB
        XCH       A,R0
        MOV       ?V0,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,?V0
        MOV       ?V0,A
        MOV       B,#0x5
        MOV       A,R1
        MUL       AB
        ADD       A,?V0
        MOV       R1,A
        MOV       DPTR,#ZDSecMgrEntries
        MOVX      A,@DPTR
        ADD       A,R0
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        ADDC      A,R1
        MOV       R1,A
        MOV       DPL,R4
        MOV       DPH,R5
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
//  521 
//  522         // break from loop
//  523         return ZSuccess;
        MOV       R1,#0x0
        SJMP      ??ZDSecMgrEntryLookupAMI_4
//  524       }
//  525     }
??ZDSecMgrEntryLookupAMI_3:
        INC       R2
        MOV       A,R2
        JNZ       ??ZDSecMgrEntryLookupAMI_1
        INC       R3
        SJMP      ??ZDSecMgrEntryLookupAMI_1
//  526   }
//  527 
//  528   return ZNwkUnknownDevice;
??ZDSecMgrEntryLookupAMI_0:
        MOV       R1,#-0x38
??ZDSecMgrEntryLookupAMI_4:
        MOV       R7,#0x1
        LJMP      ?BANKED_LEAVE_XDATA
//  529 }
          CFI EndBlock cfiBlock6
//  530 
//  531 /******************************************************************************
//  532  * @fn          ZDSecMgrEntryLookupExt
//  533  *
//  534  * @brief       Lookup entry index using specified EXT address.
//  535  *
//  536  * @param       extAddr - [in] EXT address
//  537  * @param       entry   - [out] valid entry
//  538  *
//  539  * @return      ZStatus_t
//  540  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
//  541 ZStatus_t ZDSecMgrEntryLookupExt( uint8* extAddr, ZDSecMgrEntry_t** entry )
ZDSecMgrEntryLookupExt:
          CFI Block cfiBlock7 Using cfiCommon0
          CFI Function ZDSecMgrEntryLookupExt
        CODE
//  542 {
        FUNCALL ZDSecMgrEntryLookupExt, ZDSecMgrExtAddrLookup
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 13, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 13, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrEntryLookupExt, ZDSecMgrEntryLookupAMI
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 13, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 13, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        REQUIRE ?V2
        MOV       A,#-0xb
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 11)
        ; Saved register size: 11
        ; Auto size: 2
        MOV       A,#-0x2
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 13)
        MOV       ?V0,R2
        MOV       ?V1,R3
        MOV       A,R4
        MOV       R6,A
        MOV       A,R5
        MOV       R7,A
//  543   ZStatus_t status;
//  544   uint16    ami;
//  545 
//  546   // initialize results
//  547   *entry = NULL;
        MOV       DPL,R6
        MOV       DPH,R7
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
//  548   status = ZNwkUnknownDevice;
        MOV       ?V2,#-0x38
//  549 
//  550   // lookup address index
//  551   if ( ZDSecMgrExtAddrLookup( extAddr, &ami ) == ZSuccess )
        ; Setup parameters for call to function ZDSecMgrExtAddrLookup
        MOV       R4,?XSP + 0
        MOV       R5,?XSP + 1
        MOV       R2,?V0
        MOV       R3,?V1
        LCALL     `??ZDSecMgrExtAddrLookup::?relay`; Banked call to: ZDSecMgrExtAddrLookup
        MOV       A,R1
        JNZ       ??ZDSecMgrEntryLookupExt_0
//  552   {
//  553     status = ZDSecMgrEntryLookupAMI( ami, entry );
        ; Setup parameters for call to function ZDSecMgrEntryLookupAMI
        MOV       A,R6
        MOV       R4,A
        MOV       A,R7
        MOV       R5,A
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOVX      A,@DPTR
        MOV       R2,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R3,A
        LCALL     `??ZDSecMgrEntryLookupAMI::?relay`; Banked call to: ZDSecMgrEntryLookupAMI
        MOV       A,R1
        MOV       ?V2,A
//  554   }
//  555 
//  556   return status;
??ZDSecMgrEntryLookupExt_0:
        MOV       R1,?V2
        MOV       A,#0x2
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 11)
        MOV       R7,#0x3
        LJMP      ?BANKED_LEAVE_XDATA
//  557 }
          CFI EndBlock cfiBlock7
//  558 
//  559 /******************************************************************************
//  560  * @fn          ZDSecMgrEntryLookupExtGetIndex
//  561  *
//  562  * @brief       Lookup entry index using specified EXT address.
//  563  *
//  564  * @param       extAddr - [in] EXT address
//  565  * @param       entryIndex - [out] valid index to the entry table
//  566  *
//  567  * @return      ZStatus_t
//  568  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
//  569 ZStatus_t ZDSecMgrEntryLookupExtGetIndex( uint8* extAddr, ZDSecMgrEntry_t** entry, uint16* entryIndex )
ZDSecMgrEntryLookupExtGetIndex:
          CFI Block cfiBlock8 Using cfiCommon0
          CFI Function ZDSecMgrEntryLookupExtGetIndex
        CODE
//  570 {
        FUNCALL ZDSecMgrEntryLookupExtGetIndex, ZDSecMgrExtAddrLookup
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 16, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 16, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        REQUIRE ?V2
        REQUIRE ?V3
        REQUIRE ?V4
        REQUIRE ?V5
        MOV       A,#-0xe
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 14)
        ; Saved register size: 14
        ; Auto size: 2
        MOV       A,#-0x2
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 16)
        MOV       ?V4,R2
        MOV       ?V5,R3
        MOV       A,R4
        MOV       R6,A
        MOV       A,R5
        MOV       R7,A
        MOV       A,#0x10
        LCALL     ?XSTACK_DISP0_8
        MOVX      A,@DPTR
        MOV       ?V0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       ?V1,A
//  571   uint16 ami;
//  572   uint16 index;
//  573 
//  574   // lookup address index
//  575   if ( ZDSecMgrExtAddrLookup( extAddr, &ami ) == ZSuccess )
        ; Setup parameters for call to function ZDSecMgrExtAddrLookup
        MOV       R4,?XSP + 0
        MOV       R5,?XSP + 1
        MOV       R2,?V4
        MOV       R3,?V5
        LCALL     `??ZDSecMgrExtAddrLookup::?relay`; Banked call to: ZDSecMgrExtAddrLookup
        MOV       A,R1
        JZ        $+5
        LJMP      ??ZDSecMgrEntryLookupExtGetIndex_0 & 0xFFFF
//  576   {
//  577     // verify data is available
//  578     if ( ZDSecMgrEntries != NULL )
        MOV       DPTR,#ZDSecMgrEntries
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       A,R0
        ORL       A,R1
        JNZ       $+5
        LJMP      ??ZDSecMgrEntryLookupExtGetIndex_0 & 0xFFFF
//  579     {
//  580       for ( index = 0; index < ZDSECMGR_ENTRY_MAX ; index++ )
        MOV       ?V2,#0x0
        MOV       ?V3,#0x0
??ZDSecMgrEntryLookupExtGetIndex_1:
        CLR       C
        MOV       A,?V2
        SUBB      A,#0x3
        MOV       A,?V3
        SUBB      A,#0x0
        JC        $+5
        LJMP      ??ZDSecMgrEntryLookupExtGetIndex_0 & 0xFFFF
//  581       {
//  582         if ( ZDSecMgrEntries[index].ami == ami )
        MOV       R0,?V2
        MOV       R1,?V3
        MOV       A,R0
        MOV       B,#0x5
        MUL       AB
        XCH       A,R0
        MOV       R2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R2
        MOV       R2,A
        MOV       B,#0x5
        MOV       A,R1
        MUL       AB
        ADD       A,R2
        MOV       R1,A
        MOV       DPTR,#ZDSecMgrEntries
        MOVX      A,@DPTR
        ADD       A,R0
        MOV       R2,A
        INC       DPTR
        MOVX      A,@DPTR
        ADDC      A,R1
        MOV       DPL,R2
        MOV       DPH,A
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOVX      A,@DPTR
        XRL       A,R0
        JNZ       ??ZDSecMgrEntryLookupExtGetIndex_2
        INC       DPTR
        MOVX      A,@DPTR
        XRL       A,R1
??ZDSecMgrEntryLookupExtGetIndex_2:
        JNZ       ??ZDSecMgrEntryLookupExtGetIndex_3
//  583         {
//  584           // return successful results
//  585           *entry = &ZDSecMgrEntries[index];
        MOV       R0,?V2
        MOV       R1,?V3
        MOV       A,R0
        MOV       B,#0x5
        MUL       AB
        XCH       A,R0
        MOV       R2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R2
        MOV       R2,A
        MOV       B,#0x5
        MOV       A,R1
        MUL       AB
        ADD       A,R2
        MOV       R1,A
        MOV       DPTR,#ZDSecMgrEntries
        MOVX      A,@DPTR
        ADD       A,R0
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        ADDC      A,R1
        MOV       R1,A
        MOV       DPL,R6
        MOV       DPH,R7
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
//  586           *entryIndex = index;
        MOV       DPL,?V0
        MOV       DPH,?V1
        MOV       A,?V2
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,?V3
        MOVX      @DPTR,A
//  587 
//  588           // break from loop
//  589           return ZSuccess;
        MOV       R1,#0x0
        SJMP      ??ZDSecMgrEntryLookupExtGetIndex_4
//  590         }
//  591       }
??ZDSecMgrEntryLookupExtGetIndex_3:
        INC       ?V2
        MOV       A,?V2
        JNZ       ??ZDSecMgrEntryLookupExtGetIndex_5
        INC       ?V3
??ZDSecMgrEntryLookupExtGetIndex_5:
        LJMP      ??ZDSecMgrEntryLookupExtGetIndex_1 & 0xFFFF
//  592     }
//  593   }
//  594 
//  595   return ZNwkUnknownDevice;
??ZDSecMgrEntryLookupExtGetIndex_0:
        MOV       R1,#-0x38
??ZDSecMgrEntryLookupExtGetIndex_4:
        MOV       A,#0x2
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 14)
        MOV       R7,#0x6
        LJMP      ?BANKED_LEAVE_XDATA
//  596 }
          CFI EndBlock cfiBlock8
//  597 
//  598 /******************************************************************************
//  599  * @fn          ZDSecMgrEntryLookupAMIGetIndex
//  600  *
//  601  * @brief       Lookup entry using specified address index
//  602  *
//  603  * @param       ami   - [in] Address Manager index
//  604  * @param       entryIndex - [out] valid index to the entry table
//  605  *
//  606  * @return      ZStatus_t
//  607  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
//  608 ZStatus_t ZDSecMgrEntryLookupAMIGetIndex( uint16 ami, uint16* entryIndex )
ZDSecMgrEntryLookupAMIGetIndex:
          CFI Block cfiBlock9 Using cfiCommon0
          CFI Function ZDSecMgrEntryLookupAMIGetIndex
        CODE
//  609 {
        REQUIRE ?V0
        MOV       A,#-0x9
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
//  610   uint16 index;
//  611 
//  612   // verify data is available
//  613   if ( ZDSecMgrEntries != NULL )
        MOV       DPTR,#ZDSecMgrEntries
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       A,R0
        ORL       A,R1
        JZ        ??ZDSecMgrEntryLookupAMIGetIndex_0
//  614   {
//  615     for ( index = 0; index < ZDSECMGR_ENTRY_MAX ; index++ )
        MOV       R6,#0x0
        MOV       R7,#0x0
??ZDSecMgrEntryLookupAMIGetIndex_1:
        CLR       C
        MOV       A,R6
        SUBB      A,#0x3
        MOV       A,R7
        SUBB      A,#0x0
        JNC       ??ZDSecMgrEntryLookupAMIGetIndex_0
//  616     {
//  617       if ( ZDSecMgrEntries[index].ami == ami )
        MOV       A,R6
        MOV       R0,A
        MOV       A,R7
        MOV       R1,A
        MOV       A,R0
        MOV       B,#0x5
        MUL       AB
        XCH       A,R0
        MOV       ?V0,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,?V0
        MOV       ?V0,A
        MOV       B,#0x5
        MOV       A,R1
        MUL       AB
        ADD       A,?V0
        MOV       R1,A
        MOV       DPTR,#ZDSecMgrEntries
        MOVX      A,@DPTR
        ADD       A,R0
        MOV       ?V0,A
        INC       DPTR
        MOVX      A,@DPTR
        ADDC      A,R1
        MOV       DPL,?V0
        MOV       DPH,A
        MOVX      A,@DPTR
        XRL       A,R2
        JNZ       ??ZDSecMgrEntryLookupAMIGetIndex_2
        INC       DPTR
        MOVX      A,@DPTR
        XRL       A,R3
??ZDSecMgrEntryLookupAMIGetIndex_2:
        JNZ       ??ZDSecMgrEntryLookupAMIGetIndex_3
//  618       {
//  619         // return successful results
//  620         *entryIndex = index;
        MOV       DPL,R4
        MOV       DPH,R5
        MOV       A,R6
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R7
        MOVX      @DPTR,A
//  621 
//  622         // break from loop
//  623         return ZSuccess;
        MOV       R1,#0x0
        SJMP      ??ZDSecMgrEntryLookupAMIGetIndex_4
//  624       }
//  625     }
??ZDSecMgrEntryLookupAMIGetIndex_3:
        INC       R6
        MOV       A,R6
        JNZ       ??ZDSecMgrEntryLookupAMIGetIndex_1
        INC       R7
        SJMP      ??ZDSecMgrEntryLookupAMIGetIndex_1
//  626   }
//  627 
//  628   return ZNwkUnknownDevice;
??ZDSecMgrEntryLookupAMIGetIndex_0:
        MOV       R1,#-0x38
??ZDSecMgrEntryLookupAMIGetIndex_4:
        MOV       R7,#0x1
        LJMP      ?BANKED_LEAVE_XDATA
//  629 }
          CFI EndBlock cfiBlock9
//  630 
//  631 /******************************************************************************
//  632  * @fn          ZDSecMgrEntryFree
//  633  *
//  634  * @brief       Free entry.
//  635  *
//  636  * @param       entry - [in] valid entry
//  637  *
//  638  * @return      ZStatus_t
//  639  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
//  640 void ZDSecMgrEntryFree( ZDSecMgrEntry_t* entry )
ZDSecMgrEntryFree:
          CFI Block cfiBlock10 Using cfiCommon0
          CFI Function ZDSecMgrEntryFree
        CODE
//  641 {
        FUNCALL ZDSecMgrEntryFree, ZDSecMgrEntryLookupAMIGetIndex
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 16, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 16, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrEntryFree, osal_mem_alloc
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 16, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 16, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrEntryFree, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 16, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 16, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrEntryFree, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 20, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 20, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrEntryFree, osal_mem_free
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 16, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 16, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrEntryFree, ZDSecMgrUpdateNV
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 16, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 16, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V2
        REQUIRE ?V3
        REQUIRE ?V4
        REQUIRE ?V5
        MOV       A,#-0xe
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 14)
        ; Saved register size: 14
        ; Auto size: 2
        MOV       A,#-0x2
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 16)
        MOV       A,R2
        MOV       R6,A
        MOV       A,R3
        MOV       R7,A
//  642   APSME_LinkKeyData_t   *pApsLinkKey = NULL;
        MOV       ?V2,#0x0
        MOV       ?V3,#0x0
//  643 
//  644 #if defined ( NV_RESTORE )
//  645   ZStatus_t status;
//  646   uint16 entryIndex;
//  647 
//  648   status = ZDSecMgrEntryLookupAMIGetIndex( entry->ami, &entryIndex );
        ; Setup parameters for call to function ZDSecMgrEntryLookupAMIGetIndex
        MOV       R4,?XSP + 0
        MOV       R5,?XSP + 1
        MOV       DPL,R6
        MOV       DPH,R7
        MOVX      A,@DPTR
        MOV       R2,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R3,A
        LCALL     `??ZDSecMgrEntryLookupAMIGetIndex::?relay`; Banked call to: ZDSecMgrEntryLookupAMIGetIndex
        MOV       A,R1
        MOV       ?V0,A
//  649 #endif
//  650 
//  651   pApsLinkKey = (APSME_LinkKeyData_t *)osal_mem_alloc(sizeof(APSME_LinkKeyData_t));
        ; Setup parameters for call to function osal_mem_alloc
        MOV       R2,#0x18
        MOV       R3,#0x0
        LCALL     `??osal_mem_alloc::?relay`; Banked call to: osal_mem_alloc
        MOV       ?V4,R2
        MOV       ?V5,R3
        MOV       ?V2,?V4
        MOV       ?V3,?V5
//  652 
//  653   if (pApsLinkKey != NULL)
        MOV       A,?V2
        ORL       A,?V3
        JZ        ??ZDSecMgrEntryFree_0
//  654   {
//  655     osal_memset( pApsLinkKey, 0x00, sizeof(APSME_LinkKeyData_t) );
        ; Setup parameters for call to function osal_memset
        MOV       R4,#0x18
        MOV       R5,#0x0
        MOV       R1,#0x0
        MOV       R2,?V2
        MOV       R3,?V3
        LCALL     `??osal_memset::?relay`; Banked call to: osal_memset
//  656 
//  657     // Clear the APS Link key in NV
//  658     osal_nv_write( entry->keyNvId, 0,
//  659                         sizeof(APSME_LinkKeyData_t), pApsLinkKey);
        ; Setup parameters for call to function osal_nv_write
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 18)
        MOV       ?V4,#0x18
        MOV       ?V5,#0x0
        MOV       R0,#?V4
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 20)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R2,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R3,A
        LCALL     `??osal_nv_write::?relay`; Banked call to: osal_nv_write
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 16)
        MOV       A,R1
//  660 
//  661     // set entry to invalid Key
//  662     entry->keyNvId = SEC_NO_KEY_NV_ID;
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
//  663 
//  664     osal_mem_free(pApsLinkKey);
        ; Setup parameters for call to function osal_mem_free
        MOV       R2,?V2
        MOV       R3,?V3
        LCALL     `??osal_mem_free::?relay`; Banked call to: osal_mem_free
//  665   }
//  666 
//  667   // marking the entry as INVALID_NODE_ADDR
//  668   entry->ami = INVALID_NODE_ADDR;
??ZDSecMgrEntryFree_0:
        MOV       DPL,R6
        MOV       DPH,R7
        MOV       A,#-0x2
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#-0x1
        MOVX      @DPTR,A
//  669 
//  670   // set to default value
//  671   entry->authenticateOption = ZDSecMgr_Not_Authenticated;
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
//  672 
//  673 #if defined ( NV_RESTORE )
//  674   if ( status == ZSuccess )
        MOV       A,?V0
        JNZ       ??ZDSecMgrEntryFree_1
//  675   {
//  676     ZDSecMgrUpdateNV(entryIndex);
        ; Setup parameters for call to function ZDSecMgrUpdateNV
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOVX      A,@DPTR
        MOV       R2,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R3,A
        LCALL     `??ZDSecMgrUpdateNV::?relay`; Banked call to: ZDSecMgrUpdateNV
//  677   }
//  678 #endif
//  679 }
??ZDSecMgrEntryFree_1:
        MOV       A,#0x2
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 14)
        MOV       R7,#0x6
        LJMP      ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock10
//  680 
//  681 /******************************************************************************
//  682  * @fn          ZDSecMgrEntryNew
//  683  *
//  684  * @brief       Get a new entry.
//  685  *
//  686  * @param       entry - [out] valid entry
//  687  *
//  688  * @return      ZStatus_t
//  689  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
//  690 ZStatus_t ZDSecMgrEntryNew( ZDSecMgrEntry_t** entry )
ZDSecMgrEntryNew:
          CFI Block cfiBlock11 Using cfiCommon0
          CFI Function ZDSecMgrEntryNew
        CODE
//  691 {
        MOV       A,#-0x9
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
        MOV       A,R2
        MOV       R4,A
        MOV       A,R3
        MOV       R5,A
//  692   uint16 index;
//  693 
//  694   // initialize results
//  695   *entry = NULL;
        MOV       DPL,R4
        MOV       DPH,R5
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
//  696 
//  697   // verify data is available
//  698   if ( ZDSecMgrEntries != NULL )
        MOV       DPTR,#ZDSecMgrEntries
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       A,R0
        ORL       A,R1
        JNZ       $+5
        LJMP      ??ZDSecMgrEntryNew_0 & 0xFFFF
//  699   {
//  700     // find available entry
//  701     for ( index = 0; index < ZDSECMGR_ENTRY_MAX ; index++ )
        MOV       R2,#0x0
        MOV       R3,#0x0
??ZDSecMgrEntryNew_1:
        CLR       C
        MOV       A,R2
        SUBB      A,#0x3
        MOV       A,R3
        SUBB      A,#0x0
        JC        $+5
        LJMP      ??ZDSecMgrEntryNew_0 & 0xFFFF
//  702     {
//  703       if ( ZDSecMgrEntries[index].ami == INVALID_NODE_ADDR )
        MOV       A,R2
        MOV       R0,A
        MOV       A,R3
        MOV       R1,A
        MOV       A,R0
        MOV       B,#0x5
        MUL       AB
        XCH       A,R0
        MOV       R6,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R6
        MOV       R6,A
        MOV       B,#0x5
        MOV       A,R1
        MUL       AB
        ADD       A,R6
        MOV       R1,A
        MOV       DPTR,#ZDSecMgrEntries
        MOVX      A,@DPTR
        ADD       A,R0
        MOV       R6,A
        INC       DPTR
        MOVX      A,@DPTR
        ADDC      A,R1
        MOV       DPL,R6
        MOV       DPH,A
        MOVX      A,@DPTR
        XRL       A,#0xfe
        JNZ       ??ZDSecMgrEntryNew_2
        INC       DPTR
        MOVX      A,@DPTR
        XRL       A,#0xff
??ZDSecMgrEntryNew_2:
        JNZ       ??ZDSecMgrEntryNew_3
//  704       {
//  705         // return successful result
//  706         *entry = &ZDSecMgrEntries[index];
        MOV       A,R2
        MOV       R0,A
        MOV       A,R3
        MOV       R1,A
        MOV       A,R0
        MOV       B,#0x5
        MUL       AB
        XCH       A,R0
        MOV       R6,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R6
        MOV       R6,A
        MOV       B,#0x5
        MOV       A,R1
        MUL       AB
        ADD       A,R6
        MOV       R1,A
        MOV       DPTR,#ZDSecMgrEntries
        MOVX      A,@DPTR
        ADD       A,R0
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        ADDC      A,R1
        MOV       R1,A
        MOV       DPL,R4
        MOV       DPH,R5
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
//  707 
//  708         // Set the authentication option to default
//  709         ZDSecMgrEntries[index].authenticateOption = ZDSecMgr_Not_Authenticated;
        MOV       A,R2
        MOV       R0,A
        MOV       A,R3
        MOV       R1,A
        MOV       A,R0
        MOV       B,#0x5
        MUL       AB
        XCH       A,R0
        MOV       R6,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R6
        MOV       R6,A
        MOV       B,#0x5
        MOV       A,R1
        MUL       AB
        ADD       A,R6
        MOV       R1,A
        MOV       DPTR,#ZDSecMgrEntries
        MOVX      A,@DPTR
        ADD       A,R0
        MOV       R6,A
        INC       DPTR
        MOVX      A,@DPTR
        ADDC      A,R1
        MOV       DPL,R6
        MOV       DPH,A
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
//  710 
//  711         // break from loop
//  712         return ZSuccess;
        MOV       R1,#0x0
        SJMP      ??ZDSecMgrEntryNew_4
//  713       }
//  714     }
??ZDSecMgrEntryNew_3:
        INC       R2
        MOV       A,R2
        JNZ       ??ZDSecMgrEntryNew_5
        INC       R3
??ZDSecMgrEntryNew_5:
        LJMP      ??ZDSecMgrEntryNew_1 & 0xFFFF
//  715   }
//  716 
//  717   return ZNwkUnknownDevice;
??ZDSecMgrEntryNew_0:
        MOV       R1,#-0x38
??ZDSecMgrEntryNew_4:
        MOV       R7,#0x1
        LJMP      ?BANKED_LEAVE_XDATA
//  718 }
          CFI EndBlock cfiBlock11
//  719 
//  720 /******************************************************************************
//  721  * @fn          ZDSecMgrAppKeyGet
//  722  *
//  723  * @brief       get an APP key - option APP(MASTER or LINK) key
//  724  *
//  725  * @param       initNwkAddr - [in] NWK address of initiator device
//  726  * @param       initExtAddr - [in] EXT address of initiator device
//  727  * @param       partNwkAddr - [in] NWK address of partner device
//  728  * @param       partExtAddr - [in] EXT address of partner device
//  729  * @param       key         - [out] APP(MASTER or LINK) key
//  730  * @param       keyType     - [out] APP(MASTER or LINK) key type
//  731  *
//  732  * @return      ZStatus_t
//  733  */

        RSEG XDATA_I:XDATA:NOROOT(0)
//  734 uint8 ZDSecMgrAppKeyType = KEY_TYPE_APP_LINK;    // Set the default key type
ZDSecMgrAppKeyType:
        DATA8
        DS 1
        REQUIRE `?<Initializer for ZDSecMgrAppKeyType>`
        REQUIRE __INIT_XDATA_I
//  735                                                  // to KEY_TYPE_APP_LINK since
//  736                                                  // only specific requirement
//  737                                                  // right now comes from SE profile

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
//  738 ZStatus_t ZDSecMgrAppKeyGet( uint16  initNwkAddr,
ZDSecMgrAppKeyGet:
          CFI Block cfiBlock12 Using cfiCommon0
          CFI Function ZDSecMgrAppKeyGet
        CODE
//  739                              uint8*  initExtAddr,
//  740                              uint16  partNwkAddr,
//  741                              uint8*  partExtAddr,
//  742                              uint8** key,
//  743                              uint8*  keyType )
//  744 {
        FUNCALL ZDSecMgrAppKeyGet, SSP_GetTrueRand
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        REQUIRE ?V2
        REQUIRE ?V3
        REQUIRE ?V4
        REQUIRE ?V5
        MOV       A,#-0xe
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 14)
        ; Saved register size: 14
        ; Auto size: 0
        MOV       ?V2,R2
        MOV       ?V3,R3
        MOV       A,R4
        MOV       R6,A
        MOV       A,R5
        MOV       R7,A
        MOV       A,#0x12
        LCALL     ?XSTACK_DISP0_8
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       ?V0,R0
        MOV       ?V1,R1
        MOV       A,#0x14
        LCALL     ?XSTACK_DISP0_8
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       ?V4,R0
        MOV       ?V5,R1
//  745   // Intentionally unreferenced parameters
//  746   (void)initNwkAddr;
//  747   (void)initExtAddr;
//  748   (void)partNwkAddr;
//  749   (void)partExtAddr;
//  750 
//  751   //---------------------------------------------------------------------------
//  752   // note:
//  753   // should use a robust mechanism to generate keys, for example
//  754   // combine EXT addresses and call a hash function
//  755   //---------------------------------------------------------------------------
//  756   SSP_GetTrueRand( SEC_KEY_LEN, *key );
        ; Setup parameters for call to function SSP_GetTrueRand
        MOV       DPL,?V0
        MOV       DPH,?V1
        MOVX      A,@DPTR
        MOV       R2,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R3,A
        MOV       R1,#0x10
        LCALL     `??SSP_GetTrueRand::?relay`; Banked call to: SSP_GetTrueRand
//  757 
//  758   *keyType = ZDSecMgrAppKeyType;
        MOV       DPTR,#ZDSecMgrAppKeyType
        MOVX      A,@DPTR
        PUSH      A
          CFI CFA_SP SP+-1
        MOV       DPL,?V4
        MOV       DPH,?V5
        POP       A
          CFI CFA_SP SP+0
        MOVX      @DPTR,A
//  759 
//  760   return ZSuccess;
        MOV       R1,#0x0
        MOV       R7,#0x6
        LJMP      ?BANKED_LEAVE_XDATA
//  761 }
          CFI EndBlock cfiBlock12
//  762 
//  763 
//  764 
//  765 
//  766 /******************************************************************************
//  767  * @fn          ZDSecMgrAppKeyReq
//  768  *
//  769  * @brief       Process request for APP key between two devices.
//  770  *
//  771  * @param       device - [in] ZDO_RequestKeyInd_t, request info
//  772  *
//  773  * @return      none
//  774  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
//  775 void ZDSecMgrAppKeyReq( ZDO_RequestKeyInd_t* ind )
ZDSecMgrAppKeyReq:
          CFI Block cfiBlock13 Using cfiCommon0
          CFI Function ZDSecMgrAppKeyReq
        CODE
//  776 {
        FUNCALL ZDSecMgrAppKeyReq, APSME_LookupNwkAddr
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 49, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 49, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrAppKeyReq, APSME_LookupExtAddr
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 49, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 49, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrAppKeyReq, ZDSecMgrAppKeyGet
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 57, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 57, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrAppKeyReq, APSME_TransportKeyReq
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 49, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 49, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrAppKeyReq, APSME_TransportKeyReq
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 49, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 49, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrAppKeyReq, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 49, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 49, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        MOV       A,#-0xa
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 10)
        ; Saved register size: 10
        ; Auto size: 39
        MOV       A,#-0x27
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 49)
        MOV       A,R2
        MOV       R6,A
        MOV       A,R3
        MOV       R7,A
//  777   APSME_TransportKeyReq_t req;
//  778   uint8                   initExtAddr[Z_EXTADDR_LEN];
//  779   uint16                  partNwkAddr;
//  780   uint8                   key[SEC_KEY_LEN];
//  781 
//  782 
//  783   // validate initiator and partner
//  784   if ( ( APSME_LookupNwkAddr( ind->partExtAddr, &partNwkAddr ) == TRUE ) &&
//  785        ( APSME_LookupExtAddr( ind->srcAddr, initExtAddr ) == TRUE      )   )
        ; Setup parameters for call to function APSME_LookupNwkAddr
        MOV       R4,?XSP + 0
        MOV       R5,?XSP + 1
        MOV       A,R6
        ADD       A,#0x5
        MOV       R2,A
        CLR       A
        ADDC      A,R7
        MOV       R3,A
        LCALL     `??APSME_LookupNwkAddr::?relay`; Banked call to: APSME_LookupNwkAddr
        MOV       A,R1
        XRL       A,#0x1
        JZ        $+5
        LJMP      ??ZDSecMgrAppKeyReq_0 & 0xFFFF
        ; Setup parameters for call to function APSME_LookupExtAddr
        MOV       A,#0xf
        LCALL     ?XSTACK_DISP102_8
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R2,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R3,A
        LCALL     `??APSME_LookupExtAddr::?relay`; Banked call to: APSME_LookupExtAddr
        MOV       A,R1
        XRL       A,#0x1
        JZ        $+5
        LJMP      ??ZDSecMgrAppKeyReq_0 & 0xFFFF
//  786   {
//  787     // point the key to some memory
//  788     req.key = key;
        MOV       A,#0x17
        LCALL     ?XSTACK_DISP100_8
        MOV       A,#0x6
        LCALL     ?XSTACK_DISP0_8
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
//  789 
//  790     // get an APP key - option APP (MASTER or LINK) key
//  791     if ( ZDSecMgrAppKeyGet( ind->srcAddr,
//  792                             initExtAddr,
//  793                             partNwkAddr,
//  794                             ind->partExtAddr,
//  795                             &req.key,
//  796                             &req.keyType ) == ZSuccess )
        ; Setup parameters for call to function ZDSecMgrAppKeyGet
        MOV       A,#0x4
        LCALL     ?XSTACK_DISP0_8
        MOV       ?V0,DPL
        MOV       ?V1,DPH
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 51)
        MOV       A,#0x8
        LCALL     ?XSTACK_DISP0_8
        MOV       ?V0,DPL
        MOV       ?V1,DPH
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 53)
        MOV       A,R6
        ADD       A,#0x5
        MOV       ?V0,A
        CLR       A
        ADDC      A,R7
        MOV       ?V1,A
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 55)
        MOV       A,#0x6
        LCALL     ?XSTACK_DISP0_8
        LCALL     ?PUSH_XSTACK8_X_TWO
          CFI CFA_XSP16 add(XSP16, 57)
        MOV       A,#0x17
        LCALL     ?XSTACK_DISP102_8
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R2,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R3,A
        LCALL     `??ZDSecMgrAppKeyGet::?relay`; Banked call to: ZDSecMgrAppKeyGet
        MOV       A,#0x8
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 49)
        MOV       A,R1
        JZ        $+5
        LJMP      ??ZDSecMgrAppKeyReq_0 & 0xFFFF
//  797     {
//  798       // always secure
//  799       req.nwkSecure = TRUE;
        MOV       A,#0xc
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x1
        MOVX      @DPTR,A
//  800       req.apsSecure = TRUE;
        MOV       A,#0xb
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x1
        MOVX      @DPTR,A
//  801       req.tunnel    = NULL;
        MOV       A,#0xd
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
//  802 
//  803       // send key to initiator device
//  804       req.dstAddr   = ind->srcAddr;
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       A,#0x2
        LCALL     ?XSTACK_DISP0_8
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
//  805       req.extAddr   = ind->partExtAddr;
        MOV       A,R6
        ADD       A,#0x5
        MOV       R0,A
        CLR       A
        ADDC      A,R7
        MOV       R1,A
        MOV       A,#0x8
        LCALL     ?XSTACK_DISP0_8
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
//  806       req.initiator = TRUE;
        MOV       A,#0xa
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x1
        MOVX      @DPTR,A
//  807       APSME_TransportKeyReq( &req );
        ; Setup parameters for call to function APSME_TransportKeyReq
        MOV       A,#0x2
        LCALL     ?XSTACK_DISP101_8
        LCALL     `??APSME_TransportKeyReq::?relay`; Banked call to: APSME_TransportKeyReq
        MOV       A,R1
//  808 
//  809       // send key to partner device
//  810       req.dstAddr   = partNwkAddr;
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       A,#0x2
        LCALL     ?XSTACK_DISP0_8
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
//  811       req.extAddr   = initExtAddr;
        MOV       A,#0xf
        LCALL     ?XSTACK_DISP100_8
        MOV       A,#0x8
        LCALL     ?XSTACK_DISP0_8
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
//  812       req.initiator = FALSE;
        MOV       A,#0xa
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x0
        MOVX      @DPTR,A
//  813 
//  814       APSME_TransportKeyReq( &req );
        ; Setup parameters for call to function APSME_TransportKeyReq
        MOV       A,#0x2
        LCALL     ?XSTACK_DISP101_8
        LCALL     `??APSME_TransportKeyReq::?relay`; Banked call to: APSME_TransportKeyReq
        MOV       A,R1
//  815 
//  816       // clear copy of key in RAM
//  817       osal_memset( key, 0x00, SEC_KEY_LEN);
        ; Setup parameters for call to function osal_memset
        MOV       R4,#0x10
        MOV       R5,#0x0
        MOV       R1,#0x0
        MOV       A,#0x17
        LCALL     ?XSTACK_DISP101_8
        LCALL     `??osal_memset::?relay`; Banked call to: osal_memset
//  818 
//  819     }
//  820   }
//  821 }
??ZDSecMgrAppKeyReq_0:
        MOV       A,#0x27
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 10)
        MOV       R7,#0x2
        LJMP      ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock13
//  822 
//  823 /******************************************************************************
//  824  * @fn          ZDSecMgrTclkReq
//  825  *
//  826  * @brief       Process request for TCLK.
//  827  *
//  828  * @param       device - [in] ZDO_RequestKeyInd_t, request info
//  829  *
//  830  * @return      none
//  831  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
//  832 void ZDSecMgrTclkReq( ZDO_RequestKeyInd_t* ind )
ZDSecMgrTclkReq:
          CFI Block cfiBlock14 Using cfiCommon0
          CFI Function ZDSecMgrTclkReq
        CODE
//  833 {
        FUNCALL ZDSecMgrTclkReq, APSME_LookupNwkAddr
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 69, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 69, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTclkReq, APSME_LookupExtAddr
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 69, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 69, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTclkReq, APSME_SearchTCLinkKeyEntry
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 71, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 71, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTclkReq, ZDSecMgrGenerateKeyFromSeed
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 69, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 69, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTclkReq, APSME_TransportKeyReq
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 69, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 69, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTclkReq, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 69, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 69, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        MOV       A,#-0xa
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 10)
        ; Saved register size: 10
        ; Auto size: 59
        MOV       A,#-0x3b
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 69)
        MOV       A,R2
        MOV       R6,A
        MOV       A,R3
        MOV       R7,A
//  834   APSME_TransportKeyReq_t req;
//  835   uint8                   initExtAddr[Z_EXTADDR_LEN];
//  836   uint16                  partNwkAddr;
//  837   uint8                   key[SEC_KEY_LEN];
//  838   APSME_TCLKDevEntry_t    TCLKDevEntry;
//  839   uint8                   found;
//  840     
//  841   // validate initiator and partner
//  842   if ( ( ( APSME_LookupNwkAddr( ind->partExtAddr, &partNwkAddr ) == TRUE ) || ( ind->keyType != KEY_TYPE_APP_MASTER ) ) &&
//  843        (   APSME_LookupExtAddr( ind->srcAddr, initExtAddr )      == TRUE ) )
        ; Setup parameters for call to function APSME_LookupNwkAddr
        MOV       A,#0x1
        LCALL     ?XSTACK_DISP102_8
        MOV       A,R6
        ADD       A,#0x5
        MOV       R2,A
        CLR       A
        ADDC      A,R7
        MOV       R3,A
        LCALL     `??APSME_LookupNwkAddr::?relay`; Banked call to: APSME_LookupNwkAddr
        MOV       A,R1
        XRL       A,#0x1
        JZ        ??ZDSecMgrTclkReq_0
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        XRL       A,#0x2
        JNZ       $+5
        LJMP      ??ZDSecMgrTclkReq_1 & 0xFFFF
??ZDSecMgrTclkReq_0:
        ; Setup parameters for call to function APSME_LookupExtAddr
        MOV       A,#0x10
        LCALL     ?XSTACK_DISP102_8
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R2,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R3,A
        LCALL     `??APSME_LookupExtAddr::?relay`; Banked call to: APSME_LookupExtAddr
        MOV       A,R1
        XRL       A,#0x1
        JZ        $+5
        LJMP      ??ZDSecMgrTclkReq_1 & 0xFFFF
//  844   {
//  845     // point the key to some memory
//  846     req.key = key;
        MOV       A,#0x2b
        LCALL     ?XSTACK_DISP100_8
        MOV       A,#0x7
        LCALL     ?XSTACK_DISP0_8
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
//  847 
//  848     //Search for the entry
//  849     APSME_SearchTCLinkKeyEntry(initExtAddr,&found, &TCLKDevEntry);
        ; Setup parameters for call to function APSME_SearchTCLinkKeyEntry
        MOV       A,#0x18
        LCALL     ?XSTACK_DISP100_8
        MOV       ?V0,R0
        MOV       ?V1,R1
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 71)
        MOV       A,#0x2
        LCALL     ?XSTACK_DISP102_8
        MOV       A,#0x12
        LCALL     ?XSTACK_DISP101_8
        LCALL     `??APSME_SearchTCLinkKeyEntry::?relay`; Banked call to: APSME_SearchTCLinkKeyEntry
        MOV       A,#0x2
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 69)
//  850 
//  851     //If found, generate the key accordingly to the key attribute
//  852     if(found)
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOVX      A,@DPTR
        JNZ       $+5
        LJMP      ??ZDSecMgrTclkReq_1 & 0xFFFF
//  853     {
//  854       //Generate key from the seed, which would be the unique key
//  855       ZDSecMgrGenerateKeyFromSeed(TCLKDevEntry.extAddr,TCLKDevEntry.SeedShift_IcIndex,req.key);
        ; Setup parameters for call to function ZDSecMgrGenerateKeyFromSeed
        MOV       A,#0x7
        LCALL     ?XSTACK_DISP0_8
        MOVX      A,@DPTR
        MOV       R4,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R5,A
        MOV       A,#0x2a
        LCALL     ?XSTACK_DISP0_8
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       A,#0x20
        LCALL     ?XSTACK_DISP0_8
        MOV       R2,DPL
        MOV       R3,DPH
        LCALL     `??ZDSecMgrGenerateKeyFromSeed::?relay`; Banked call to: ZDSecMgrGenerateKeyFromSeed
//  856     
//  857       // always secure
//  858       req.nwkSecure = TRUE;
        MOV       A,#0xd
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x1
        MOVX      @DPTR,A
//  859       req.apsSecure = TRUE;
        MOV       A,#0xc
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x1
        MOVX      @DPTR,A
//  860       req.tunnel    = NULL;
        MOV       A,#0xe
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
//  861 
//  862       // send key to initiator device
//  863       req.dstAddr   = ind->srcAddr;
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       A,#0x3
        LCALL     ?XSTACK_DISP0_8
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
//  864       req.extAddr   = initExtAddr;
        MOV       A,#0x10
        LCALL     ?XSTACK_DISP100_8
        MOV       A,#0x9
        LCALL     ?XSTACK_DISP0_8
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
//  865       req.initiator = TRUE;
        MOV       A,#0xb
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x1
        MOVX      @DPTR,A
//  866       req.keyType   = KEY_TYPE_TC_LINK;
        MOV       A,#0x5
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x4
        MOVX      @DPTR,A
//  867         
//  868       APSME_TransportKeyReq( &req );
        ; Setup parameters for call to function APSME_TransportKeyReq
        MOV       A,#0x3
        LCALL     ?XSTACK_DISP101_8
        LCALL     `??APSME_TransportKeyReq::?relay`; Banked call to: APSME_TransportKeyReq
        MOV       A,R1
//  869         
//  870       // clear copy of key in RAM
//  871       osal_memset( key, 0x00, SEC_KEY_LEN);
        ; Setup parameters for call to function osal_memset
        MOV       R4,#0x10
        MOV       R5,#0x0
        MOV       R1,#0x0
        MOV       A,#0x2b
        LCALL     ?XSTACK_DISP101_8
        LCALL     `??osal_memset::?relay`; Banked call to: osal_memset
//  872     
//  873     }
//  874   }
//  875 }
??ZDSecMgrTclkReq_1:
        MOV       A,#0x3b
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 10)
        MOV       R7,#0x2
        LJMP      ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock14
//  876 
//  877 /******************************************************************************
//  878  * @fn          ZDSecMgrAppConfKeyReq
//  879  *
//  880  * @brief       Process request for APP key between two devices.
//  881  *
//  882  * @param       device - [in] ZDO_VerifyKeyInd_t, request info
//  883  *
//  884  * @return      none
//  885  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
//  886 void ZDSecMgrAppConfKeyReq( ZDO_VerifyKeyInd_t* ind )
ZDSecMgrAppConfKeyReq:
          CFI Block cfiBlock15 Using cfiCommon0
          CFI Function ZDSecMgrAppConfKeyReq
        CODE
//  887 {
        PUSH      DPL
          CFI DPL0 Frame(CFA_SP, 4)
          CFI CFA_SP SP+-4
        PUSH      DPH
          CFI DPH0 Frame(CFA_SP, 5)
          CFI CFA_SP SP+-5
        ; Saved register size: 2
        ; Auto size: 6
        MOV       A,#-0x6
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 6)
//  888   APSME_ConfirmKeyReq_t   req;
//  889 
//  890   // send key to initiator device
//  891   req.dstAddr      = ind->srcAddr;
        MOV       DPL,R2
        MOV       DPH,R3
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
//  892   req.status       = ind->verifyKeyStatus;
        MOV       A,R2
        ADD       A,#0x1d
        MOV       DPL,A
        CLR       A
        ADDC      A,R3
        MOV       DPH,A
        MOVX      A,@DPTR
        PUSH      A
          CFI CFA_SP SP+-6
        MOV       A,#0x2
        LCALL     ?XSTACK_DISP0_8
        POP       A
          CFI CFA_SP SP+-5
        MOVX      @DPTR,A
//  893   req.dstExtAddr   = ind->extAddr;
        MOV       A,R2
        ADD       A,#0x5
        MOV       R0,A
        CLR       A
        ADDC      A,R3
        MOV       R1,A
        MOV       A,#0x3
        LCALL     ?XSTACK_DISP0_8
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
//  894   req.keyType      = ind->keyType;
        MOV       DPL,R2
        MOV       DPH,R3
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        PUSH      A
          CFI CFA_SP SP+-6
        MOV       A,#0x5
        LCALL     ?XSTACK_DISP0_8
        POP       A
          CFI CFA_SP SP+-5
        MOVX      @DPTR,A
//  895 
//  896   if ( ( ZSTACK_DEVICE_BUILD & DEVICE_BUILD_COORDINATOR ) != 0 )
//  897   {
//  898     APSME_ConfirmKeyReq( &req );
//  899   }
//  900   
//  901 }
        MOV       A,#0x6
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 XSP16+0
        POP       DPH
          CFI DPH0 SameValue
          CFI CFA_SP SP+-4
        POP       DPL
          CFI DPL0 SameValue
          CFI CFA_SP SP+-3
        LJMP      ?BRET
          CFI EndBlock cfiBlock15
//  902 
//  903 
//  904 /******************************************************************************
//  905  * @fn          ZDSecMgrSendNwkKey
//  906  *
//  907  * @brief       Send NWK key to device joining network.
//  908  *
//  909  * @param       device - [in] ZDSecMgrDevice_t, device info
//  910  *
//  911  * @return      ZStatus_t
//  912  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
//  913 ZStatus_t ZDSecMgrSendNwkKey( ZDSecMgrDevice_t* device )
ZDSecMgrSendNwkKey:
          CFI Block cfiBlock16 Using cfiCommon0
          CFI Function ZDSecMgrSendNwkKey
        CODE
//  914 {
        FUNCALL ZDSecMgrSendNwkKey, NLME_ReadNwkKeyInfo
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 50, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 50, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSendNwkKey, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 46, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 46, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSendNwkKey, NLME_GetShortAddr
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 46, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 46, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSendNwkKey, APSME_TransportKeyReq
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 46, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 46, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSendNwkKey, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 46, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 46, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V2
        REQUIRE ?V3
        MOV       A,#-0xc
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 12)
        ; Saved register size: 12
        ; Auto size: 34
        MOV       A,#-0x22
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 46)
        MOV       A,R2
        MOV       R6,A
        MOV       A,R3
        MOV       R7,A
//  915   ZStatus_t status;
//  916   APSME_TransportKeyReq_t req;
//  917   APSDE_FrameTunnel_t tunnel;
//  918   nwkKeyDesc tmpKey;
//  919 
//  920   req.dstAddr   = device->nwkAddr;
        MOV       DPL,R6
        MOV       DPH,R7
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
//  921   req.extAddr   = device->extAddr;
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       A,#0x6
        LCALL     ?XSTACK_DISP0_8
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
//  922 
//  923   req.keyType   = KEY_TYPE_NWK;
        MOV       A,#0x2
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x1
        MOVX      @DPTR,A
//  924 
//  925   // get the Active Key into a local variable
//  926   if ( NLME_ReadNwkKeyInfo( 0, sizeof(tmpKey), &tmpKey,
//  927                            ZCD_NV_NWK_ACTIVE_KEY_INFO ) != SUCCESS )
        ; Setup parameters for call to function NLME_ReadNwkKeyInfo
        MOV       ?V2,#0x3a
        MOV       ?V3,#0x0
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 48)
        MOV       A,#0x13
        LCALL     ?XSTACK_DISP100_8
        MOV       ?V2,R0
        MOV       ?V3,R1
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 50)
        MOV       R4,#0x11
        MOV       R5,#0x0
        MOV       R2,#0x0
        MOV       R3,#0x0
        LCALL     `??NLME_ReadNwkKeyInfo::?relay`; Banked call to: NLME_ReadNwkKeyInfo
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 46)
        MOV       A,R1
        JZ        ??ZDSecMgrSendNwkKey_0
//  928   {
//  929     // set key data to all 0s if NV read fails
//  930     osal_memset(&tmpKey, 0x00, sizeof(tmpKey));
        ; Setup parameters for call to function osal_memset
        MOV       R4,#0x11
        MOV       R5,#0x0
        MOV       R1,#0x0
        MOV       A,#0x11
        LCALL     ?XSTACK_DISP101_8
        LCALL     `??osal_memset::?relay`; Banked call to: osal_memset
//  931   }
//  932 
//  933   if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_SE_STANDARD )
//  934   {
//  935     // set values
//  936     req.keySeqNum = tmpKey.keySeqNum;
??ZDSecMgrSendNwkKey_0:
        MOV       A,#0x11
        LCALL     ?XSTACK_DISP0_8
        MOVX      A,@DPTR
        PUSH      A
          CFI CFA_SP SP+-1
        MOV       A,#0x3
        LCALL     ?XSTACK_DISP0_8
        POP       A
          CFI CFA_SP SP+0
        MOVX      @DPTR,A
//  937     req.key       = tmpKey.key;
        MOV       A,#0x12
        LCALL     ?XSTACK_DISP0_8
        MOV       R0,DPL
        MOV       R1,DPH
        MOV       A,#0x4
        LCALL     ?XSTACK_DISP0_8
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
//  938 
//  939     //devtag.pro.security.todo - make sure that if there is no link key the NWK
//  940     //key isn't used to secure the frame at the APS layer -- since the receiving
//  941     //device may not have a NWK key yet
//  942     req.apsSecure = TRUE;
        MOV       A,#0x9
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x1
        MOVX      @DPTR,A
//  943 
//  944     // check if using secure hop to parent
//  945     if ( device->parentAddr == NLME_GetShortAddr() )
        ; Setup parameters for call to function NLME_GetShortAddr
        LCALL     `??NLME_GetShortAddr::?relay`; Banked call to: NLME_GetShortAddr
        MOV       ?V2,R2
        MOV       ?V3,R3
        MOV       R0,?V2
        MOV       R1,?V3
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        XRL       A,R0
        JNZ       ??ZDSecMgrSendNwkKey_1
        INC       DPTR
        MOVX      A,@DPTR
        XRL       A,R1
??ZDSecMgrSendNwkKey_1:
        JNZ       ??ZDSecMgrSendNwkKey_2
//  946     {
//  947       req.nwkSecure = FALSE;
        MOV       A,#0xa
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x0
        MOVX      @DPTR,A
//  948       req.tunnel    = NULL;
        MOV       A,#0xb
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
        SJMP      ??ZDSecMgrSendNwkKey_3
//  949     }
//  950     else
//  951     {
//  952       req.nwkSecure   = TRUE;
??ZDSecMgrSendNwkKey_2:
        MOV       A,#0xa
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x1
        MOVX      @DPTR,A
//  953       req.tunnel      = &tunnel;
        MOV       A,#0xd
        LCALL     ?XSTACK_DISP100_8
        MOV       A,#0xb
        LCALL     ?XSTACK_DISP0_8
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
//  954       req.tunnel->tna = device->parentAddr;
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       A,#0xb
        LCALL     ?XSTACK_DISP0_8
        MOVX      A,@DPTR
        MOV       R2,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       DPH,A
        MOV       DPL,R2
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
//  955       req.tunnel->dea = device->extAddr;
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       A,#0xb
        LCALL     ?XSTACK_DISP0_8
        MOVX      A,@DPTR
        MOV       R2,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       DPH,A
        MOV       DPL,R2
        INC       DPTR
        INC       DPTR
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
//  956     }
//  957   }
//  958   else
//  959   {
//  960     // default values
//  961     //devtag.0604.verify
//  962     req.nwkSecure = TRUE;
//  963     req.apsSecure = FALSE;
//  964     req.tunnel    = NULL;
//  965 
//  966     if ( device->parentAddr != NLME_GetShortAddr() )
//  967     {
//  968       req.dstAddr = device->parentAddr;
//  969     }
//  970 
//  971     // send the real key
//  972     if ( zgPreConfigKeys == FALSE )
//  973     {
//  974       req.keySeqNum = tmpKey.keySeqNum;
//  975       req.key       = tmpKey.key;
//  976 
//  977       // check if using secure hop to to parent
//  978       if ( device->parentAddr == NLME_GetShortAddr() )
//  979       {
//  980         req.nwkSecure = FALSE;
//  981       }
//  982     }
//  983     else
//  984     {
//  985       // this is to send the all zero key when the NWK key has been preconfigured
//  986       req.key       = NULL;
//  987       req.keySeqNum = 0;
//  988     }
//  989   }
//  990 
//  991   status = APSME_TransportKeyReq( &req );
??ZDSecMgrSendNwkKey_3:
        ; Setup parameters for call to function APSME_TransportKeyReq
        MOV       R2,?XSP + 0
        MOV       R3,?XSP + 1
        LCALL     `??APSME_TransportKeyReq::?relay`; Banked call to: APSME_TransportKeyReq
        MOV       A,R1
        MOV       ?V0,A
//  992 
//  993   // clear copy of key in RAM before return
//  994   osal_memset( &tmpKey, 0x00, sizeof(nwkKeyDesc) );
        ; Setup parameters for call to function osal_memset
        MOV       R4,#0x11
        MOV       R5,#0x0
        MOV       R1,#0x0
        MOV       A,#0x11
        LCALL     ?XSTACK_DISP101_8
        LCALL     `??osal_memset::?relay`; Banked call to: osal_memset
//  995 
//  996   return status;
        MOV       R1,?V0
        MOV       A,#0x22
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 12)
        MOV       R7,#0x4
        LJMP      ?BANKED_LEAVE_XDATA
//  997 }
          CFI EndBlock cfiBlock16
//  998 
//  999 /******************************************************************************
// 1000  * @fn          ZDSecMgrDeviceRemoveByExtAddr
// 1001  *
// 1002  * @brief       Remove device entry by its ext address.
// 1003  *
// 1004  * @param       pAddr - pointer to the extended address
// 1005  *
// 1006  * @return      ZStatus_t
// 1007  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 1008 ZStatus_t ZDSecMgrDeviceRemoveByExtAddr( uint8 *pAddr )
ZDSecMgrDeviceRemoveByExtAddr:
          CFI Block cfiBlock17 Using cfiCommon0
          CFI Function ZDSecMgrDeviceRemoveByExtAddr
        CODE
// 1009 {
        FUNCALL ZDSecMgrDeviceRemoveByExtAddr, ZDSecMgrEntryLookupExt
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 11, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 11, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceRemoveByExtAddr, ZDSecMgrEntryFree
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 11, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 11, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        MOV       A,#-0x9
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 2
        MOV       A,#-0x2
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 11)
        MOV       A,R2
        MOV       R6,A
        MOV       A,R3
        MOV       R7,A
// 1010   ZDSecMgrEntry_t *pEntry;
// 1011   uint8           retValue;
// 1012 
// 1013   retValue = (uint8)ZDSecMgrEntryLookupExt( pAddr, &pEntry );
        ; Setup parameters for call to function ZDSecMgrEntryLookupExt
        MOV       R4,?XSP + 0
        MOV       R5,?XSP + 1
        MOV       A,R6
        MOV       R2,A
        MOV       A,R7
        MOV       R3,A
        LCALL     `??ZDSecMgrEntryLookupExt::?relay`; Banked call to: ZDSecMgrEntryLookupExt
        MOV       A,R1
        MOV       ?V0,A
// 1014 
// 1015   if( retValue == ZSuccess )
        MOV       A,?V0
        JNZ       ??ZDSecMgrDeviceRemoveByExtAddr_0
// 1016   {
// 1017     // remove device from entry data
// 1018     ZDSecMgrEntryFree( pEntry );
        ; Setup parameters for call to function ZDSecMgrEntryFree
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOVX      A,@DPTR
        MOV       R2,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R3,A
        LCALL     `??ZDSecMgrEntryFree::?relay`; Banked call to: ZDSecMgrEntryFree
// 1019   }
// 1020 
// 1021   return retValue;
??ZDSecMgrDeviceRemoveByExtAddr_0:
        MOV       R1,?V0
        MOV       A,#0x2
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 9)
        MOV       R7,#0x1
        LJMP      ?BANKED_LEAVE_XDATA
// 1022 }
          CFI EndBlock cfiBlock17
// 1023 
// 1024 /******************************************************************************
// 1025  * @fn          ZDSecMgrDeviceRemove
// 1026  *
// 1027  * @brief       Remove device from network.
// 1028  *
// 1029  * @param       device - [in] ZDSecMgrDevice_t, device info
// 1030  *
// 1031  * @return      none
// 1032  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 1033 void ZDSecMgrDeviceRemove( ZDSecMgrDevice_t* device )
ZDSecMgrDeviceRemove:
          CFI Block cfiBlock18 Using cfiCommon0
          CFI Function ZDSecMgrDeviceRemove
        CODE
// 1034 {
        FUNCALL ZDSecMgrDeviceRemove, NLME_GetShortAddr
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 31, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 31, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceRemove, AssocGetWithExt
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 31, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 31, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceRemove, NLME_LeaveReq
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 31, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 31, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceRemove, NLME_GetShortAddr
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 31, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 31, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceRemove, NLME_LeaveReq
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 31, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 31, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceRemove, APSME_GetRequest
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 31, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 31, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceRemove, APSME_SearchTCLinkKeyEntry
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 33, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 33, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceRemove, APSME_RemoveDeviceReq
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 31, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 31, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceRemove, APSME_RemoveDeviceReq
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 31, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 31, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        REQUIRE ?V2
        REQUIRE ?V3
        MOV       A,#-0xc
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 12)
        ; Saved register size: 12
        ; Auto size: 19
        MOV       A,#-0x13
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 31)
        MOV       A,R2
        MOV       R6,A
        MOV       A,R3
        MOV       R7,A
// 1035   APSME_RemoveDeviceReq_t remDevReq;
// 1036   NLME_LeaveReq_t         leaveReq;
// 1037   associated_devices_t*   assoc;
// 1038   uint8 TC_ExtAddr[Z_EXTADDR_LEN];
// 1039 
// 1040   // check if parent, remove the device
// 1041   if ( device->parentAddr == NLME_GetShortAddr() )
        ; Setup parameters for call to function NLME_GetShortAddr
        LCALL     `??NLME_GetShortAddr::?relay`; Banked call to: NLME_GetShortAddr
        MOV       ?V2,R2
        MOV       ?V3,R3
        MOV       R0,?V2
        MOV       R1,?V3
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        XRL       A,R0
        JNZ       ??ZDSecMgrDeviceRemove_0
        INC       DPTR
        MOVX      A,@DPTR
        XRL       A,R1
??ZDSecMgrDeviceRemove_0:
        JZ        $+5
        LJMP      ??ZDSecMgrDeviceRemove_1 & 0xFFFF
// 1042   {
// 1043     // this is the parent of the device
// 1044     leaveReq.extAddr        = device->extAddr;
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       A,#0x1
        LCALL     ?XSTACK_DISP0_8
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
// 1045     leaveReq.removeChildren = FALSE;
        MOV       A,#0x3
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x0
        MOVX      @DPTR,A
// 1046     leaveReq.rejoin         = FALSE;
        MOV       A,#0x4
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x0
        MOVX      @DPTR,A
// 1047 
// 1048     // find child association
// 1049     assoc = AssocGetWithExt( device->extAddr );
        ; Setup parameters for call to function AssocGetWithExt
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R2,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R3,A
        LCALL     `??AssocGetWithExt::?relay`; Banked call to: AssocGetWithExt
        MOV       ?V2,R2
        MOV       ?V3,R3
        MOV       ?V0,?V2
        MOV       ?V1,?V3
// 1050 
// 1051     if ( ( assoc != NULL                            ) &&
// 1052          ( assoc->nodeRelation >= CHILD_RFD         ) &&
// 1053          ( assoc->nodeRelation <= CHILD_FFD_RX_IDLE )    )
        MOV       A,?V0
        ORL       A,?V1
        JZ        ??ZDSecMgrDeviceRemove_2
        MOV       DPL,?V0
        MOV       DPH,?V1
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        JZ        ??ZDSecMgrDeviceRemove_2
        MOV       DPL,?V0
        MOV       DPH,?V1
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        CLR       C
        SUBB      A,#0x5
        JNC       ??ZDSecMgrDeviceRemove_2
// 1054     {
// 1055       // check if associated device is authenticated
// 1056       if ( assoc->devStatus & DEV_SEC_AUTH_STATUS )
        MOV       DPL,?V0
        MOV       DPH,?V1
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       C,0xE0 /* A   */.3
        JNC       ??ZDSecMgrDeviceRemove_3
// 1057       {
// 1058         leaveReq.silent = FALSE;
        MOV       A,#0x5
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x0
        MOVX      @DPTR,A
        SJMP      ??ZDSecMgrDeviceRemove_4
// 1059       }
// 1060       else
// 1061       {
// 1062         leaveReq.silent = TRUE;
??ZDSecMgrDeviceRemove_3:
        MOV       A,#0x5
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x1
        MOVX      @DPTR,A
// 1063       }
// 1064 
// 1065       NLME_LeaveReq( &leaveReq );
??ZDSecMgrDeviceRemove_4:
        ; Setup parameters for call to function NLME_LeaveReq
        MOV       A,#0x1
        LCALL     ?XSTACK_DISP101_8
        LCALL     `??NLME_LeaveReq::?relay`; Banked call to: NLME_LeaveReq
        MOV       A,R1
        LJMP      ??ZDSecMgrDeviceRemove_5 & 0xFFFF
// 1066     }
// 1067     else if ( device->nwkAddr == NLME_GetShortAddr() )
??ZDSecMgrDeviceRemove_2:
        ; Setup parameters for call to function NLME_GetShortAddr
        LCALL     `??NLME_GetShortAddr::?relay`; Banked call to: NLME_GetShortAddr
        MOV       ?V2,R2
        MOV       ?V3,R3
        MOV       R0,?V2
        MOV       R1,?V3
        MOV       DPL,R6
        MOV       DPH,R7
        MOVX      A,@DPTR
        XRL       A,R0
        JNZ       ??ZDSecMgrDeviceRemove_6
        INC       DPTR
        MOVX      A,@DPTR
        XRL       A,R1
??ZDSecMgrDeviceRemove_6:
        JZ        $+5
        LJMP      ??ZDSecMgrDeviceRemove_5 & 0xFFFF
// 1068     {
// 1069       // this is when ZC wants that ZR removes itself from the network
// 1070       leaveReq.extAddr = NULL;
        MOV       A,#0x1
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
// 1071       leaveReq.silent = FALSE;
        MOV       A,#0x5
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x0
        MOVX      @DPTR,A
// 1072 
// 1073       NLME_LeaveReq( &leaveReq );
        ; Setup parameters for call to function NLME_LeaveReq
        MOV       A,#0x1
        LCALL     ?XSTACK_DISP101_8
        LCALL     `??NLME_LeaveReq::?relay`; Banked call to: NLME_LeaveReq
        MOV       A,R1
        LJMP      ??ZDSecMgrDeviceRemove_5 & 0xFFFF
// 1074     }
// 1075   }
// 1076   else
// 1077   {
// 1078     // this is not the parent of the device
// 1079     remDevReq.parentAddr   = device->parentAddr;
??ZDSecMgrDeviceRemove_1:
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       A,#0x6
        LCALL     ?XSTACK_DISP0_8
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
// 1080     remDevReq.childExtAddr = device->extAddr;
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       A,#0x8
        LCALL     ?XSTACK_DISP0_8
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
// 1081 
// 1082     if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_SE_STANDARD )
// 1083     {
// 1084       uint8 found;
// 1085       APSME_GetRequest( apsTrustCenterAddress,0, TC_ExtAddr );
        ; Setup parameters for call to function APSME_GetRequest
        MOV       A,#0xb
        LCALL     ?XSTACK_DISP102_8
        MOV       R2,#0x0
        MOV       R3,#0x0
        MOV       R1,#-0x55
        LCALL     `??APSME_GetRequest::?relay`; Banked call to: APSME_GetRequest
        MOV       A,R1
// 1086       
// 1087       APSME_SearchTCLinkKeyEntry(TC_ExtAddr,&found,NULL);
        ; Setup parameters for call to function APSME_SearchTCLinkKeyEntry
        CLR       A
        MOV       ?V2,A
        MOV       ?V3,A
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 33)
        MOV       A,#0x2
        LCALL     ?XSTACK_DISP102_8
        MOV       A,#0xd
        LCALL     ?XSTACK_DISP101_8
        LCALL     `??APSME_SearchTCLinkKeyEntry::?relay`; Banked call to: APSME_SearchTCLinkKeyEntry
        MOV       A,#0x2
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 31)
// 1088       
// 1089       // For ZG_GLOBAL_LINK_KEY the message has to be sent twice, one
// 1090       // APS un-encrypted and one APS encrypted, to make sure that it can interoperate
// 1091       // with legacy Coordinator devices which can only handle one or the other.
// 1092 #if defined ( APP_TP2_TEST_MODE )
// 1093       if ( ( zgApsLinkKeyType == ZG_GLOBAL_LINK_KEY ) && ( guTxApsSecON != TRUE ) )
// 1094 #else
// 1095       if ( ( zgApsLinkKeyType == ZG_GLOBAL_LINK_KEY ) && ( found == FALSE ) )
        MOV       DPTR,#zgApsLinkKeyType
        MOVX      A,@DPTR
        XRL       A,#0x1
        JNZ       ??ZDSecMgrDeviceRemove_7
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOVX      A,@DPTR
        JNZ       ??ZDSecMgrDeviceRemove_7
// 1096 #endif
// 1097       {
// 1098         remDevReq.apsSecure = FALSE;
        MOV       A,#0xa
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x0
        MOVX      @DPTR,A
// 1099 
// 1100         APSME_RemoveDeviceReq( &remDevReq );
        ; Setup parameters for call to function APSME_RemoveDeviceReq
        MOV       A,#0x6
        LCALL     ?XSTACK_DISP101_8
        LCALL     `??APSME_RemoveDeviceReq::?relay`; Banked call to: APSME_RemoveDeviceReq
        MOV       A,R1
// 1101       }
// 1102 
// 1103 #if defined ( APP_TP2_TEST_MODE )
// 1104       if ( guTxApsSecON != FALSE )
// 1105       {
// 1106         remDevReq.apsSecure = TRUE;
// 1107 
// 1108         APSME_RemoveDeviceReq( &remDevReq );
// 1109       }
// 1110 #else
// 1111       remDevReq.apsSecure = TRUE;
??ZDSecMgrDeviceRemove_7:
        MOV       A,#0xa
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x1
        MOVX      @DPTR,A
// 1112 
// 1113       APSME_RemoveDeviceReq( &remDevReq );
        ; Setup parameters for call to function APSME_RemoveDeviceReq
        MOV       A,#0x6
        LCALL     ?XSTACK_DISP101_8
        LCALL     `??APSME_RemoveDeviceReq::?relay`; Banked call to: APSME_RemoveDeviceReq
        MOV       A,R1
// 1114 #endif
// 1115     }
// 1116     else
// 1117     {
// 1118       remDevReq.apsSecure = FALSE;
// 1119 
// 1120       APSME_RemoveDeviceReq( &remDevReq );
// 1121     }
// 1122   }
// 1123 }
??ZDSecMgrDeviceRemove_5:
        MOV       A,#0x13
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 12)
        MOV       R7,#0x4
        LJMP      ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock18
// 1124 
// 1125 /******************************************************************************
// 1126  * @fn          ZDSecMgrDeviceValidateRM (RESIDENTIAL MODE)
// 1127  *
// 1128  * @brief       Decide whether device is allowed.
// 1129  *
// 1130  * @param       device - [in] ZDSecMgrDevice_t, device info
// 1131  *
// 1132  * @return      ZStatus_t
// 1133  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 1134 ZStatus_t ZDSecMgrDeviceValidateRM( ZDSecMgrDevice_t* device )
ZDSecMgrDeviceValidateRM:
          CFI Block cfiBlock19 Using cfiCommon0
          CFI Function ZDSecMgrDeviceValidateRM
        CODE
// 1135 {
        PUSH      DPL
          CFI DPL0 Frame(CFA_SP, 4)
          CFI CFA_SP SP+-4
        PUSH      DPH
          CFI DPH0 Frame(CFA_SP, 5)
          CFI CFA_SP SP+-5
        ; Saved register size: 2
        ; Auto size: 0
// 1136   ZStatus_t status;
// 1137 
// 1138   status = ZSuccess;
        MOV       R1,#0x0
// 1139 
// 1140   (void)device;  // Intentionally unreferenced parameter
// 1141 
// 1142   // For test purpose, turning off the zgSecurePermitJoin flag will force
// 1143   // the trust center to reject any newly joining devices by sending
// 1144   // Remove-device to the parents.
// 1145   if ( zgSecurePermitJoin == FALSE )
        MOV       DPTR,#zgSecurePermitJoin
        MOVX      A,@DPTR
        JNZ       ??ZDSecMgrDeviceValidateRM_0
// 1146   {
// 1147     status = ZNwkUnknownDevice;
        MOV       R1,#-0x38
// 1148   }
// 1149 
// 1150 
// 1151 
// 1152 #if 0  // Taken out because the following functionality is only used for test
// 1153        // purpose. A more efficient (above) way is used. It can be put
// 1154        // back in if customers request for a white/black list feature.
// 1155        // ZDSecMgrStoredDeviceList[] is defined in ZDSecMgr.c
// 1156 
// 1157   // The following code processes the device black list (stored device list)
// 1158   // If the joining device is not part of the forbidden device list
// 1159   // Return ZSuccess. Otherwise, return ZNwkUnknownDevice. The trust center
// 1160   // will send Remove-device and ban the device from joining.
// 1161 
// 1162   uint8     index;
// 1163   uint8*    restricted;
// 1164 
// 1165   // Look through the stored device list - used for restricted devices
// 1166   for ( index = 0; index < ZDSECMGR_STORED_DEVICES; index++ )
// 1167   {
// 1168     restricted = ZDSecMgrStoredDeviceList[index];
// 1169 
// 1170     if ( AddrMgrExtAddrEqual( restricted, device->extAddr )  == TRUE )
// 1171     {
// 1172       // return as unknown device in regards to validation
// 1173       status = ZNwkUnknownDevice;
// 1174 
// 1175       // break from loop
// 1176       index = ZDSECMGR_STORED_DEVICES;
// 1177     }
// 1178   }
// 1179 
// 1180 #endif
// 1181 
// 1182   return status;
??ZDSecMgrDeviceValidateRM_0:
        POP       DPH
          CFI DPH0 SameValue
          CFI CFA_SP SP+-4
        POP       DPL
          CFI DPL0 SameValue
          CFI CFA_SP SP+-3
        LJMP      ?BRET
// 1183 }
          CFI EndBlock cfiBlock19
// 1184 
// 1185 /******************************************************************************
// 1186  * @fn          ZDSecMgrDeviceValidate
// 1187  *
// 1188  * @brief       Decide whether device is allowed.
// 1189  *
// 1190  * @param       device - [in] ZDSecMgrDevice_t, device info
// 1191  *
// 1192  * @return      ZStatus_t
// 1193  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 1194 ZStatus_t ZDSecMgrDeviceValidate( ZDSecMgrDevice_t* device )
ZDSecMgrDeviceValidate:
          CFI Block cfiBlock20 Using cfiCommon0
          CFI Function ZDSecMgrDeviceValidate
        CODE
// 1195 {
        FUNCALL ZDSecMgrDeviceValidate, ZDSecMgrDeviceValidateRM
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        MOV       A,#-0x9
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
        MOV       A,R2
        MOV       R6,A
        MOV       A,R3
        MOV       R7,A
// 1196   ZStatus_t status;
// 1197 
// 1198   if ( ZDSecMgrPermitJoiningEnabled == TRUE )
        MOV       DPTR,#ZDSecMgrPermitJoiningEnabled
        MOVX      A,@DPTR
        XRL       A,#0x1
        JNZ       ??ZDSecMgrDeviceValidate_0
// 1199   {
// 1200     status = ZDSecMgrDeviceValidateRM( device );
        ; Setup parameters for call to function ZDSecMgrDeviceValidateRM
        MOV       A,R6
        MOV       R2,A
        MOV       A,R7
        MOV       R3,A
        LCALL     `??ZDSecMgrDeviceValidateRM::?relay`; Banked call to: ZDSecMgrDeviceValidateRM
        MOV       A,R1
        MOV       ?V0,A
        SJMP      ??ZDSecMgrDeviceValidate_1
// 1201   }
// 1202   else
// 1203   {
// 1204     status = ZNwkUnknownDevice;
??ZDSecMgrDeviceValidate_0:
        MOV       ?V0,#-0x38
// 1205   }
// 1206 
// 1207   return status;
??ZDSecMgrDeviceValidate_1:
        MOV       R1,?V0
        MOV       R7,#0x1
        LJMP      ?BANKED_LEAVE_XDATA
// 1208 }
          CFI EndBlock cfiBlock20
// 1209 
// 1210 /******************************************************************************
// 1211  * @fn          ZDSecMgrDeviceJoin
// 1212  *
// 1213  * @brief       Try to join this device.
// 1214  *
// 1215  * @param       device - [in] ZDSecMgrDevice_t, device info
// 1216  *
// 1217  * @return      ZStatus_t
// 1218  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 1219 ZStatus_t ZDSecMgrDeviceJoin( ZDSecMgrDevice_t* device )
ZDSecMgrDeviceJoin:
          CFI Block cfiBlock21 Using cfiCommon0
          CFI Function ZDSecMgrDeviceJoin
        CODE
// 1220 {
        FUNCALL ZDSecMgrDeviceJoin, ZDSecMgrDeviceValidate
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 29, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 29, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceJoin, ZDSecMgrAddrStore
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 31, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 31, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceJoin, ZDSecMgrSendNwkKey
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 29, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 29, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceJoin, ZDSecMgrAddrClear
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 29, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 29, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceJoin, ZDSecMgrDeviceRemove
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 29, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 29, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceJoin, osal_memcpy
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 32, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 32, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V2
        REQUIRE ?V3
        REQUIRE ?V4
        REQUIRE ?V5
        REQUIRE ?V6
        MOV       A,#-0xf
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 15)
        ; Saved register size: 15
        ; Auto size: 14
        MOV       A,#-0xe
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 29)
        MOV       A,R2
        MOV       R6,A
        MOV       A,R3
        MOV       R7,A
// 1221   ZStatus_t status = ZSuccess;
        MOV       ?V0,#0x0
// 1222   uint16    ami;
// 1223 
// 1224   // attempt to validate device that joined/rejoined without security
// 1225   if ( device->secure == FALSE )
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        JNZ       ??ZDSecMgrDeviceJoin_0
// 1226   {
// 1227     status = ZDSecMgrDeviceValidate( device );
        ; Setup parameters for call to function ZDSecMgrDeviceValidate
        MOV       A,R6
        MOV       R2,A
        MOV       A,R7
        MOV       R3,A
        LCALL     `??ZDSecMgrDeviceValidate::?relay`; Banked call to: ZDSecMgrDeviceValidate
        MOV       A,R1
        MOV       ?V0,A
// 1228   }
// 1229 
// 1230   if ( status == ZSuccess )
??ZDSecMgrDeviceJoin_0:
        MOV       A,?V0
        JNZ       ??ZDSecMgrDeviceJoin_1
// 1231   {
// 1232     // Add the device to the address manager
// 1233     ZDSecMgrAddrStore( device->nwkAddr, device->extAddr, &ami );
        ; Setup parameters for call to function ZDSecMgrAddrStore
        MOV       R0,?XSP + 0
        MOV       R1,?XSP + 1
        MOV       ?V2,R0
        MOV       ?V3,R1
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 31)
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R4,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R5,A
        MOV       DPL,R6
        MOV       DPH,R7
        MOVX      A,@DPTR
        MOV       R2,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R3,A
        LCALL     `??ZDSecMgrAddrStore::?relay`; Banked call to: ZDSecMgrAddrStore
        MOV       A,#0x2
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 29)
        MOV       A,R1
// 1234 
// 1235     // Only send the key to devices that have not been authenticated
// 1236     if ( ( device->devStatus & DEV_SEC_INIT_STATUS ) &&
// 1237          ( device->secure == FALSE ) )
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       C,0xE0 /* A   */.2
        JNC       ??ZDSecMgrDeviceJoin_2
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        JNZ       ??ZDSecMgrDeviceJoin_2
// 1238     {
// 1239       //send the nwk key data to the joining device
// 1240       status = ZDSecMgrSendNwkKey( device );
        ; Setup parameters for call to function ZDSecMgrSendNwkKey
        MOV       A,R6
        MOV       R2,A
        MOV       A,R7
        MOV       R3,A
        LCALL     `??ZDSecMgrSendNwkKey::?relay`; Banked call to: ZDSecMgrSendNwkKey
        MOV       A,R1
        MOV       ?V0,A
// 1241     }
// 1242 
// 1243     if ( status != ZSuccess )
??ZDSecMgrDeviceJoin_2:
        MOV       A,?V0
        JZ        ??ZDSecMgrDeviceJoin_1
// 1244     {
// 1245       ZDSecMgrAddrClear( device->extAddr );
        ; Setup parameters for call to function ZDSecMgrAddrClear
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R2,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R3,A
        LCALL     `??ZDSecMgrAddrClear::?relay`; Banked call to: ZDSecMgrAddrClear
        MOV       A,R1
// 1246     }
// 1247   }
// 1248 
// 1249   if ( status != ZSuccess )
??ZDSecMgrDeviceJoin_1:
        MOV       A,?V0
        JZ        ??ZDSecMgrDeviceJoin_3
// 1250   {
// 1251     // not allowed or transport key failed, remove the device
// 1252     ZDSecMgrDeviceRemove( device );
        ; Setup parameters for call to function ZDSecMgrDeviceRemove
        MOV       A,R6
        MOV       R2,A
        MOV       A,R7
        MOV       R3,A
        LCALL     `??ZDSecMgrDeviceRemove::?relay`; Banked call to: ZDSecMgrDeviceRemove
        SJMP      ??ZDSecMgrDeviceJoin_4
// 1253   }
// 1254   else
// 1255   {
// 1256     // Pass the Trust Center Device Indication to higher layer if callback registered
// 1257     if (zdoCBFunc[ZDO_TC_DEVICE_CBID] != NULL )
??ZDSecMgrDeviceJoin_3:
        MOV       DPTR,#zdoCBFunc + 16
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       A,R0
        ORL       A,R1
        JZ        ??ZDSecMgrDeviceJoin_4
// 1258     {
// 1259       ZDO_TC_Device_t dev;
// 1260 
// 1261       dev.nwkAddr = device->nwkAddr;
        MOV       DPL,R6
        MOV       DPH,R7
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       A,#0x2
        LCALL     ?XSTACK_DISP0_8
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
// 1262       osal_memcpy( dev.extAddr, device->extAddr, Z_EXTADDR_LEN );
        ; Setup parameters for call to function osal_memcpy
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       ?V4,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       ?V5,A
        MOV       ?V6,#0x0
        MOV       R0,#?V4
        LCALL     ?PUSH_XSTACK_I_THREE
          CFI CFA_XSP16 add(XSP16, 32)
        MOV       R4,#0x8
        MOV       R5,#0x0
        MOV       A,#0x7
        LCALL     ?XSTACK_DISP0_8
        MOV       R2,DPL
        MOV       R3,DPH
        LCALL     `??osal_memcpy::?relay`; Banked call to: osal_memcpy
        MOV       A,#0x3
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 29)
// 1263       dev.parentAddr = device->parentAddr;
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       A,#0xc
        LCALL     ?XSTACK_DISP0_8
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
// 1264 
// 1265       zdoCBFunc[ZDO_TC_DEVICE_CBID]( (void*)&dev );
        ; Setup parameters for indirect call
        MOV       A,#0x2
        LCALL     ?XSTACK_DISP101_8
        MOV       DPTR,#zdoCBFunc + 16
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       DPH,A
        MOV       DPL,R0
        LCALL     ?CALL_IND
// 1266     }
// 1267   }
// 1268       
// 1269       
// 1270 
// 1271   return status;
??ZDSecMgrDeviceJoin_4:
        MOV       R1,?V0
        MOV       A,#0xe
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 15)
        MOV       R7,#0x7
        LJMP      ?BANKED_LEAVE_XDATA
// 1272 }
          CFI EndBlock cfiBlock21
// 1273 
// 1274 /******************************************************************************
// 1275  * @fn          ZDSecMgrDeviceJoinDirect
// 1276  *
// 1277  * @brief       Try to join this device as a direct child.
// 1278  *
// 1279  * @param       device - [in] ZDSecMgrDevice_t, device info
// 1280  *
// 1281  * @return      ZStatus_t
// 1282  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 1283 ZStatus_t ZDSecMgrDeviceJoinDirect( ZDSecMgrDevice_t* device )
ZDSecMgrDeviceJoinDirect:
          CFI Block cfiBlock22 Using cfiCommon0
          CFI Function ZDSecMgrDeviceJoinDirect
        CODE
// 1284 {
        FUNCALL ZDSecMgrDeviceJoinDirect, APSME_SearchTCLinkKeyEntry
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 38, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 38, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceJoinDirect, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 40, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 40, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceJoinDirect, ZDSecMgrDeviceJoin
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 36, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 36, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceJoinDirect, AssocGetWithShort
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 36, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 36, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceJoinDirect, ZDSecMgrAssocDeviceAuth
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 36, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 36, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        REQUIRE ?V2
        REQUIRE ?V3
        REQUIRE ?V4
        REQUIRE ?V6
        REQUIRE ?V7
        MOV       A,#-0x10
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 16)
        ; Saved register size: 16
        ; Auto size: 20
        MOV       A,#-0x14
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 36)
        MOV       A,R2
        MOV       R6,A
        MOV       A,R3
        MOV       R7,A
// 1285   ZStatus_t status;
// 1286   
// 1287   if(device->secure == FALSE)
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        JZ        $+5
        LJMP      ??ZDSecMgrDeviceJoinDirect_0 & 0xFFFF
// 1288   {  
// 1289     uint8  found;
// 1290     uint16 keyNvIndex;
// 1291     APSME_TCLKDevEntry_t TCLKDevEntry;
// 1292     
// 1293     keyNvIndex = APSME_SearchTCLinkKeyEntry(device->extAddr,&found, &TCLKDevEntry);
        ; Setup parameters for call to function APSME_SearchTCLinkKeyEntry
        MOV       A,#0x1
        LCALL     ?XSTACK_DISP100_8
        MOV       ?V0,R0
        MOV       ?V1,R1
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 38)
        MOV       A,#0x2
        LCALL     ?XSTACK_DISP102_8
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R2,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R3,A
        LCALL     `??APSME_SearchTCLinkKeyEntry::?relay`; Banked call to: APSME_SearchTCLinkKeyEntry
        MOV       A,#0x2
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 36)
        MOV       ?V0,R2
        MOV       ?V1,R3
        MOV       ?V2,?V0
        MOV       ?V3,?V1
// 1294     
// 1295     //If found and it was verified, then allow it to join in a fresh state by erasing the key entry
// 1296     if((found == TRUE) && (TCLKDevEntry.keyAttributes == ZG_VERIFIED_KEY))
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOVX      A,@DPTR
        XRL       A,#0x1
        JZ        $+5
        LJMP      ??ZDSecMgrDeviceJoinDirect_0 & 0xFFFF
        MOV       A,#0x11
        LCALL     ?XSTACK_DISP0_8
        MOVX      A,@DPTR
        XRL       A,#0x2
        JZ        $+5
        LJMP      ??ZDSecMgrDeviceJoinDirect_0 & 0xFFFF
// 1297     {
// 1298       uint16 index;
// 1299       TCLKDevEntry.keyAttributes = ZG_DEFAULT_KEY;
        MOV       A,#0x11
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#-0x1
        MOVX      @DPTR,A
// 1300       //Increase the shift by one. Validate the maximum shift of the seed which is 15
// 1301       TCLKDevEntry.SeedShift_IcIndex++;
        MOV       A,#0x13
        LCALL     ?XSTACK_DISP0_8
        MOVX      A,@DPTR
        ADD       A,#0x1
        MOVX      @DPTR,A
// 1302       TCLKDevEntry.SeedShift_IcIndex &= 0x0F;
        MOV       A,#0x13
        LCALL     ?XSTACK_DISP0_8
        MOVX      A,@DPTR
        ANL       A,#0xf
        MOVX      @DPTR,A
// 1303       
// 1304       TCLKDevEntry.rxFrmCntr = 0;
        MOV       A,#0x5
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
// 1305       TCLKDevEntry.txFrmCntr = 0;
        MOV       A,#0x1
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
// 1306       
// 1307       index = keyNvIndex - ZCD_NV_TCLK_TABLE_START;
        MOV       A,?V2
        ADD       A,#-0x11
        MOV       R0,A
        MOV       A,?V3
        ADDC      A,#-0x2
        MOV       R1,A
        MOV       ?V0,R0
        MOV       ?V1,R1
// 1308       
// 1309       TCLinkKeyFrmCntr[index].rxFrmCntr = 0;
        MOV       R0,?V0
        MOV       R1,?V1
        MOV       A,R0
        MOV       B,#0x9
        MUL       AB
        XCH       A,R0
        MOV       R2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R2
        MOV       R2,A
        MOV       B,#0x9
        MOV       A,R1
        MUL       AB
        ADD       A,R2
        MOV       R1,A
        MOV       A,#(TCLinkKeyFrmCntr + 4) & 0xff
        ADD       A,R0
        MOV       DPL,A
        MOV       A,#((TCLinkKeyFrmCntr + 4) >> 8) & 0xff
        ADDC      A,R1
        MOV       DPH,A
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
// 1310       TCLinkKeyFrmCntr[index].txFrmCntr = 0;
        MOV       R0,?V0
        MOV       R1,?V1
        MOV       A,R0
        MOV       B,#0x9
        MUL       AB
        XCH       A,R0
        MOV       R2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R2
        MOV       R2,A
        MOV       B,#0x9
        MOV       A,R1
        MUL       AB
        ADD       A,R2
        MOV       R1,A
        MOV       A,#TCLinkKeyFrmCntr & 0xff
        ADD       A,R0
        MOV       DPL,A
        MOV       A,#(TCLinkKeyFrmCntr >> 8) & 0xff
        ADDC      A,R1
        MOV       DPH,A
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
// 1311       
// 1312       //Update the entry
// 1313       osal_nv_write(keyNvIndex,0,sizeof(APSME_TCLKDevEntry_t), &TCLKDevEntry );
        ; Setup parameters for call to function osal_nv_write
        MOV       A,#0x1
        LCALL     ?XSTACK_DISP100_8
        MOV       ?V6,R0
        MOV       ?V7,R1
        MOV       R0,#?V6
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 38)
        MOV       ?V6,#0x13
        MOV       ?V7,#0x0
        MOV       R0,#?V6
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 40)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       R2,?V2
        MOV       R3,?V3
        LCALL     `??osal_nv_write::?relay`; Banked call to: osal_nv_write
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 36)
        MOV       A,R1
// 1314     }
// 1315     
// 1316   }
// 1317 
// 1318   status = ZDSecMgrDeviceJoin( device );
??ZDSecMgrDeviceJoinDirect_0:
        ; Setup parameters for call to function ZDSecMgrDeviceJoin
        MOV       A,R6
        MOV       R2,A
        MOV       A,R7
        MOV       R3,A
        LCALL     `??ZDSecMgrDeviceJoin::?relay`; Banked call to: ZDSecMgrDeviceJoin
        MOV       A,R1
        MOV       ?V4,A
// 1319 
// 1320   if ( status == ZSuccess )
        MOV       A,?V4
        JNZ       ??ZDSecMgrDeviceJoinDirect_1
// 1321   {
// 1322     // set association status to authenticated
// 1323     ZDSecMgrAssocDeviceAuth( AssocGetWithShort( device->nwkAddr ) );
        ; Setup parameters for call to function AssocGetWithShort
        MOV       DPL,R6
        MOV       DPH,R7
        MOVX      A,@DPTR
        MOV       R2,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R3,A
        LCALL     `??AssocGetWithShort::?relay`; Banked call to: AssocGetWithShort
        MOV       ?V0,R2
        MOV       ?V1,R3
        MOV       R2,?V0
        MOV       R3,?V1
        ; Setup parameters for call to function ZDSecMgrAssocDeviceAuth
        LCALL     `??ZDSecMgrAssocDeviceAuth::?relay`; Banked call to: ZDSecMgrAssocDeviceAuth
// 1324     
// 1325   #if (ZG_BUILD_COORDINATOR_TYPE)    
// 1326     //Add the device as joining device, if it did join unsecured
// 1327     if(device->secure == FALSE)
// 1328     {
// 1329       bdb_TCAddJoiningDevice(NLME_GetShortAddr(),device->extAddr);
// 1330     }
// 1331   #endif
// 1332   }
// 1333 
// 1334   return status;
??ZDSecMgrDeviceJoinDirect_1:
        MOV       R1,?V4
        MOV       A,#0x14
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 16)
        MOV       R7,#0x8
        LJMP      ?BANKED_LEAVE_XDATA
// 1335 }
          CFI EndBlock cfiBlock22
// 1336 
// 1337 /******************************************************************************
// 1338  * @fn          ZDSecMgrDeviceJoinFwd
// 1339  *
// 1340  * @brief       Forward join to Trust Center.
// 1341  *
// 1342  * @param       device - [in] ZDSecMgrDevice_t, device info
// 1343  *
// 1344  * @return      ZStatus_t
// 1345  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 1346 ZStatus_t ZDSecMgrDeviceJoinFwd( ZDSecMgrDevice_t* device )
ZDSecMgrDeviceJoinFwd:
          CFI Block cfiBlock23 Using cfiCommon0
          CFI Function ZDSecMgrDeviceJoinFwd
        CODE
// 1347 {
        FUNCALL ZDSecMgrDeviceJoinFwd, AssocGetWithShort
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 29, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 29, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceJoinFwd, ZDSecMgrAssocDeviceAuth
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 29, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 29, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceJoinFwd, APSME_GetRequest
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 29, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 29, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceJoinFwd, APSME_SearchTCLinkKeyEntry
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 31, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 31, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceJoinFwd, APSME_UpdateDeviceReq
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 29, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 29, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceJoinFwd, APSME_UpdateDeviceReq
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 29, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 29, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V2
        REQUIRE ?V3
        MOV       A,#-0xc
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 12)
        ; Saved register size: 12
        ; Auto size: 17
        MOV       A,#-0x11
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 29)
        MOV       A,R2
        MOV       R6,A
        MOV       A,R3
        MOV       R7,A
// 1348   ZStatus_t               status;
// 1349   APSME_UpdateDeviceReq_t req;
// 1350   uint8 TC_ExtAddr[Z_EXTADDR_LEN];
// 1351 
// 1352   // forward any joining device to the Trust Center -- the Trust Center will
// 1353   // decide if the device is allowed to join
// 1354   status = ZSuccess;
        MOV       ?V0,#0x0
// 1355 
// 1356   // forward authorization to the Trust Center
// 1357   req.dstAddr    = APSME_TRUSTCENTER_NWKADDR;
        MOV       A,#0x1
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
// 1358   req.devAddr    = device->nwkAddr;
        MOV       DPL,R6
        MOV       DPH,R7
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       A,#0x3
        LCALL     ?XSTACK_DISP0_8
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
// 1359   req.devExtAddr = device->extAddr;
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       A,#0x5
        LCALL     ?XSTACK_DISP0_8
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
// 1360 
// 1361   // set security status, option for router to reject if policy set
// 1362   if ( (device->devStatus & DEV_HIGH_SEC_STATUS) )
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       C,0xE0 /* A   */.7
        JNC       ??ZDSecMgrDeviceJoinFwd_0
// 1363   {
// 1364     if ( device->devStatus & DEV_REJOIN_STATUS )
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       C,0xE0 /* A   */.6
        JNC       ??ZDSecMgrDeviceJoinFwd_1
// 1365     {
// 1366       if ( device->secure == TRUE )
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        XRL       A,#0x1
        JNZ       ??ZDSecMgrDeviceJoinFwd_2
// 1367       {
// 1368         req.status = APSME_UD_HIGH_SECURED_REJOIN;
        MOV       A,#0x7
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x4
        MOVX      @DPTR,A
        SJMP      ??ZDSecMgrDeviceJoinFwd_3
// 1369       }
// 1370       else
// 1371       {
// 1372         req.status = APSME_UD_HIGH_UNSECURED_REJOIN;
??ZDSecMgrDeviceJoinFwd_2:
        MOV       A,#0x7
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x7
        MOVX      @DPTR,A
        SJMP      ??ZDSecMgrDeviceJoinFwd_3
// 1373       }
// 1374     }
// 1375     else
// 1376     {
// 1377       req.status = APSME_UD_HIGH_UNSECURED_JOIN;
??ZDSecMgrDeviceJoinFwd_1:
        MOV       A,#0x7
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x5
        MOVX      @DPTR,A
        SJMP      ??ZDSecMgrDeviceJoinFwd_3
// 1378     }
// 1379   }
// 1380   else
// 1381   {
// 1382     if ( device->devStatus & DEV_REJOIN_STATUS )
??ZDSecMgrDeviceJoinFwd_0:
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       C,0xE0 /* A   */.6
        JNC       ??ZDSecMgrDeviceJoinFwd_4
// 1383     {
// 1384       if ( device->secure == TRUE )
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        XRL       A,#0x1
        JNZ       ??ZDSecMgrDeviceJoinFwd_5
// 1385       {
// 1386         req.status = APSME_UD_STANDARD_SECURED_REJOIN;
        MOV       A,#0x7
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x0
        MOVX      @DPTR,A
        SJMP      ??ZDSecMgrDeviceJoinFwd_3
// 1387       }
// 1388       else
// 1389       {
// 1390         req.status = APSME_UD_STANDARD_TRUST_CENTER_REJOIN;
??ZDSecMgrDeviceJoinFwd_5:
        MOV       A,#0x7
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x3
        MOVX      @DPTR,A
        SJMP      ??ZDSecMgrDeviceJoinFwd_3
// 1391       }
// 1392     }
// 1393     else
// 1394     {
// 1395       req.status = APSME_UD_STANDARD_UNSECURED_JOIN;
??ZDSecMgrDeviceJoinFwd_4:
        MOV       A,#0x7
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x1
        MOVX      @DPTR,A
// 1396     }
// 1397   }
// 1398 
// 1399   // set association status to authenticated
// 1400   ZDSecMgrAssocDeviceAuth( AssocGetWithShort( device->nwkAddr ) );
??ZDSecMgrDeviceJoinFwd_3:
        ; Setup parameters for call to function AssocGetWithShort
        MOV       DPL,R6
        MOV       DPH,R7
        MOVX      A,@DPTR
        MOV       R2,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R3,A
        LCALL     `??AssocGetWithShort::?relay`; Banked call to: AssocGetWithShort
        MOV       ?V2,R2
        MOV       ?V3,R3
        MOV       R2,?V2
        MOV       R3,?V3
        ; Setup parameters for call to function ZDSecMgrAssocDeviceAuth
        LCALL     `??ZDSecMgrAssocDeviceAuth::?relay`; Banked call to: ZDSecMgrAssocDeviceAuth
// 1401 
// 1402   if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_SE_STANDARD )
// 1403   {
// 1404     uint8 found;
// 1405     APSME_GetRequest( apsTrustCenterAddress,0, TC_ExtAddr );
        ; Setup parameters for call to function APSME_GetRequest
        MOV       A,#0x9
        LCALL     ?XSTACK_DISP102_8
        MOV       R2,#0x0
        MOV       R3,#0x0
        MOV       R1,#-0x55
        LCALL     `??APSME_GetRequest::?relay`; Banked call to: APSME_GetRequest
        MOV       A,R1
// 1406     
// 1407     APSME_SearchTCLinkKeyEntry(TC_ExtAddr,&found,NULL);
        ; Setup parameters for call to function APSME_SearchTCLinkKeyEntry
        CLR       A
        MOV       ?V2,A
        MOV       ?V3,A
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 31)
        MOV       A,#0x2
        LCALL     ?XSTACK_DISP102_8
        MOV       A,#0xb
        LCALL     ?XSTACK_DISP101_8
        LCALL     `??APSME_SearchTCLinkKeyEntry::?relay`; Banked call to: APSME_SearchTCLinkKeyEntry
        MOV       A,#0x2
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 29)
// 1408     
// 1409     // For ZG_GLOBAL_LINK_KEY the message has to be sent twice one
// 1410     // un-encrypted and one APS encrypted, to make sure that it can interoperate
// 1411     // with legacy Coordinator devices which can only handle one or the other.
// 1412 #if defined ( APP_TP2_TEST_MODE )
// 1413     if ( ( zgApsLinkKeyType == ZG_GLOBAL_LINK_KEY ) && ( guTxApsSecON != TRUE ) )
// 1414 #else
// 1415     if ( ( zgApsLinkKeyType == ZG_GLOBAL_LINK_KEY ) && ( found == FALSE ) )
        MOV       DPTR,#zgApsLinkKeyType
        MOVX      A,@DPTR
        XRL       A,#0x1
        JNZ       ??ZDSecMgrDeviceJoinFwd_6
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOVX      A,@DPTR
        JNZ       ??ZDSecMgrDeviceJoinFwd_6
// 1416 #endif
// 1417     {
// 1418       req.apsSecure = FALSE;
        MOV       A,#0x8
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x0
        MOVX      @DPTR,A
// 1419 
// 1420       // send and APSME_UPDATE_DEVICE request to the trust center
// 1421       status = APSME_UpdateDeviceReq( &req );
        ; Setup parameters for call to function APSME_UpdateDeviceReq
        MOV       A,#0x1
        LCALL     ?XSTACK_DISP101_8
        LCALL     `??APSME_UpdateDeviceReq::?relay`; Banked call to: APSME_UpdateDeviceReq
        MOV       A,R1
        MOV       ?V0,A
// 1422     }
// 1423 
// 1424 #if defined ( APP_TP2_TEST_MODE )
// 1425     if ( guTxApsSecON != FALSE )
// 1426     {
// 1427       // send the message APS encrypted
// 1428       req.apsSecure = TRUE;
// 1429 
// 1430       // send and APSME_UPDATE_DEVICE request to the trust center
// 1431       status = APSME_UpdateDeviceReq( &req );
// 1432     }
// 1433 #else
// 1434     // send the message APS encrypted
// 1435     req.apsSecure = TRUE;
??ZDSecMgrDeviceJoinFwd_6:
        MOV       A,#0x8
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x1
        MOVX      @DPTR,A
// 1436 
// 1437     // send and APSME_UPDATE_DEVICE request to the trust center
// 1438     status = APSME_UpdateDeviceReq( &req );
        ; Setup parameters for call to function APSME_UpdateDeviceReq
        MOV       A,#0x1
        LCALL     ?XSTACK_DISP101_8
        LCALL     `??APSME_UpdateDeviceReq::?relay`; Banked call to: APSME_UpdateDeviceReq
        MOV       A,R1
        MOV       ?V0,A
// 1439 #endif
// 1440   }
// 1441   else
// 1442   {
// 1443     req.apsSecure = FALSE;
// 1444 
// 1445     // send and APSME_UPDATE_DEVICE request to the trust center
// 1446     status = APSME_UpdateDeviceReq( &req );
// 1447   }
// 1448 
// 1449   return status;
        MOV       R1,?V0
        MOV       A,#0x11
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 12)
        MOV       R7,#0x4
        LJMP      ?BANKED_LEAVE_XDATA
// 1450 }
          CFI EndBlock cfiBlock23
// 1451 
// 1452 /******************************************************************************
// 1453  * @fn          ZDSecMgrDeviceNew
// 1454  *
// 1455  * @brief       Process a new device.
// 1456  *
// 1457  * @param       device - [in] ZDSecMgrDevice_t, device info
// 1458  *
// 1459  * @return      ZStatus_t
// 1460  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 1461 ZStatus_t ZDSecMgrDeviceNew( ZDSecMgrDevice_t* joiner )
ZDSecMgrDeviceNew:
          CFI Block cfiBlock24 Using cfiCommon0
          CFI Function ZDSecMgrDeviceNew
        CODE
// 1462 {
        FUNCALL ZDSecMgrDeviceNew, ZDSecMgrDeviceJoinFwd
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        MOV       A,#-0x9
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
        MOV       A,R2
        MOV       R6,A
        MOV       A,R3
        MOV       R7,A
// 1463   ZStatus_t status;
// 1464 
// 1465   if ( ( ( ZG_BUILD_COORDINATOR_TYPE ) && ( ZG_DEVICE_COORDINATOR_TYPE ) )
// 1466       || ( ( ZG_BUILD_RTR_TYPE ) && APSME_IsDistributedSecurity() ) )
// 1467   {
// 1468     // try to join this device
// 1469     status = ZDSecMgrDeviceJoinDirect( joiner );
// 1470   }
// 1471   else
// 1472   {
// 1473     status = ZDSecMgrDeviceJoinFwd( joiner );
        ; Setup parameters for call to function ZDSecMgrDeviceJoinFwd
        MOV       A,R6
        MOV       R2,A
        MOV       A,R7
        MOV       R3,A
        LCALL     `??ZDSecMgrDeviceJoinFwd::?relay`; Banked call to: ZDSecMgrDeviceJoinFwd
        MOV       A,R1
        MOV       ?V0,A
// 1474   }
// 1475 
// 1476   return status;
        MOV       R1,?V0
        MOV       R7,#0x1
        LJMP      ?BANKED_LEAVE_XDATA
// 1477 }
          CFI EndBlock cfiBlock24
// 1478 
// 1479 /******************************************************************************
// 1480  * @fn          ZDSecMgrAssocDeviceAuth
// 1481  *
// 1482  * @brief       Set associated device status to authenticated
// 1483  *
// 1484  * @param       assoc - [in, out] associated_devices_t
// 1485  *
// 1486  * @return      none
// 1487  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 1488 void ZDSecMgrAssocDeviceAuth( associated_devices_t* assoc )
ZDSecMgrAssocDeviceAuth:
          CFI Block cfiBlock25 Using cfiCommon0
          CFI Function ZDSecMgrAssocDeviceAuth
        CODE
// 1489 {
        PUSH      DPL
          CFI DPL0 Frame(CFA_SP, 4)
          CFI CFA_SP SP+-4
        PUSH      DPH
          CFI DPH0 Frame(CFA_SP, 5)
          CFI CFA_SP SP+-5
        ; Saved register size: 2
        ; Auto size: 0
// 1490   if ( assoc != NULL )
        MOV       A,R2
        ORL       A,R3
        JZ        ??ZDSecMgrAssocDeviceAuth_0
// 1491   {
// 1492     assoc->devStatus |= DEV_SEC_AUTH_STATUS;
        MOV       DPL,R2
        MOV       DPH,R3
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        SETB      0xE0 /* A   */.3
        MOVX      @DPTR,A
// 1493   }
// 1494 }
??ZDSecMgrAssocDeviceAuth_0:
        POP       DPH
          CFI DPH0 SameValue
          CFI CFA_SP SP+-4
        POP       DPL
          CFI DPL0 SameValue
          CFI CFA_SP SP+-3
        LJMP      ?BRET
          CFI EndBlock cfiBlock25
// 1495 
// 1496 /******************************************************************************
// 1497  * @fn          ZDSecMgrAuthNwkKey
// 1498  *
// 1499  * @brief       Handle next step in authentication process
// 1500  *
// 1501  * @param       none
// 1502  *
// 1503  * @return      none
// 1504  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 1505 void ZDSecMgrAuthNwkKey()
ZDSecMgrAuthNwkKey:
          CFI Block cfiBlock26 Using cfiCommon0
          CFI Function ZDSecMgrAuthNwkKey
        CODE
// 1506 {
        FUNCALL ZDSecMgrAuthNwkKey, osal_set_event
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 0, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        PUSH      DPL
          CFI DPL0 Frame(CFA_SP, 4)
          CFI CFA_SP SP+-4
        PUSH      DPH
          CFI DPH0 Frame(CFA_SP, 5)
          CFI CFA_SP SP+-5
        ; Saved register size: 2
        ; Auto size: 0
// 1507   if ( devState == DEV_END_DEVICE_UNAUTH )
        MOV       DPTR,#devState
        MOVX      A,@DPTR
        XRL       A,#0x5
        JNZ       ??ZDSecMgrAuthNwkKey_0
// 1508   {
// 1509     // inform ZDO that device has been authenticated
// 1510     osal_set_event ( ZDAppTaskID, ZDO_DEVICE_AUTH );
        ; Setup parameters for call to function osal_set_event
        MOV       R2,#-0x80
        MOV       R3,#0x0
        MOV       DPTR,#ZDAppTaskID
        MOVX      A,@DPTR
        MOV       R1,A
        LCALL     `??osal_set_event::?relay`; Banked call to: osal_set_event
        MOV       A,R1
// 1511   }
// 1512 }
??ZDSecMgrAuthNwkKey_0:
        POP       DPH
          CFI DPH0 SameValue
          CFI CFA_SP SP+-4
        POP       DPL
          CFI DPL0 SameValue
          CFI CFA_SP SP+-3
        LJMP      ?BRET
          CFI EndBlock cfiBlock26
// 1513 
// 1514 /******************************************************************************
// 1515  * PUBLIC FUNCTIONS
// 1516  */
// 1517 /******************************************************************************
// 1518  * @fn          ZDSecMgrInit
// 1519  *
// 1520  * @brief       Initialize ZigBee Device Security Manager.
// 1521  *
// 1522  * @param       state - device initialization state
// 1523  *
// 1524  * @return      none
// 1525  */
// 1526 #if ( ADDRMGR_CALLBACK_ENABLED == 1 )
// 1527 void ZDSecMgrAddrMgrCB( uint8 update, AddrMgrEntry_t* newEntry, AddrMgrEntry_t* oldEntry );
// 1528 void ZDSecMgrAddrMgrCB( uint8           update,
// 1529                         AddrMgrEntry_t* newEntry,
// 1530                         AddrMgrEntry_t* oldEntry )
// 1531 {
// 1532   (void)update;
// 1533   (void)newEntry;
// 1534   (void)oldEntry;
// 1535 }
// 1536 #endif // ( ADDRMGR_CALLBACK_ENABLED == 1 )
// 1537 

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 1538 void ZDSecMgrInit(uint8 state)
ZDSecMgrInit:
          CFI Block cfiBlock27 Using cfiCommon0
          CFI Function ZDSecMgrInit
        CODE
// 1539 {
        FUNCALL ZDSecMgrInit, ZDSecMgrEntryInit
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrInit, ZDSecMgrConfig
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV       A,#-0x9
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
        MOV       A,R1
        MOV       R6,A
// 1540   if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_SE_STANDARD )
// 1541   {
// 1542     // initialize sub modules
// 1543     ZDSecMgrEntryInit(state);
        ; Setup parameters for call to function ZDSecMgrEntryInit
        MOV       A,R6
        MOV       R1,A
        LCALL     `??ZDSecMgrEntryInit::?relay`; Banked call to: ZDSecMgrEntryInit
// 1544 
// 1545     if ( ( ZG_BUILD_COORDINATOR_TYPE ) && ( ZG_DEVICE_COORDINATOR_TYPE ) )
// 1546     {
// 1547       APSME_SetRequest( apsTrustCenterAddress, 0, NLME_GetExtAddr() );
// 1548     }
// 1549 
// 1550     // register with Address Manager
// 1551 #if ( ADDRMGR_CALLBACK_ENABLED == 1 )
// 1552     AddrMgrRegister( ADDRMGR_REG_SECURITY, ZDSecMgrAddrMgrCB );
// 1553 #endif
// 1554   }
// 1555 
// 1556   if ( ZG_SECURE_ENABLED )
// 1557   {
// 1558     if ( ( ( ZG_BUILD_COORDINATOR_TYPE ) && ( ZG_DEVICE_COORDINATOR_TYPE ) )
// 1559          || ( ( ZG_BUILD_RTR_TYPE ) && APSME_IsDistributedSecurity() ) )
// 1560     {
// 1561       // setup joining permissions
// 1562       ZDSecMgrPermitJoiningEnabled = TRUE;  
// 1563       ZDSecMgrPermitJoiningTimed   = FALSE;
// 1564     }
// 1565   }
// 1566 
// 1567   // configure security based on security mode and type of device
// 1568   ZDSecMgrConfig();
        ; Setup parameters for call to function ZDSecMgrConfig
        LCALL     `??ZDSecMgrConfig::?relay`; Banked call to: ZDSecMgrConfig
// 1569 }
        MOV       R7,#0x1
        LJMP      ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock27
// 1570 
// 1571 /******************************************************************************
// 1572  * @fn          ZDSecMgrConfig
// 1573  *
// 1574  * @brief       Configure ZigBee Device Security Manager.
// 1575  *
// 1576  * @param       none
// 1577  *
// 1578  * @return      none
// 1579  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 1580 void ZDSecMgrConfig( void )
ZDSecMgrConfig:
          CFI Block cfiBlock28 Using cfiCommon0
          CFI Function ZDSecMgrConfig
        CODE
// 1581 {
        FUNCALL ZDSecMgrConfig, SSP_Init
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 0, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrConfig, APSME_SecurityCM_ED
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 0, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        PUSH      DPL
          CFI DPL0 Frame(CFA_SP, 4)
          CFI CFA_SP SP+-4
        PUSH      DPH
          CFI DPH0 Frame(CFA_SP, 5)
          CFI CFA_SP SP+-5
        ; Saved register size: 2
        ; Auto size: 0
// 1582   if ( ZG_SECURE_ENABLED )
// 1583   {
// 1584     SSP_Init();
        ; Setup parameters for call to function SSP_Init
        LCALL     `??SSP_Init::?relay`; Banked call to: SSP_Init
// 1585 
// 1586     if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_SE_STANDARD )
// 1587     {
// 1588       if ( ( ZG_BUILD_COORDINATOR_TYPE ) && ( ZG_DEVICE_COORDINATOR_TYPE ) )
// 1589       {
// 1590         // COMMERCIAL MODE - COORDINATOR DEVICE
// 1591         APSME_SecurityCM_CD();
// 1592       }
// 1593       else if ( ZSTACK_ROUTER_BUILD )
// 1594       {
// 1595         // COMMERCIAL MODE - ROUTER DEVICE
// 1596         APSME_SecurityCM_RD();
// 1597       }
// 1598       else
// 1599       {
// 1600         // COMMERCIAL MODE - END DEVICE
// 1601         APSME_SecurityCM_ED();
        ; Setup parameters for call to function APSME_SecurityCM_ED
        LCALL     `??APSME_SecurityCM_ED::?relay`; Banked call to: APSME_SecurityCM_ED
// 1602       }
// 1603     }
// 1604     else // ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_RESIDENTIAL )
// 1605     {
// 1606       if ( ( ZG_BUILD_COORDINATOR_TYPE ) && ( ZG_DEVICE_COORDINATOR_TYPE ) )
// 1607       {
// 1608         // RESIDENTIAL MODE - COORDINATOR DEVICE
// 1609         APSME_SecurityRM_CD();
// 1610       }
// 1611       else if ( ZSTACK_ROUTER_BUILD )
// 1612       {
// 1613         // RESIDENTIAL MODE - ROUTER DEVICE
// 1614         APSME_SecurityRM_RD();
// 1615       }
// 1616       else
// 1617       {
// 1618         // RESIDENTIAL MODE - END DEVICE
// 1619         APSME_SecurityRM_ED();
// 1620       }
// 1621     }
// 1622   }
// 1623   else
// 1624   {
// 1625     // NO SECURITY
// 1626     APSME_SecurityNM();
// 1627   }
// 1628 }
        POP       DPH
          CFI DPH0 SameValue
          CFI CFA_SP SP+-4
        POP       DPL
          CFI DPL0 SameValue
          CFI CFA_SP SP+-3
        LJMP      ?BRET
          CFI EndBlock cfiBlock28
// 1629 
// 1630 /******************************************************************************
// 1631  * @fn          ZDSecMgrPermitJoining
// 1632  *
// 1633  * @brief       Process request to change joining permissions.
// 1634  *
// 1635  * @param       duration - [in] timed duration for join in seconds
// 1636  *                         - 0x00 not allowed
// 1637  *                         - 0xFF allowed without timeout
// 1638  *
// 1639  * @return      uint8 - success(TRUE:FALSE)
// 1640  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 1641 uint8 ZDSecMgrPermitJoining( uint8 duration )
ZDSecMgrPermitJoining:
          CFI Block cfiBlock29 Using cfiCommon0
          CFI Function ZDSecMgrPermitJoining
        CODE
// 1642 {
        PUSH      DPL
          CFI DPL0 Frame(CFA_SP, 4)
          CFI CFA_SP SP+-4
        PUSH      DPH
          CFI DPH0 Frame(CFA_SP, 5)
          CFI CFA_SP SP+-5
        ; Saved register size: 2
        ; Auto size: 0
        MOV       A,R1
        MOV       R0,A
// 1643   uint8 accept;
// 1644 
// 1645   ZDSecMgrPermitJoiningTimed = FALSE;
        MOV       DPTR,#ZDSecMgrPermitJoiningTimed
        MOV       A,#0x0
        MOVX      @DPTR,A
// 1646 
// 1647   if ( duration > 0 )
        MOV       A,R0
        JZ        ??ZDSecMgrPermitJoining_0
// 1648   {
// 1649     ZDSecMgrPermitJoiningEnabled = TRUE;
        MOV       DPTR,#ZDSecMgrPermitJoiningEnabled
        MOV       A,#0x1
        MOVX      @DPTR,A
// 1650 
// 1651     ZDSecMgrPermitJoiningTimed = TRUE;
        MOV       DPTR,#ZDSecMgrPermitJoiningTimed
        MOV       A,#0x1
        MOVX      @DPTR,A
        SJMP      ??ZDSecMgrPermitJoining_1
// 1652   }
// 1653   else
// 1654   {
// 1655     ZDSecMgrPermitJoiningEnabled = FALSE;
??ZDSecMgrPermitJoining_0:
        MOV       DPTR,#ZDSecMgrPermitJoiningEnabled
        MOV       A,#0x0
        MOVX      @DPTR,A
// 1656   }
// 1657 
// 1658   accept = TRUE;
??ZDSecMgrPermitJoining_1:
        MOV       R1,#0x1
// 1659 
// 1660   return accept;
        POP       DPH
          CFI DPH0 SameValue
          CFI CFA_SP SP+-4
        POP       DPL
          CFI DPL0 SameValue
          CFI CFA_SP SP+-3
        LJMP      ?BRET
// 1661 }
          CFI EndBlock cfiBlock29
// 1662 
// 1663 /******************************************************************************
// 1664  * @fn          ZDSecMgrPermitJoiningTimeout
// 1665  *
// 1666  * @brief       Process permit joining timeout
// 1667  *
// 1668  * @param       none
// 1669  *
// 1670  * @return      none
// 1671  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 1672 void ZDSecMgrPermitJoiningTimeout( void )
ZDSecMgrPermitJoiningTimeout:
          CFI Block cfiBlock30 Using cfiCommon0
          CFI Function ZDSecMgrPermitJoiningTimeout
        CODE
// 1673 {
        PUSH      DPL
          CFI DPL0 Frame(CFA_SP, 4)
          CFI CFA_SP SP+-4
        PUSH      DPH
          CFI DPH0 Frame(CFA_SP, 5)
          CFI CFA_SP SP+-5
        ; Saved register size: 2
        ; Auto size: 0
// 1674   if ( ZDSecMgrPermitJoiningTimed == TRUE )
        MOV       DPTR,#ZDSecMgrPermitJoiningTimed
        MOVX      A,@DPTR
        XRL       A,#0x1
        JNZ       ??ZDSecMgrPermitJoiningTimeout_0
// 1675   {
// 1676     ZDSecMgrPermitJoiningEnabled = FALSE;
        MOV       DPTR,#ZDSecMgrPermitJoiningEnabled
        MOV       A,#0x0
        MOVX      @DPTR,A
// 1677     ZDSecMgrPermitJoiningTimed   = FALSE;
        MOV       DPTR,#ZDSecMgrPermitJoiningTimed
        MOV       A,#0x0
        MOVX      @DPTR,A
// 1678   }
// 1679 }
??ZDSecMgrPermitJoiningTimeout_0:
        POP       DPH
          CFI DPH0 SameValue
          CFI CFA_SP SP+-4
        POP       DPL
          CFI DPL0 SameValue
          CFI CFA_SP SP+-3
        LJMP      ?BRET
          CFI EndBlock cfiBlock30
// 1680 
// 1681 /******************************************************************************
// 1682  * @fn          ZDSecMgrNewDeviceEvent
// 1683  *
// 1684  * @brief       Process a the new device event, if found reset new device
// 1685  *              event/timer.
// 1686  *
// 1687  * @param       ShortAddr - of New Device to process
// 1688  *
// 1689  * @return      uint8 - found(TRUE:FALSE)
// 1690  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 1691 uint8 ZDSecMgrNewDeviceEvent( uint16 ShortAddr )
ZDSecMgrNewDeviceEvent:
          CFI Block cfiBlock31 Using cfiCommon0
          CFI Function ZDSecMgrNewDeviceEvent
        CODE
// 1692 {
        FUNCALL ZDSecMgrNewDeviceEvent, AssocGetWithShort
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 35, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 35, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrNewDeviceEvent, ZDSecMgrAssocDeviceAuth
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 35, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 35, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrNewDeviceEvent, AddrMgrEntryGet
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 35, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 35, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrNewDeviceEvent, NLME_GetShortAddr
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 35, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 35, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrNewDeviceEvent, ZDSecMgrDeviceNew
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 35, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 35, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrNewDeviceEvent, ZDSecMgrAddrClear
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 35, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 35, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrNewDeviceEvent, AssocRemove
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 35, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 35, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        REQUIRE ?V2
        REQUIRE ?V3
        REQUIRE ?V4
        REQUIRE ?V5
        MOV       A,#-0xe
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 14)
        ; Saved register size: 14
        ; Auto size: 21
        MOV       A,#-0x15
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 35)
        MOV       ?V0,R2
        MOV       ?V1,R3
// 1693   uint8                 found;
// 1694   ZDSecMgrDevice_t      device;
// 1695   AddrMgrEntry_t        addrEntry;
// 1696   associated_devices_t* assoc;
// 1697   ZStatus_t             status;
// 1698 
// 1699   // initialize return results
// 1700   found = FALSE;
        MOV       ?V2,#0x0
// 1701 
// 1702   assoc = AssocGetWithShort( ShortAddr );
        ; Setup parameters for call to function AssocGetWithShort
        MOV       R2,?V0
        MOV       R3,?V1
        LCALL     `??AssocGetWithShort::?relay`; Banked call to: AssocGetWithShort
        MOV       ?V4,R2
        MOV       ?V5,R3
        MOV       R6,?V4
        MOV       R7,?V5
// 1703 
// 1704   if ( assoc != NULL )
        MOV       A,R6
        ORL       A,R7
        JNZ       $+5
        LJMP      ??ZDSecMgrNewDeviceEvent_0 & 0xFFFF
// 1705   {
// 1706     // device found
// 1707     found = TRUE;
        MOV       ?V2,#0x1
// 1708 
// 1709     // check for preconfigured security
// 1710     if ( zgPreConfigKeys == TRUE )
        MOV       DPTR,#zgPreConfigKeys
        MOVX      A,@DPTR
        XRL       A,#0x1
        JNZ       ??ZDSecMgrNewDeviceEvent_1
// 1711     {
// 1712       // set association status to authenticated
// 1713       ZDSecMgrAssocDeviceAuth( assoc );
        ; Setup parameters for call to function ZDSecMgrAssocDeviceAuth
        MOV       A,R6
        MOV       R2,A
        MOV       A,R7
        MOV       R3,A
        LCALL     `??ZDSecMgrAssocDeviceAuth::?relay`; Banked call to: ZDSecMgrAssocDeviceAuth
// 1714     }
// 1715 
// 1716     // set up device info
// 1717     addrEntry.user  = ADDRMGR_USER_DEFAULT;
??ZDSecMgrNewDeviceEvent_1:
        MOV       A,#0x8
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x0
        MOVX      @DPTR,A
// 1718     addrEntry.index = assoc->addrIdx;
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       A,#0x13
        LCALL     ?XSTACK_DISP0_8
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
// 1719     AddrMgrEntryGet( &addrEntry );
        ; Setup parameters for call to function AddrMgrEntryGet
        MOV       A,#0x8
        LCALL     ?XSTACK_DISP101_8
        LCALL     `??AddrMgrEntryGet::?relay`; Banked call to: AddrMgrEntryGet
        MOV       A,R1
// 1720 
// 1721     device.nwkAddr    = assoc->shortAddr;
        MOV       DPL,R6
        MOV       DPH,R7
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
// 1722     device.extAddr    = addrEntry.extAddr;
        MOV       A,#0xb
        LCALL     ?XSTACK_DISP0_8
        MOV       R0,DPL
        MOV       R1,DPH
        MOV       A,#0x2
        LCALL     ?XSTACK_DISP0_8
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
// 1723     device.parentAddr = NLME_GetShortAddr();
        ; Setup parameters for call to function NLME_GetShortAddr
        LCALL     `??NLME_GetShortAddr::?relay`; Banked call to: NLME_GetShortAddr
        MOV       A,#0x4
        LCALL     ?XSTACK_DISP0_8
        MOV       A,R2
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R3
        MOVX      @DPTR,A
// 1724 
// 1725     // the new device performed Secured Rejoin
// 1726     if ( ( assoc->devStatus & DEV_SECURED_JOIN ) &&
// 1727          ( assoc->devStatus & DEV_REJOIN_STATUS ) )
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        ANL       A,#0x60
        XRL       A,#0x60
        JNZ       ??ZDSecMgrNewDeviceEvent_2
// 1728     {
// 1729       device.secure     = TRUE;
        MOV       A,#0x6
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x1
        MOVX      @DPTR,A
        SJMP      ??ZDSecMgrNewDeviceEvent_3
// 1730     }
// 1731     else
// 1732     {
// 1733       device.secure     = FALSE;
??ZDSecMgrNewDeviceEvent_2:
        MOV       A,#0x6
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x0
        MOVX      @DPTR,A
// 1734     }
// 1735     device.devStatus  = assoc->devStatus;
??ZDSecMgrNewDeviceEvent_3:
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        PUSH      A
          CFI CFA_SP SP+-1
        MOV       A,#0x7
        LCALL     ?XSTACK_DISP0_8
        POP       A
          CFI CFA_SP SP+0
        MOVX      @DPTR,A
// 1736 
// 1737     // process new device
// 1738     status = ZDSecMgrDeviceNew( &device );
        ; Setup parameters for call to function ZDSecMgrDeviceNew
        MOV       R2,?XSP + 0
        MOV       R3,?XSP + 1
        LCALL     `??ZDSecMgrDeviceNew::?relay`; Banked call to: ZDSecMgrDeviceNew
        MOV       A,R1
        MOV       ?V3,A
// 1739 
// 1740     if ( status == ZSuccess )
        MOV       A,?V3
        JNZ       ??ZDSecMgrNewDeviceEvent_4
// 1741     {
// 1742       assoc->devStatus &= ~DEV_SEC_INIT_STATUS;
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        CLR       0xE0 /* A   */.2
        MOVX      @DPTR,A
        SJMP      ??ZDSecMgrNewDeviceEvent_0
// 1743     }
// 1744     else
// 1745     {
// 1746       // Clear SECURITY bit from Address Manager
// 1747       ZDSecMgrAddrClear( addrEntry.extAddr );
??ZDSecMgrNewDeviceEvent_4:
        ; Setup parameters for call to function ZDSecMgrAddrClear
        MOV       A,#0xb
        LCALL     ?XSTACK_DISP0_8
        MOV       R2,DPL
        MOV       R3,DPH
        LCALL     `??ZDSecMgrAddrClear::?relay`; Banked call to: ZDSecMgrAddrClear
        MOV       A,R1
// 1748 
// 1749       // Remove the Association completely
// 1750       AssocRemove( addrEntry.extAddr );
        ; Setup parameters for call to function AssocRemove
        MOV       A,#0xb
        LCALL     ?XSTACK_DISP0_8
        MOV       R2,DPL
        MOV       R3,DPH
        LCALL     `??AssocRemove::?relay`; Banked call to: AssocRemove
        MOV       A,R1
// 1751     }
// 1752   }
// 1753 
// 1754   return found;
??ZDSecMgrNewDeviceEvent_0:
        MOV       R1,?V2
        MOV       A,#0x15
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 14)
        MOV       R7,#0x6
        LJMP      ?BANKED_LEAVE_XDATA
// 1755 }
          CFI EndBlock cfiBlock31
// 1756 
// 1757 /******************************************************************************
// 1758  * @fn          ZDSecMgrTCExtAddrCheck
// 1759  *
// 1760  * @brief       Verifies if received ext. address matches TC ext. address.
// 1761  *
// 1762  * @param       extAddr - Extended address to be verified.
// 1763  *
// 1764  * @return      TRUE - extended address matches
// 1765  *              FALSE - otherwise
// 1766  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 1767 uint8 ZDSecMgrTCExtAddrCheck( uint8* extAddr )
ZDSecMgrTCExtAddrCheck:
          CFI Block cfiBlock32 Using cfiCommon0
          CFI Function ZDSecMgrTCExtAddrCheck
        CODE
// 1768 {
        FUNCALL ZDSecMgrTCExtAddrCheck, APSME_GetRequest
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 17, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 17, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTCExtAddrCheck, sAddrExtCmp
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 17, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 17, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV       A,#-0x9
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 8
        MOV       A,#-0x8
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 17)
        MOV       A,R2
        MOV       R6,A
        MOV       A,R3
        MOV       R7,A
// 1769   uint8  lookup[Z_EXTADDR_LEN];
// 1770   APSME_GetRequest( apsTrustCenterAddress, 0, lookup );
        ; Setup parameters for call to function APSME_GetRequest
        MOV       R4,?XSP + 0
        MOV       R5,?XSP + 1
        MOV       R2,#0x0
        MOV       R3,#0x0
        MOV       R1,#-0x55
        LCALL     `??APSME_GetRequest::?relay`; Banked call to: APSME_GetRequest
        MOV       A,R1
// 1771   return osal_ExtAddrEqual( extAddr, lookup );
        ; Setup parameters for call to function sAddrExtCmp
        MOV       R4,?XSP + 0
        MOV       R5,?XSP + 1
        MOV       A,R6
        MOV       R2,A
        MOV       A,R7
        MOV       R3,A
        LCALL     `??sAddrExtCmp::?relay`; Banked call to: sAddrExtCmp
        MOV       A,#0x8
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 9)
        MOV       R7,#0x1
        LJMP      ?BANKED_LEAVE_XDATA
// 1772 }
          CFI EndBlock cfiBlock32
// 1773 
// 1774 /******************************************************************************
// 1775  * @fn          ZDSecMgrTCDataLoad
// 1776  *
// 1777  * @brief       Stores the address of TC into address manager.
// 1778  *
// 1779  * @param       extAddr - Extended address to be verified.
// 1780  *
// 1781  * @return      none
// 1782  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 1783 void ZDSecMgrTCDataLoad( uint8* extAddr )
ZDSecMgrTCDataLoad:
          CFI Block cfiBlock33 Using cfiCommon0
          CFI Function ZDSecMgrTCDataLoad
        CODE
// 1784 {
        FUNCALL ZDSecMgrTCDataLoad, sAddrExtCpy
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 25, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 25, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTCDataLoad, APSME_IsDistributedSecurity
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 25, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 25, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTCDataLoad, AddrMgrEntryLookupExt
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 25, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 25, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTCDataLoad, ZDSecMgrAddrStore
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 27, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 27, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        MOV       A,#-0xa
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 10)
        ; Saved register size: 10
        ; Auto size: 15
        MOV       A,#-0xf
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 25)
        MOV       A,R2
        MOV       R6,A
        MOV       A,R3
        MOV       R7,A
// 1785   uint16 ami;
// 1786   AddrMgrEntry_t entry;
// 1787 
// 1788   // lookup using TC short address
// 1789   entry.user    = ADDRMGR_USER_DEFAULT;
        MOV       A,#0x2
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x0
        MOVX      @DPTR,A
// 1790   osal_cpyExtAddr( entry.extAddr, extAddr );
        ; Setup parameters for call to function sAddrExtCpy
        MOV       A,R6
        MOV       R4,A
        MOV       A,R7
        MOV       R5,A
        MOV       A,#0x5
        LCALL     ?XSTACK_DISP0_8
        MOV       R2,DPL
        MOV       R3,DPH
        LCALL     `??sAddrExtCpy::?relay`; Banked call to: sAddrExtCpy
// 1791 
// 1792   // Verify if TC address has been added to Address Manager
// 1793   if ( !APSME_IsDistributedSecurity() && ( AddrMgrEntryLookupExt( &entry ) != TRUE ) )
        ; Setup parameters for call to function APSME_IsDistributedSecurity
        LCALL     `??APSME_IsDistributedSecurity::?relay`; Banked call to: APSME_IsDistributedSecurity
        MOV       A,R1
        JNZ       ??ZDSecMgrTCDataLoad_0
        ; Setup parameters for call to function AddrMgrEntryLookupExt
        MOV       A,#0x2
        LCALL     ?XSTACK_DISP101_8
        LCALL     `??AddrMgrEntryLookupExt::?relay`; Banked call to: AddrMgrEntryLookupExt
        MOV       A,R1
        XRL       A,#0x1
        JZ        ??ZDSecMgrTCDataLoad_0
// 1794   {
// 1795     ZDSecMgrAddrStore( APSME_TRUSTCENTER_NWKADDR, extAddr, &ami );
        ; Setup parameters for call to function ZDSecMgrAddrStore
        MOV       R0,?XSP + 0
        MOV       R1,?XSP + 1
        MOV       ?V0,R0
        MOV       ?V1,R1
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 27)
        MOV       A,R6
        MOV       R4,A
        MOV       A,R7
        MOV       R5,A
        MOV       R2,#0x0
        MOV       R3,#0x0
        LCALL     `??ZDSecMgrAddrStore::?relay`; Banked call to: ZDSecMgrAddrStore
        MOV       A,#0x2
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 25)
        MOV       A,R1
// 1796   }
// 1797 }
??ZDSecMgrTCDataLoad_0:
        MOV       A,#0xf
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 10)
        MOV       R7,#0x2
        LJMP      ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock33
// 1798 
// 1799 /******************************************************************************
// 1800  * @fn          ZDSecMgrTransportKeyInd
// 1801  *
// 1802  * @brief       Process the ZDO_TransportKeyInd_t message.
// 1803  *
// 1804  * @param       ind - [in] ZDO_TransportKeyInd_t indication
// 1805  *
// 1806  * @return      none
// 1807  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 1808 void ZDSecMgrTransportKeyInd( ZDO_TransportKeyInd_t* ind )
ZDSecMgrTransportKeyInd:
          CFI Block cfiBlock34 Using cfiCommon0
          CFI Function ZDSecMgrTransportKeyInd
        CODE
// 1809 {
        FUNCALL ZDSecMgrTransportKeyInd, ZDSecMgrUpdateTCAddress
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 54, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 54, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTransportKeyInd, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 58, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 58, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTransportKeyInd, ZDSecMgrTCDataLoad
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 54, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 54, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTransportKeyInd, ZDSecMgrReadKeyFromNv
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 54, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 54, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTransportKeyInd, SSP_UpdateNwkKey
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 54, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 54, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTransportKeyInd, SSP_SwitchNwkKey
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 54, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 54, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTransportKeyInd, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 54, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 54, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTransportKeyInd, SSP_UpdateNwkKey
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 54, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 54, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTransportKeyInd, SSP_SwitchNwkKey
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 54, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 54, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTransportKeyInd, ZDSecMgrAuthNwkKey
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 54, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 54, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTransportKeyInd, APSME_SearchTCLinkKeyEntry
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 56, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 56, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTransportKeyInd, APSME_EraseICEntry
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 54, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 54, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTransportKeyInd, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 58, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 58, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTransportKeyInd, osal_nv_item_init
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 56, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 56, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTransportKeyInd, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 58, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 58, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTransportKeyInd, bdb_tcLinkKeyExchangeAttempt
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 54, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 54, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTransportKeyInd, ZDSecMgrExtAddrLookup
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 54, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 54, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTransportKeyInd, ZDSecMgrAddrStore
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 56, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 56, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTransportKeyInd, ZDP_NwkAddrReq
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 54, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 54, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTransportKeyInd, ZDSecMgrEntryLookupAMI
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 54, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 54, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTransportKeyInd, ZDSecMgrEntryNew
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 54, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 54, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTransportKeyInd, APSME_LinkKeySet
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 54, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 54, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTransportKeyInd, ZDSecMgrWriteNV
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 54, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 54, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V2
        REQUIRE ?V3
        REQUIRE ?V4
        REQUIRE ?V5
        MOV       A,#-0xe
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 14)
        ; Saved register size: 14
        ; Auto size: 40
        MOV       A,#-0x28
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 54)
        MOV       A,R2
        MOV       R6,A
        MOV       A,R3
        MOV       R7,A
// 1810   uint8 index;
// 1811   uint8 zgPreConfigKey[SEC_KEY_LEN];
// 1812 
// 1813   ZDSecMgrUpdateTCAddress( ind->srcExtAddr );
        ; Setup parameters for call to function ZDSecMgrUpdateTCAddress
        MOV       A,R6
        ADD       A,#0x16
        MOV       R2,A
        CLR       A
        ADDC      A,R7
        MOV       R3,A
        LCALL     `??ZDSecMgrUpdateTCAddress::?relay`; Banked call to: ZDSecMgrUpdateTCAddress
// 1814   
// 1815 #if ZG_BUILD_JOINING_TYPE
// 1816   if(ZG_DEVICE_JOINING_TYPE)
        MOV       DPTR,#zgDeviceLogicalType
        MOVX      A,@DPTR
        XRL       A,#0x1
        JZ        ??ZDSecMgrTransportKeyInd_0
        MOV       DPTR,#zgDeviceLogicalType
        MOVX      A,@DPTR
        XRL       A,#0x2
        JNZ       ??ZDSecMgrTransportKeyInd_1
// 1817   {
// 1818     //Update the TC address in the entry
// 1819     osal_nv_write(ZCD_NV_TCLK_TABLE_START, osal_offsetof(APSME_TCLKDevEntry_t,extAddr), Z_EXTADDR_LEN, ind->srcExtAddr);
??ZDSecMgrTransportKeyInd_0:
        ; Setup parameters for call to function osal_nv_write
        MOV       A,R6
        ADD       A,#0x16
        MOV       ?V2,A
        CLR       A
        ADDC      A,R7
        MOV       ?V3,A
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 56)
        MOV       ?V2,#0x8
        MOV       ?V3,#0x0
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 58)
        MOV       R4,#0x8
        MOV       R5,#0x0
        MOV       R2,#0x11
        MOV       R3,#0x1
        LCALL     `??osal_nv_write::?relay`; Banked call to: osal_nv_write
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 54)
        MOV       A,R1
// 1820   }
// 1821 #endif
// 1822   
// 1823   // check for distributed security
// 1824   if ( ( ZG_BUILD_RTR_TYPE ) && osal_isbufset( ind->srcExtAddr, 0xFF, Z_EXTADDR_LEN ) )
// 1825   {
// 1826     ZDSecMgrPermitJoiningEnabled = TRUE;  
// 1827   }
// 1828   
// 1829   // load Trust Center data if needed
// 1830   ZDSecMgrTCDataLoad( ind->srcExtAddr );
??ZDSecMgrTransportKeyInd_1:
        ; Setup parameters for call to function ZDSecMgrTCDataLoad
        MOV       A,R6
        ADD       A,#0x16
        MOV       R2,A
        CLR       A
        ADDC      A,R7
        MOV       R3,A
        LCALL     `??ZDSecMgrTCDataLoad::?relay`; Banked call to: ZDSecMgrTCDataLoad
// 1831   
// 1832   if ( ( ind->keyType == KEY_TYPE_NWK ) ||
// 1833        ( ind->keyType == 6            ) )
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        XRL       A,#0x1
        JZ        ??ZDSecMgrTransportKeyInd_2
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        XRL       A,#0x6
        JZ        $+5
        LJMP      ??ZDSecMgrTransportKeyInd_3 & 0xFFFF
// 1834   {
// 1835     // check for dummy NWK key (all zeros)
// 1836     for ( index = 0;
??ZDSecMgrTransportKeyInd_2:
        MOV       ?V0,#0x0
// 1837           ( (index < SEC_KEY_LEN) && (ind->key[index] == 0) );
??ZDSecMgrTransportKeyInd_4:
        MOV       A,?V0
        CLR       C
        SUBB      A,#0x10
        JNC       ??ZDSecMgrTransportKeyInd_5
        MOV       A,?V0
        MOV       R0,A
        MOV       R1,#0x0
        MOV       A,R6
        ADD       A,R0
        MOV       DPL,A
        MOV       A,R7
        ADDC      A,R1
        MOV       DPH,A
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        JNZ       ??ZDSecMgrTransportKeyInd_5
// 1838           index++ );
        INC       ?V0
        SJMP      ??ZDSecMgrTransportKeyInd_4
// 1839 
// 1840     if ( index == SEC_KEY_LEN )
??ZDSecMgrTransportKeyInd_5:
        MOV       A,#0x10
        XRL       A,?V0
        JNZ       ??ZDSecMgrTransportKeyInd_6
// 1841     {
// 1842       // load preconfigured key - once!!
// 1843       if ( !_NIB.nwkKeyLoaded )
        MOV       DPTR,#_NIB + 61
        MOVX      A,@DPTR
        JNZ       ??ZDSecMgrTransportKeyInd_7
// 1844       {
// 1845         ZDSecMgrReadKeyFromNv(ZCD_NV_PRECFGKEY, zgPreConfigKey);
        ; Setup parameters for call to function ZDSecMgrReadKeyFromNv
        MOV       A,#0x18
        LCALL     ?XSTACK_DISP102_8
        MOV       R2,#0x62
        MOV       R3,#0x0
        LCALL     `??ZDSecMgrReadKeyFromNv::?relay`; Banked call to: ZDSecMgrReadKeyFromNv
        MOV       A,R1
// 1846         SSP_UpdateNwkKey( zgPreConfigKey, 0 );
        ; Setup parameters for call to function SSP_UpdateNwkKey
        MOV       R1,#0x0
        MOV       A,#0x18
        LCALL     ?XSTACK_DISP101_8
        LCALL     `??SSP_UpdateNwkKey::?relay`; Banked call to: SSP_UpdateNwkKey
// 1847         SSP_SwitchNwkKey( 0 );
        ; Setup parameters for call to function SSP_SwitchNwkKey
        MOV       R1,#0x0
        LCALL     `??SSP_SwitchNwkKey::?relay`; Banked call to: SSP_SwitchNwkKey
// 1848 
// 1849         // clear local copy of key
// 1850         osal_memset(zgPreConfigKey, 0x00, SEC_KEY_LEN);
        ; Setup parameters for call to function osal_memset
        MOV       R4,#0x10
        MOV       R5,#0x0
        MOV       R1,#0x0
        MOV       A,#0x18
        LCALL     ?XSTACK_DISP101_8
        LCALL     `??osal_memset::?relay`; Banked call to: osal_memset
        SJMP      ??ZDSecMgrTransportKeyInd_7
// 1851       }
// 1852     }
// 1853     else
// 1854     {
// 1855       SSP_UpdateNwkKey( ind->key, ind->keySeqNum );
??ZDSecMgrTransportKeyInd_6:
        ; Setup parameters for call to function SSP_UpdateNwkKey
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       A,R6
        ADD       A,#0x6
        MOV       R2,A
        CLR       A
        ADDC      A,R7
        MOV       R3,A
        LCALL     `??SSP_UpdateNwkKey::?relay`; Banked call to: SSP_UpdateNwkKey
// 1856       if ( !_NIB.nwkKeyLoaded )
        MOV       DPTR,#_NIB + 61
        MOVX      A,@DPTR
        JNZ       ??ZDSecMgrTransportKeyInd_7
// 1857       {
// 1858         SSP_SwitchNwkKey( ind->keySeqNum );
        ; Setup parameters for call to function SSP_SwitchNwkKey
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        LCALL     `??SSP_SwitchNwkKey::?relay`; Banked call to: SSP_SwitchNwkKey
// 1859       }
// 1860     }
// 1861 
// 1862     // handle next step in authentication process
// 1863     ZDSecMgrAuthNwkKey();
??ZDSecMgrTransportKeyInd_7:
        ; Setup parameters for call to function ZDSecMgrAuthNwkKey
        LCALL     `??ZDSecMgrAuthNwkKey::?relay`; Banked call to: ZDSecMgrAuthNwkKey
        LJMP      ??ZDSecMgrTransportKeyInd_8 & 0xFFFF
// 1864   }
// 1865   else if ( ind->keyType == KEY_TYPE_TC_LINK )
??ZDSecMgrTransportKeyInd_3:
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        XRL       A,#0x4
        JZ        $+5
        LJMP      ??ZDSecMgrTransportKeyInd_9 & 0xFFFF
// 1866   {
// 1867     uint16 entryIndex;
// 1868     uint8 found;
// 1869     APSME_TCLKDevEntry_t TCLKDevEntry;
// 1870     
// 1871     //Search the entry, which should exist at this point
// 1872     entryIndex = APSME_SearchTCLinkKeyEntry(ind->srcExtAddr, &found, &TCLKDevEntry);
        ; Setup parameters for call to function APSME_SearchTCLinkKeyEntry
        MOV       A,#0x5
        LCALL     ?XSTACK_DISP100_8
        MOV       ?V4,R0
        MOV       ?V5,R1
        MOV       R0,#?V4
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 56)
        MOV       A,#0x2
        LCALL     ?XSTACK_DISP102_8
        MOV       A,R6
        ADD       A,#0x16
        MOV       R2,A
        CLR       A
        ADDC      A,R7
        MOV       R3,A
        LCALL     `??APSME_SearchTCLinkKeyEntry::?relay`; Banked call to: APSME_SearchTCLinkKeyEntry
        MOV       A,#0x2
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 54)
        MOV       ?V4,R2
        MOV       ?V5,R3
        MOV       ?V2,?V4
        MOV       ?V3,?V5
// 1873     
// 1874     if(found)
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOVX      A,@DPTR
        JNZ       $+5
        LJMP      ??ZDSecMgrTransportKeyInd_8 & 0xFFFF
// 1875     {
// 1876       //If the key was an IC, then erase the entry since that will not longer be used.
// 1877       if(TCLKDevEntry.keyAttributes == ZG_PROVISIONAL_KEY)
        MOV       A,#0x15
        LCALL     ?XSTACK_DISP0_8
        MOVX      A,@DPTR
        JNZ       ??ZDSecMgrTransportKeyInd_10
// 1878       {
// 1879         APSME_EraseICEntry(&TCLKDevEntry.SeedShift_IcIndex);
        ; Setup parameters for call to function APSME_EraseICEntry
        MOV       A,#0x17
        LCALL     ?XSTACK_DISP0_8
        MOV       R2,DPL
        MOV       R3,DPH
        LCALL     `??APSME_EraseICEntry::?relay`; Banked call to: APSME_EraseICEntry
// 1880       }
// 1881       
// 1882       TCLKDevEntry.keyAttributes = ZG_UNVERIFIED_KEY;
??ZDSecMgrTransportKeyInd_10:
        MOV       A,#0x15
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x1
        MOVX      @DPTR,A
// 1883       TCLKDevEntry.keyType = ZG_UNIQUE_LINK_KEY;
        MOV       A,#0x16
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x0
        MOVX      @DPTR,A
// 1884       TCLKDevEntry.rxFrmCntr = 0;
        MOV       A,#0x9
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
// 1885       TCLKDevEntry.txFrmCntr = 0;
        MOV       A,#0x5
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
// 1886       TCLKDevEntry.SeedShift_IcIndex = 0;
        MOV       A,#0x17
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x0
        MOVX      @DPTR,A
// 1887       
// 1888       //Update the entry
// 1889       osal_nv_write(entryIndex,0,sizeof(APSME_TCLKDevEntry_t),&TCLKDevEntry);
        ; Setup parameters for call to function osal_nv_write
        MOV       A,#0x5
        LCALL     ?XSTACK_DISP100_8
        MOV       ?V4,R0
        MOV       ?V5,R1
        MOV       R0,#?V4
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 56)
        MOV       ?V4,#0x13
        MOV       ?V5,#0x0
        MOV       R0,#?V4
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 58)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       R2,?V2
        MOV       R3,?V3
        LCALL     `??osal_nv_write::?relay`; Banked call to: osal_nv_write
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 54)
        MOV       A,R1
// 1890 
// 1891       //Create the entry for the key
// 1892       if(ZSUCCESS == osal_nv_item_init(ZCD_NV_TCLK_JOIN_DEV,SEC_KEY_LEN,ind->key) )
        ; Setup parameters for call to function osal_nv_item_init
        MOV       A,R6
        ADD       A,#0x6
        MOV       ?V4,A
        CLR       A
        ADDC      A,R7
        MOV       ?V5,A
        MOV       R0,#?V4
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 56)
        MOV       R4,#0x10
        MOV       R5,#0x0
        MOV       R2,#0x2
        MOV       R3,#0x1
        LCALL     `??osal_nv_item_init::?relay`; Banked call to: osal_nv_item_init
        MOV       A,#0x2
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 54)
        MOV       A,R1
        JNZ       ??ZDSecMgrTransportKeyInd_11
// 1893       {
// 1894         //Or replace it if already existed
// 1895         osal_nv_write(ZCD_NV_TCLK_JOIN_DEV,0,SEC_KEY_LEN,ind->key);
        ; Setup parameters for call to function osal_nv_write
        MOV       A,R6
        ADD       A,#0x6
        MOV       ?V4,A
        CLR       A
        ADDC      A,R7
        MOV       ?V5,A
        MOV       R0,#?V4
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 56)
        MOV       ?V4,#0x10
        MOV       ?V5,#0x0
        MOV       R0,#?V4
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 58)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       R2,#0x2
        MOV       R3,#0x1
        LCALL     `??osal_nv_write::?relay`; Banked call to: osal_nv_write
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 54)
        MOV       A,R1
// 1896       }
// 1897       
// 1898       bdb_tcLinkKeyExchangeAttempt(TRUE,BDB_REQ_VERIFY_TC_LINK_KEY);
??ZDSecMgrTransportKeyInd_11:
        ; Setup parameters for call to function bdb_tcLinkKeyExchangeAttempt
        MOV       R2,#0x3
        MOV       R1,#0x1
        LCALL     `??bdb_tcLinkKeyExchangeAttempt::?relay`; Banked call to: bdb_tcLinkKeyExchangeAttempt
        LJMP      ??ZDSecMgrTransportKeyInd_8 & 0xFFFF
// 1899     }
// 1900   }
// 1901   else if ( ind->keyType == KEY_TYPE_APP_LINK )
??ZDSecMgrTransportKeyInd_9:
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        XRL       A,#0x3
        JZ        $+5
        LJMP      ??ZDSecMgrTransportKeyInd_8 & 0xFFFF
// 1902   {
// 1903     if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_SE_STANDARD )
// 1904     {
// 1905       uint16           ami;
// 1906       ZDSecMgrEntry_t* entry;
// 1907 
// 1908       // get the address index
// 1909       if ( ZDSecMgrExtAddrLookup( ind->srcExtAddr, &ami ) != ZSuccess )
        ; Setup parameters for call to function ZDSecMgrExtAddrLookup
        MOV       A,#0x3
        LCALL     ?XSTACK_DISP102_8
        MOV       A,R6
        ADD       A,#0x16
        MOV       R2,A
        CLR       A
        ADDC      A,R7
        MOV       R3,A
        LCALL     `??ZDSecMgrExtAddrLookup::?relay`; Banked call to: ZDSecMgrExtAddrLookup
        MOV       A,R1
        JZ        ??ZDSecMgrTransportKeyInd_12
// 1910       {
// 1911         // store new EXT address
// 1912         ZDSecMgrAddrStore( INVALID_NODE_ADDR, ind->srcExtAddr, &ami );
        ; Setup parameters for call to function ZDSecMgrAddrStore
        MOV       A,#0x3
        LCALL     ?XSTACK_DISP100_8
        MOV       ?V2,R0
        MOV       ?V3,R1
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 56)
        MOV       A,R6
        ADD       A,#0x16
        MOV       R4,A
        CLR       A
        ADDC      A,R7
        MOV       R5,A
        MOV       R2,#-0x2
        MOV       R3,#-0x1
        LCALL     `??ZDSecMgrAddrStore::?relay`; Banked call to: ZDSecMgrAddrStore
        MOV       A,#0x2
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 54)
        MOV       A,R1
// 1913         ZDP_NwkAddrReq( ind->srcExtAddr, ZDP_ADDR_REQTYPE_SINGLE, 0, 0 );
        ; Setup parameters for call to function ZDP_NwkAddrReq
        MOV       R5,#0x0
        MOV       R4,#0x0
        MOV       R1,#0x0
        MOV       A,R6
        ADD       A,#0x16
        MOV       R2,A
        CLR       A
        ADDC      A,R7
        MOV       R3,A
        LCALL     `??ZDP_NwkAddrReq::?relay`; Banked call to: ZDP_NwkAddrReq
        MOV       A,R1
// 1914       }
// 1915 
// 1916       ZDSecMgrEntryLookupAMI( ami, &entry );
??ZDSecMgrTransportKeyInd_12:
        ; Setup parameters for call to function ZDSecMgrEntryLookupAMI
        MOV       A,#0x1
        LCALL     ?XSTACK_DISP102_8
        MOV       A,#0x3
        LCALL     ?XSTACK_DISP0_8
        MOVX      A,@DPTR
        MOV       R2,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R3,A
        LCALL     `??ZDSecMgrEntryLookupAMI::?relay`; Banked call to: ZDSecMgrEntryLookupAMI
        MOV       A,R1
// 1917 
// 1918       if ( entry == NULL )
        MOV       A,#0x1
        LCALL     ?XSTACK_DISP0_8
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       A,R0
        ORL       A,R1
        JNZ       ??ZDSecMgrTransportKeyInd_13
// 1919       {
// 1920         // get new entry
// 1921         if ( ZDSecMgrEntryNew( &entry ) == ZSuccess )
        ; Setup parameters for call to function ZDSecMgrEntryNew
        MOV       A,#0x1
        LCALL     ?XSTACK_DISP101_8
        LCALL     `??ZDSecMgrEntryNew::?relay`; Banked call to: ZDSecMgrEntryNew
        MOV       A,R1
        JNZ       ??ZDSecMgrTransportKeyInd_13
// 1922         {
// 1923           // finish setting up entry
// 1924           entry->ami = ami;
        MOV       A,#0x3
        LCALL     ?XSTACK_DISP0_8
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       A,#0x1
        LCALL     ?XSTACK_DISP0_8
        MOVX      A,@DPTR
        MOV       R2,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       DPH,A
        MOV       DPL,R2
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
// 1925         }
// 1926       }
// 1927 
// 1928       ZDSecMgrLinkKeySet( ind->srcExtAddr, ind->key );
??ZDSecMgrTransportKeyInd_13:
        ; Setup parameters for call to function APSME_LinkKeySet
        MOV       A,R6
        ADD       A,#0x6
        MOV       R4,A
        CLR       A
        ADDC      A,R7
        MOV       R5,A
        MOV       A,R6
        ADD       A,#0x16
        MOV       R2,A
        CLR       A
        ADDC      A,R7
        MOV       R3,A
        LCALL     `??APSME_LinkKeySet::?relay`; Banked call to: APSME_LinkKeySet
        MOV       A,R1
// 1929 
// 1930 #if defined NV_RESTORE
// 1931       ZDSecMgrWriteNV();  // Write the control record for the new established link key to NV.
        ; Setup parameters for call to function ZDSecMgrWriteNV
        LCALL     `??ZDSecMgrWriteNV::?relay`; Banked call to: ZDSecMgrWriteNV
// 1932 #endif
// 1933     }
// 1934   }
// 1935 }
??ZDSecMgrTransportKeyInd_8:
        MOV       A,#0x28
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 14)
        MOV       R7,#0x6
        LJMP      ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock34
// 1936 
// 1937 /******************************************************************************
// 1938  * @fn          ZDSecMgrUpdateDeviceInd
// 1939  *
// 1940  * @brief       Process the ZDO_UpdateDeviceInd_t message.
// 1941  *
// 1942  * @param       ind - [in] ZDO_UpdateDeviceInd_t indication
// 1943  *
// 1944  * @return      none
// 1945  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 1946 void ZDSecMgrUpdateDeviceInd( ZDO_UpdateDeviceInd_t* ind )
ZDSecMgrUpdateDeviceInd:
          CFI Block cfiBlock35 Using cfiCommon0
          CFI Function ZDSecMgrUpdateDeviceInd
        CODE
// 1947 {
        FUNCALL ZDSecMgrUpdateDeviceInd, ZDSecMgrDeviceJoin
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 17, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 17, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV       A,#-0x9
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 8
        MOV       A,#-0x8
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 17)
        MOV       A,R2
        MOV       R6,A
        MOV       A,R3
        MOV       R7,A
// 1948   ZDSecMgrDevice_t device;
// 1949 
// 1950   device.nwkAddr    = ind->devAddr;
        MOV       A,R6
        ADD       A,#0xc
        MOV       DPL,A
        CLR       A
        ADDC      A,R7
        MOV       DPH,A
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
// 1951   device.extAddr    = ind->devExtAddr;
        MOV       A,R6
        ADD       A,#0x4
        MOV       R0,A
        CLR       A
        ADDC      A,R7
        MOV       R1,A
        MOV       A,#0x2
        LCALL     ?XSTACK_DISP0_8
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
// 1952   device.parentAddr = ind->srcAddr;
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       A,#0x4
        LCALL     ?XSTACK_DISP0_8
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
// 1953   device.devStatus  = DEV_SEC_INIT_STATUS;
        MOV       A,#0x7
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x4
        MOVX      @DPTR,A
// 1954   device.secure     = FALSE;
        MOV       A,#0x6
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x0
        MOVX      @DPTR,A
// 1955 
// 1956   // Trust Center should identify the type of JOIN/REJOIN and
// 1957   // Transport the NWK key accordingly, it will only be transported for:
// 1958   //              APSME_UD_STANDARD_UNSECURED_JOIN
// 1959   //   OR         APSME_UD_STANDARD_TRUST_CENTER_REJOIN
// 1960   if ( ind->status != APSME_UD_DEVICE_LEFT )
        MOV       A,R6
        ADD       A,#0xe
        MOV       DPL,A
        CLR       A
        ADDC      A,R7
        MOV       DPH,A
        MOVX      A,@DPTR
        XRL       A,#0x2
        JZ        ??ZDSecMgrUpdateDeviceInd_0
// 1961   {
// 1962     if ( ind->status == APSME_UD_STANDARD_SECURED_REJOIN )
        MOV       A,R6
        ADD       A,#0xe
        MOV       DPL,A
        CLR       A
        ADDC      A,R7
        MOV       DPH,A
        MOVX      A,@DPTR
        JNZ       ??ZDSecMgrUpdateDeviceInd_1
// 1963     {
// 1964       device.devStatus &= ~DEV_SEC_INIT_STATUS;
        MOV       A,#0x7
        LCALL     ?XSTACK_DISP0_8
        MOVX      A,@DPTR
        CLR       0xE0 /* A   */.2
        MOVX      @DPTR,A
// 1965       device.devStatus |=  DEV_SEC_AUTH_STATUS;
        MOV       A,#0x7
        LCALL     ?XSTACK_DISP0_8
        MOVX      A,@DPTR
        SETB      0xE0 /* A   */.3
        MOVX      @DPTR,A
// 1966       device.secure = TRUE;
        MOV       A,#0x6
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x1
        MOVX      @DPTR,A
// 1967     }
// 1968     else
// 1969     {
// 1970 #if (ZG_BUILD_COORDINATOR_TYPE)
// 1971       uint8  found;
// 1972       uint16 keyNvIndex;
// 1973       APSME_TCLKDevEntry_t TCLKDevEntry;
// 1974       
// 1975       keyNvIndex = APSME_SearchTCLinkKeyEntry(device.extAddr,&found, &TCLKDevEntry);
// 1976       
// 1977       //If found and it was verified, then allow it to join in a fresh state by erasing the key entry
// 1978       if((found == TRUE) && (TCLKDevEntry.keyAttributes == ZG_VERIFIED_KEY))
// 1979       {
// 1980         TCLKDevEntry.keyAttributes = ZG_DEFAULT_KEY;
// 1981         //Increase the shift by one. Validate the maximum shift of the seed which is 15
// 1982         TCLKDevEntry.SeedShift_IcIndex++;
// 1983         TCLKDevEntry.SeedShift_IcIndex &= 0x0F;
// 1984         
// 1985         TCLKDevEntry.rxFrmCntr = 0;
// 1986         TCLKDevEntry.txFrmCntr = 0;  
// 1987         
// 1988         //Update the entry
// 1989         osal_nv_write(keyNvIndex,0,sizeof(APSME_TCLKDevEntry_t), &TCLKDevEntry );
// 1990       }
// 1991       
// 1992       bdb_TCAddJoiningDevice(device.parentAddr,device.extAddr);
// 1993 #endif
// 1994     
// 1995     }
// 1996 
// 1997     ZDSecMgrDeviceJoin( &device );
??ZDSecMgrUpdateDeviceInd_1:
        ; Setup parameters for call to function ZDSecMgrDeviceJoin
        MOV       R2,?XSP + 0
        MOV       R3,?XSP + 1
        LCALL     `??ZDSecMgrDeviceJoin::?relay`; Banked call to: ZDSecMgrDeviceJoin
        MOV       A,R1
// 1998   }
// 1999 }
??ZDSecMgrUpdateDeviceInd_0:
        MOV       A,#0x8
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 9)
        MOV       R7,#0x1
        LJMP      ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock35
// 2000 
// 2001 /******************************************************************************
// 2002  * @fn          ZDSecMgrRemoveDeviceInd
// 2003  *
// 2004  * @brief       Process the ZDO_RemoveDeviceInd_t message.
// 2005  *
// 2006  * @param       ind - [in] ZDO_RemoveDeviceInd_t indication
// 2007  *
// 2008  * @return      none
// 2009  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 2010 void ZDSecMgrRemoveDeviceInd( ZDO_RemoveDeviceInd_t* ind )
ZDSecMgrRemoveDeviceInd:
          CFI Block cfiBlock36 Using cfiCommon0
          CFI Function ZDSecMgrRemoveDeviceInd
        CODE
// 2011 {
        FUNCALL ZDSecMgrRemoveDeviceInd, APSME_LookupNwkAddr
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 17, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 17, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrRemoveDeviceInd, NLME_GetShortAddr
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 17, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 17, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrRemoveDeviceInd, ZDSecMgrDeviceRemove
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 17, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 17, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV       A,#-0x9
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 8
        MOV       A,#-0x8
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 17)
        MOV       A,R2
        MOV       R6,A
        MOV       A,R3
        MOV       R7,A
// 2012   ZDSecMgrDevice_t device;
// 2013 
// 2014   // only accept from Trust Center
// 2015   if ( ind->srcAddr == APSME_TRUSTCENTER_NWKADDR )
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       A,R0
        ORL       A,R1
        JNZ       ??ZDSecMgrRemoveDeviceInd_0
// 2016   {
// 2017     // look up NWK address
// 2018     if ( APSME_LookupNwkAddr( ind->childExtAddr, &device.nwkAddr ) == TRUE )
        ; Setup parameters for call to function APSME_LookupNwkAddr
        MOV       R4,?XSP + 0
        MOV       R5,?XSP + 1
        MOV       A,R6
        ADD       A,#0x4
        MOV       R2,A
        CLR       A
        ADDC      A,R7
        MOV       R3,A
        LCALL     `??APSME_LookupNwkAddr::?relay`; Banked call to: APSME_LookupNwkAddr
        MOV       A,R1
        XRL       A,#0x1
        JNZ       ??ZDSecMgrRemoveDeviceInd_0
// 2019     {
// 2020       device.parentAddr = NLME_GetShortAddr();
        ; Setup parameters for call to function NLME_GetShortAddr
        LCALL     `??NLME_GetShortAddr::?relay`; Banked call to: NLME_GetShortAddr
        MOV       A,#0x4
        LCALL     ?XSTACK_DISP0_8
        MOV       A,R2
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R3
        MOVX      @DPTR,A
// 2021       device.extAddr    = ind->childExtAddr;
        MOV       A,R6
        ADD       A,#0x4
        MOV       R0,A
        CLR       A
        ADDC      A,R7
        MOV       R1,A
        MOV       A,#0x2
        LCALL     ?XSTACK_DISP0_8
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
// 2022 
// 2023       // remove device
// 2024       ZDSecMgrDeviceRemove( &device );
        ; Setup parameters for call to function ZDSecMgrDeviceRemove
        MOV       R2,?XSP + 0
        MOV       R3,?XSP + 1
        LCALL     `??ZDSecMgrDeviceRemove::?relay`; Banked call to: ZDSecMgrDeviceRemove
// 2025     }
// 2026   }
// 2027 }
??ZDSecMgrRemoveDeviceInd_0:
        MOV       A,#0x8
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 9)
        MOV       R7,#0x1
        LJMP      ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock36
// 2028 
// 2029 /******************************************************************************
// 2030  * @fn          ZDSecMgrRequestKeyInd
// 2031  *
// 2032  * @brief       Process the ZDO_RequestKeyInd_t message.
// 2033  *
// 2034  * @param       ind - [in] ZDO_RequestKeyInd_t indication
// 2035  *
// 2036  * @return      none
// 2037  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 2038 void ZDSecMgrRequestKeyInd( ZDO_RequestKeyInd_t* ind )
ZDSecMgrRequestKeyInd:
          CFI Block cfiBlock37 Using cfiCommon0
          CFI Function ZDSecMgrRequestKeyInd
        CODE
// 2039 {
        FUNCALL ZDSecMgrRequestKeyInd, ZDSecMgrAppKeyReq
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrRequestKeyInd, ZDSecMgrTclkReq
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV       A,#-0x9
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
        MOV       A,R2
        MOV       R6,A
        MOV       A,R3
        MOV       R7,A
// 2040   if ( ind->keyType == KEY_TYPE_NWK )
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        XRL       A,#0x1
        JZ        ??ZDSecMgrRequestKeyInd_0
// 2041   {
// 2042   }
// 2043   else if ( ind->keyType == KEY_TYPE_APP_MASTER )
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        XRL       A,#0x2
        JNZ       ??ZDSecMgrRequestKeyInd_1
// 2044   {
// 2045     ZDSecMgrAppKeyReq( ind );
        ; Setup parameters for call to function ZDSecMgrAppKeyReq
        MOV       A,R6
        MOV       R2,A
        MOV       A,R7
        MOV       R3,A
        LCALL     `??ZDSecMgrAppKeyReq::?relay`; Banked call to: ZDSecMgrAppKeyReq
        SJMP      ??ZDSecMgrRequestKeyInd_0
// 2046   }
// 2047   else if ( ind->keyType == KEY_TYPE_TC_LINK )
??ZDSecMgrRequestKeyInd_1:
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        XRL       A,#0x4
        JNZ       ??ZDSecMgrRequestKeyInd_0
// 2048   {
// 2049     ZDSecMgrTclkReq( ind );
        ; Setup parameters for call to function ZDSecMgrTclkReq
        MOV       A,R6
        MOV       R2,A
        MOV       A,R7
        MOV       R3,A
        LCALL     `??ZDSecMgrTclkReq::?relay`; Banked call to: ZDSecMgrTclkReq
// 2050   }
// 2051   //else ignore
// 2052 }
??ZDSecMgrRequestKeyInd_0:
        MOV       R7,#0x1
        LJMP      ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock37
// 2053 
// 2054 
// 2055 /******************************************************************************
// 2056  * @fn          ZDSecMgrVerifyKeyInd
// 2057  *
// 2058  * @brief       Process the ZDO_VerifyKeyInd_t message.
// 2059  *
// 2060  * @param       ind - [in] ZDO_VerifyKeyInd_t indication
// 2061  *
// 2062  * @return      none
// 2063  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 2064 void ZDSecMgrVerifyKeyInd( ZDO_VerifyKeyInd_t* ind )
ZDSecMgrVerifyKeyInd:
          CFI Block cfiBlock38 Using cfiCommon0
          CFI Function ZDSecMgrVerifyKeyInd
        CODE
// 2065 {
        FUNCALL ZDSecMgrVerifyKeyInd, ZDSecMgrAppConfKeyReq
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV       A,#-0x9
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
        MOV       A,R2
        MOV       R6,A
        MOV       A,R3
        MOV       R7,A
// 2066   ZDSecMgrAppConfKeyReq( ind );
        ; Setup parameters for call to function ZDSecMgrAppConfKeyReq
        MOV       A,R6
        MOV       R2,A
        MOV       A,R7
        MOV       R3,A
        LCALL     `??ZDSecMgrAppConfKeyReq::?relay`; Banked call to: ZDSecMgrAppConfKeyReq
// 2067 }
        MOV       R7,#0x1
        LJMP      ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock38
// 2068 
// 2069 
// 2070 /******************************************************************************
// 2071  * @fn          ZDSecMgrSwitchKeyInd
// 2072  *
// 2073  * @brief       Process the ZDO_SwitchKeyInd_t message.
// 2074  *
// 2075  * @param       ind - [in] ZDO_SwitchKeyInd_t indication
// 2076  *
// 2077  * @return      none
// 2078  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 2079 void ZDSecMgrSwitchKeyInd( ZDO_SwitchKeyInd_t* ind )
ZDSecMgrSwitchKeyInd:
          CFI Block cfiBlock39 Using cfiCommon0
          CFI Function ZDSecMgrSwitchKeyInd
        CODE
// 2080 {
        FUNCALL ZDSecMgrSwitchKeyInd, SSP_SwitchNwkKey
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSwitchKeyInd, ZDApp_NVUpdate
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV       A,#-0x9
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
        MOV       A,R2
        MOV       R6,A
        MOV       A,R3
        MOV       R7,A
// 2081   SSP_SwitchNwkKey( ind->keySeqNum );
        ; Setup parameters for call to function SSP_SwitchNwkKey
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        LCALL     `??SSP_SwitchNwkKey::?relay`; Banked call to: SSP_SwitchNwkKey
// 2082 
// 2083   // Save if nv
// 2084   ZDApp_NVUpdate();
        ; Setup parameters for call to function ZDApp_NVUpdate
        LCALL     `??ZDApp_NVUpdate::?relay`; Banked call to: ZDApp_NVUpdate
// 2085 }
        MOV       R7,#0x1
        LJMP      ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock39
// 2086   
// 2087 /******************************************************************************
// 2088  * @fn          ZDSecMgrGenerateSeed
// 2089  *
// 2090  * @brief       Generate the seed for TC link keys and store it in Nv
// 2091  *
// 2092  * @param       SetDefault, force to use new seed
// 2093  *
// 2094  * @return      none
// 2095  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 2096 void ZDSecMgrGenerateSeed(uint8 SetDefault)
ZDSecMgrGenerateSeed:
          CFI Block cfiBlock40 Using cfiCommon0
          CFI Function ZDSecMgrGenerateSeed
        CODE
// 2097 {
        FUNCALL ZDSecMgrGenerateSeed, ZDSecMgrGenerateRndKey
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 26, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 26, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrGenerateSeed, osal_nv_item_init
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 28, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 28, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrGenerateSeed, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 30, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 30, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrGenerateSeed, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 26, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 26, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        MOV       A,#-0xa
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 10)
        ; Saved register size: 10
        ; Auto size: 16
        MOV       A,#-0x10
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 26)
        MOV       A,R1
        MOV       R6,A
// 2098   uint8 SeedKey[SEC_KEY_LEN];  
// 2099   
// 2100   ZDSecMgrGenerateRndKey(SeedKey);
        ; Setup parameters for call to function ZDSecMgrGenerateRndKey
        MOV       R2,?XSP + 0
        MOV       R3,?XSP + 1
        LCALL     `??ZDSecMgrGenerateRndKey::?relay`; Banked call to: ZDSecMgrGenerateRndKey
// 2101   
// 2102   if((SUCCESS == osal_nv_item_init(ZCD_NV_TCLK_SEED,SEC_KEY_LEN,SeedKey)) && SetDefault)
        ; Setup parameters for call to function osal_nv_item_init
        MOV       R0,?XSP + 0
        MOV       R1,?XSP + 1
        MOV       ?V0,R0
        MOV       ?V1,R1
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 28)
        MOV       R4,#0x10
        MOV       R5,#0x0
        MOV       R2,#0x1
        MOV       R3,#0x1
        LCALL     `??osal_nv_item_init::?relay`; Banked call to: osal_nv_item_init
        MOV       A,#0x2
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 26)
        MOV       A,R1
        JNZ       ??ZDSecMgrGenerateSeed_0
        MOV       A,R6
        JZ        ??ZDSecMgrGenerateSeed_0
// 2103   {
// 2104     //Force to use a new seed
// 2105     osal_nv_write(ZCD_NV_TCLK_SEED,0,SEC_KEY_LEN,SeedKey);
        ; Setup parameters for call to function osal_nv_write
        MOV       R0,?XSP + 0
        MOV       R1,?XSP + 1
        MOV       ?V0,R0
        MOV       ?V1,R1
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 28)
        MOV       ?V0,#0x10
        MOV       ?V1,#0x0
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 30)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       R2,#0x1
        MOV       R3,#0x1
        LCALL     `??osal_nv_write::?relay`; Banked call to: osal_nv_write
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 26)
        MOV       A,R1
// 2106   }
// 2107 
// 2108   osal_memset(SeedKey,0,SEC_KEY_LEN);
??ZDSecMgrGenerateSeed_0:
        ; Setup parameters for call to function osal_memset
        MOV       R4,#0x10
        MOV       R5,#0x0
        MOV       R1,#0x0
        MOV       R2,?XSP + 0
        MOV       R3,?XSP + 1
        LCALL     `??osal_memset::?relay`; Banked call to: osal_memset
// 2109 }
        MOV       A,#0x10
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 10)
        MOV       R7,#0x2
        LJMP      ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock40
// 2110 
// 2111 
// 2112 /******************************************************************************
// 2113  * @fn          ZDSecMgrGenerateKeyFromSeed
// 2114  *
// 2115  * @brief       Generate the TC link key for an specific device usign seed and ExtAddr
// 2116  *
// 2117  * @param       [in]  extAddr  
// 2118  * @param       [in]  shift    number of byte shifts that the seed will do to 
// 2119  *                             generate a new key for the same device. 
// 2120  *                             This value must be less than SEC_KEY_LEN
// 2121  * @param       [out] key      buffer in which the key will be copied
// 2122  *
// 2123  * @return      none
// 2124  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 2125 void ZDSecMgrGenerateKeyFromSeed(uint8 *extAddr, uint8 shift, uint8 *key)
ZDSecMgrGenerateKeyFromSeed:
          CFI Block cfiBlock41 Using cfiCommon0
          CFI Function ZDSecMgrGenerateKeyFromSeed
        CODE
// 2126 {
        FUNCALL ZDSecMgrGenerateKeyFromSeed, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 36, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 36, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrGenerateKeyFromSeed, osal_memcpy
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 35, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 35, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrGenerateKeyFromSeed, osal_memcpy
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 35, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 35, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        REQUIRE ?V2
        REQUIRE ?V3
        REQUIRE ?V4
        REQUIRE ?V6
        REQUIRE ?V7
        MOV       A,#-0x10
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 16)
        ; Saved register size: 16
        ; Auto size: 16
        MOV       A,#-0x10
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 32)
        MOV       ?V6,R2
        MOV       ?V7,R3
        MOV       ?V4,R1
        MOV       A,R4
        MOV       R6,A
        MOV       A,R5
        MOV       R7,A
// 2127   uint8 i;
// 2128   uint8 tempKey[SEC_KEY_LEN];
// 2129   
// 2130   if((key != NULL) && (extAddr != NULL))
        MOV       A,R6
        ORL       A,R7
        JNZ       $+5
        LJMP      ??ZDSecMgrGenerateKeyFromSeed_0 & 0xFFFF
        MOV       A,?V6
        ORL       A,?V7
        JNZ       $+5
        LJMP      ??ZDSecMgrGenerateKeyFromSeed_0 & 0xFFFF
// 2131   {
// 2132     //Read the key
// 2133     osal_nv_read(ZCD_NV_TCLK_SEED,0,SEC_KEY_LEN,tempKey);
        ; Setup parameters for call to function osal_nv_read
        MOV       R0,?XSP + 0
        MOV       R1,?XSP + 1
        MOV       ?V0,R0
        MOV       ?V1,R1
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 34)
        MOV       ?V0,#0x10
        MOV       ?V1,#0x0
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 36)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       R2,#0x1
        MOV       R3,#0x1
        LCALL     `??osal_nv_read::?relay`; Banked call to: osal_nv_read
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 32)
        MOV       A,R1
// 2134 
// 2135     //shift the seed
// 2136     osal_memcpy(key, &tempKey[shift], SEC_KEY_LEN - shift);
        ; Setup parameters for call to function osal_memcpy
        MOV       A,?V4
        MOV       R0,A
        MOV       R1,#0x0
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOV       A,DPL
        ADD       A,R0
        MOV       ?V0,A
        MOV       A,DPH
        ADDC      A,R1
        MOV       ?V1,A
        MOV       ?V2,#0x0
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_THREE
          CFI CFA_XSP16 add(XSP16, 35)
        MOV       A,?V4
        MOV       R0,A
        MOV       R1,#0x0
        MOV       A,#0x10
        CLR       C
        SUBB      A,R0
        MOV       R4,A
        MOV       A,#0x0
        SUBB      A,R1
        MOV       R5,A
        MOV       A,R6
        MOV       R2,A
        MOV       A,R7
        MOV       R3,A
        LCALL     `??osal_memcpy::?relay`; Banked call to: osal_memcpy
        MOV       A,#0x3
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 32)
// 2137     osal_memcpy(&key[SEC_KEY_LEN - shift], tempKey, shift);
        ; Setup parameters for call to function osal_memcpy
        MOV       R0,?XSP + 0
        MOV       R1,?XSP + 1
        MOV       ?V0,R0
        MOV       ?V1,R1
        MOV       ?V2,#0x0
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_THREE
          CFI CFA_XSP16 add(XSP16, 35)
        MOV       A,?V4
        MOV       R4,A
        MOV       R5,#0x0
        MOV       A,?V4
        MOV       R0,A
        MOV       R1,#0x0
        CLR       C
        CLR       A
        SUBB      A,R0
        MOV       R0,A
        CLR       A
        SUBB      A,R1
        MOV       R1,A
        MOV       A,R6
        ADD       A,R0
        MOV       R0,A
        MOV       A,R7
        ADDC      A,R1
        MOV       R1,A
        MOV       A,R0
        ADD       A,#0x10
        MOV       R2,A
        CLR       A
        ADDC      A,R1
        MOV       R3,A
        LCALL     `??osal_memcpy::?relay`; Banked call to: osal_memcpy
        MOV       A,#0x3
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 32)
// 2138    
// 2139     //Create the key from the seed
// 2140     for(i = 0; i < Z_EXTADDR_LEN; i++)
        MOV       ?V3,#0x0
??ZDSecMgrGenerateKeyFromSeed_1:
        MOV       A,?V3
        CLR       C
        SUBB      A,#0x8
        JNC       ??ZDSecMgrGenerateKeyFromSeed_0
// 2141     {
// 2142       key[i] ^= extAddr[i];
        MOV       A,?V3
        MOV       R0,A
        MOV       R1,#0x0
        MOV       A,?V6
        ADD       A,R0
        MOV       DPL,A
        MOV       A,?V7
        ADDC      A,R1
        MOV       DPH,A
        MOVX      A,@DPTR
        MOV       R2,A
        MOV       A,?V3
        MOV       R0,A
        MOV       R1,#0x0
        MOV       A,R6
        ADD       A,R0
        MOV       DPL,A
        MOV       A,R7
        ADDC      A,R1
        MOV       DPH,A
        MOVX      A,@DPTR
        XRL       A,R2
        MOVX      @DPTR,A
// 2143       key[i+Z_EXTADDR_LEN] ^= extAddr[i];
        MOV       A,?V3
        MOV       R0,A
        MOV       R1,#0x0
        MOV       A,?V6
        ADD       A,R0
        MOV       DPL,A
        MOV       A,?V7
        ADDC      A,R1
        MOV       DPH,A
        MOVX      A,@DPTR
        MOV       R2,A
        MOV       A,?V3
        MOV       R0,A
        MOV       R1,#0x0
        MOV       A,R6
        ADD       A,R0
        MOV       DPL,A
        MOV       A,R7
        ADDC      A,R1
        MOV       DPH,A
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        XRL       A,R2
        MOVX      @DPTR,A
// 2144     }
        INC       ?V3
        SJMP      ??ZDSecMgrGenerateKeyFromSeed_1
// 2145   }
// 2146 }
??ZDSecMgrGenerateKeyFromSeed_0:
        MOV       A,#0x10
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 16)
        MOV       R7,#0x8
        LJMP      ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock41
// 2147 
// 2148 
// 2149 /******************************************************************************
// 2150  * @fn          ZDSecMgrGenerateRndKey
// 2151  *
// 2152 * @brief       Generate a random key. NOTE: Random key is generated by osal_rand, refer to osal_rand to see the random properties of the key generated by this mean.
// 2153  *
// 2154  * @param       pKey - [out] Buffer pointer in which the key will be passed.
// 2155  *
// 2156  * @return      none
// 2157  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 2158 void ZDSecMgrGenerateRndKey(uint8* pKey)
ZDSecMgrGenerateRndKey:
          CFI Block cfiBlock42 Using cfiCommon0
          CFI Function ZDSecMgrGenerateRndKey
        CODE
// 2159 {
        FUNCALL ZDSecMgrGenerateRndKey, osal_rand
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        REQUIRE ?V2
        REQUIRE ?V4
        REQUIRE ?V5
        MOV       A,#-0xe
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 14)
        ; Saved register size: 14
        ; Auto size: 0
        MOV       A,R2
        MOV       R6,A
        MOV       A,R3
        MOV       R7,A
// 2160   uint16  temp;
// 2161   uint8   index = 0;
        MOV       ?V2,#0x0
// 2162   
// 2163   while(index < (SEC_KEY_LEN/2))
??ZDSecMgrGenerateRndKey_0:
        MOV       A,?V2
        CLR       C
        SUBB      A,#0x8
        JNC       ??ZDSecMgrGenerateRndKey_1
// 2164   {
// 2165     temp = osal_rand();
        ; Setup parameters for call to function osal_rand
        LCALL     `??osal_rand::?relay`; Banked call to: osal_rand
        MOV       ?V4,R2
        MOV       ?V5,R3
        MOV       ?V0,?V4
        MOV       ?V1,?V5
// 2166     pKey[index*2]   = (uint8) (temp & 0x00FF);
        MOV       A,?V0
        PUSH      A
          CFI CFA_SP SP+-1
        MOV       A,?V2
        MOV       R0,A
        MOV       R1,#0x0
        MOV       A,R0
        MOV       B,#0x2
        MUL       AB
        XCH       A,R0
        MOV       R2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R2
        MOV       R2,A
        MOV       B,#0x2
        MOV       A,R1
        MUL       AB
        ADD       A,R2
        MOV       R1,A
        MOV       A,R6
        ADD       A,R0
        MOV       DPL,A
        MOV       A,R7
        ADDC      A,R1
        MOV       DPH,A
        POP       A
          CFI CFA_SP SP+0
        MOVX      @DPTR,A
// 2167     pKey[index*2+1] = (uint8) ((temp >> 8) & 0x00FF);
        MOV       R0,?V0
        MOV       R1,?V1
        CLR       A
        XCH       A,R1
        MOV       R0,A
        MOV       A,R0
        PUSH      A
          CFI CFA_SP SP+-1
        MOV       A,?V2
        MOV       R0,A
        MOV       R1,#0x0
        MOV       A,R0
        MOV       B,#0x2
        MUL       AB
        XCH       A,R0
        MOV       R2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R2
        MOV       R2,A
        MOV       B,#0x2
        MOV       A,R1
        MUL       AB
        ADD       A,R2
        MOV       R1,A
        MOV       A,R6
        ADD       A,R0
        MOV       DPL,A
        MOV       A,R7
        ADDC      A,R1
        MOV       DPH,A
        INC       DPTR
        POP       A
          CFI CFA_SP SP+0
        MOVX      @DPTR,A
// 2168     index++;
        INC       ?V2
        SJMP      ??ZDSecMgrGenerateRndKey_0
// 2169   }
// 2170 }
??ZDSecMgrGenerateRndKey_1:
        MOV       R7,#0x6
        LJMP      ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock42
// 2171 
// 2172 
// 2173 #if ( ZG_BUILD_COORDINATOR_TYPE )
// 2174 /******************************************************************************
// 2175  * @fn          ZDSecMgrUpdateNwkKey
// 2176  *
// 2177  * @brief       Load a new NWK key and trigger a network update to the dstAddr.
// 2178  *
// 2179  * @param       key       - [in] new NWK key
// 2180  * @param       keySeqNum - [in] new NWK key sequence number
// 2181  *
// 2182  * @return      ZStatus_t
// 2183  */
// 2184 ZStatus_t ZDSecMgrUpdateNwkKey( uint8* key, uint8 keySeqNum, uint16 dstAddr )
// 2185 {
// 2186   ZStatus_t               status;
// 2187   APSME_TransportKeyReq_t req;
// 2188 
// 2189   // initialize common elements of local variables
// 2190   req.keyType   = KEY_TYPE_NWK;
// 2191 
// 2192   req.dstAddr   = dstAddr;
// 2193   req.keySeqNum = keySeqNum;
// 2194   req.key       = key;
// 2195   req.extAddr   = NULL;
// 2196   req.nwkSecure = TRUE;
// 2197   req.tunnel    = NULL;
// 2198 
// 2199   if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_SE_STANDARD )
// 2200   {
// 2201     // Broadcast transport NWK key
// 2202     if (( dstAddr == NWK_BROADCAST_SHORTADDR_DEVALL ) ||
// 2203         ( dstAddr == NWK_BROADCAST_SHORTADDR_DEVZCZR) ||
// 2204         ( dstAddr == NWK_BROADCAST_SHORTADDR_DEVRXON))
// 2205     {
// 2206       req.apsSecure = FALSE;
// 2207       status = APSME_TransportKeyReq( &req );
// 2208     }
// 2209     else
// 2210     {
// 2211       AddrMgrEntry_t          addrEntry;
// 2212 
// 2213       addrEntry.user = ADDRMGR_USER_SECURITY;
// 2214       addrEntry.nwkAddr = dstAddr;
// 2215 
// 2216       status = ZFailure;
// 2217 
// 2218       if ( AddrMgrEntryLookupNwk( &addrEntry ) == TRUE )
// 2219       {
// 2220         req.extAddr = addrEntry.extAddr;
// 2221         req.apsSecure = TRUE;
// 2222         status = APSME_TransportKeyReq( &req );
// 2223       }
// 2224     }
// 2225   }
// 2226   else // ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_RESIDENTIAL )
// 2227   {
// 2228     req.apsSecure = FALSE;
// 2229     status = APSME_TransportKeyReq( &req );
// 2230   }
// 2231 
// 2232   SSP_UpdateNwkKey( key, keySeqNum );
// 2233 
// 2234   // Save if nv
// 2235   ZDApp_NVUpdate();
// 2236 
// 2237   return status;
// 2238 }
// 2239 #endif // ( ZG_BUILD_COORDINATOR_TYPE )
// 2240 
// 2241 #if ( ZG_BUILD_COORDINATOR_TYPE )
// 2242 /******************************************************************************
// 2243  * @fn          ZDSecMgrSwitchNwkKey
// 2244  *
// 2245  * @brief       Causes the NWK key to switch via a network command to the dstAddr.
// 2246  *
// 2247  * @param       keySeqNum - [in] new NWK key sequence number
// 2248  *
// 2249  * @return      ZStatus_t
// 2250  */
// 2251 ZStatus_t ZDSecMgrSwitchNwkKey( uint8 keySeqNum, uint16 dstAddr )
// 2252 {
// 2253   ZStatus_t            status;
// 2254   APSME_SwitchKeyReq_t req;
// 2255 
// 2256   // initialize common elements of local variables
// 2257   req.dstAddr = dstAddr;
// 2258   req.keySeqNum = keySeqNum;
// 2259 
// 2260   if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_SE_STANDARD )
// 2261   {
// 2262     // Broadcast switch NWK key
// 2263     if (( dstAddr == NWK_BROADCAST_SHORTADDR_DEVALL ) ||
// 2264         ( dstAddr == NWK_BROADCAST_SHORTADDR_DEVZCZR) ||
// 2265         ( dstAddr == NWK_BROADCAST_SHORTADDR_DEVRXON))
// 2266     {
// 2267       req.apsSecure = FALSE;
// 2268       status = APSME_SwitchKeyReq( &req );
// 2269     }
// 2270     else
// 2271     {
// 2272       AddrMgrEntry_t          addrEntry;
// 2273 
// 2274       addrEntry.user = ADDRMGR_USER_SECURITY;
// 2275       addrEntry.nwkAddr = dstAddr;
// 2276 
// 2277       status = ZFailure;
// 2278 
// 2279       if ( AddrMgrEntryLookupNwk( &addrEntry ) == TRUE )
// 2280       {
// 2281         req.dstAddr = addrEntry.nwkAddr;
// 2282         req.apsSecure = TRUE;
// 2283         status = APSME_SwitchKeyReq( &req );
// 2284       }
// 2285     }
// 2286   }
// 2287   else // ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_RESIDENTIAL )
// 2288   {
// 2289     req.apsSecure = FALSE;
// 2290     status = APSME_SwitchKeyReq( &req );
// 2291   }
// 2292 
// 2293   if ( dstAddr >= NWK_BROADCAST_SHORTADDR_DEVZCZR)
// 2294   {
// 2295     zgSwitchCoordKey = TRUE;
// 2296     zgSwitchCoordKeyIndex = keySeqNum;
// 2297   }
// 2298   // Save if nv
// 2299   ZDApp_NVUpdate();
// 2300 
// 2301   return status;
// 2302 }
// 2303 #endif // ( ZG_BUILD_COORDINATOR_TYPE )
// 2304 
// 2305 /******************************************************************************
// 2306  * @fn          ZDSecMgrRequestAppKey
// 2307  *
// 2308  * @brief       Request an application key with partner.
// 2309  *
// 2310  * @param       partExtAddr - [in] partner extended address
// 2311  *
// 2312  * @return      ZStatus_t
// 2313  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 2314 ZStatus_t ZDSecMgrRequestAppKey( uint8 *partExtAddr )
ZDSecMgrRequestAppKey:
          CFI Block cfiBlock43 Using cfiCommon0
          CFI Function ZDSecMgrRequestAppKey
        CODE
// 2315 {
        FUNCALL ZDSecMgrRequestAppKey, APSME_RequestKeyReq
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 13, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 13, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        MOV       A,#-0x9
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 4
        MOV       A,#-0x4
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 13)
        MOV       A,R2
        MOV       R6,A
        MOV       A,R3
        MOV       R7,A
// 2316   ZStatus_t status;
// 2317   APSME_RequestKeyReq_t req;
// 2318 
// 2319   req.dstAddr = 0;
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOV       A,#0x0
        MOVX      @DPTR,A
// 2320   req.keyType = KEY_TYPE_APP_MASTER;
        MOV       A,#0x1
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x2
        MOVX      @DPTR,A
// 2321 
// 2322   req.partExtAddr = partExtAddr;
        MOV       A,#0x2
        LCALL     ?XSTACK_DISP0_8
        MOV       A,R6
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R7
        MOVX      @DPTR,A
// 2323   status = APSME_RequestKeyReq( &req );
        ; Setup parameters for call to function APSME_RequestKeyReq
        MOV       R2,?XSP + 0
        MOV       R3,?XSP + 1
        LCALL     `??APSME_RequestKeyReq::?relay`; Banked call to: APSME_RequestKeyReq
        MOV       A,R1
        MOV       ?V0,A
// 2324 
// 2325   return status;
        MOV       R1,?V0
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 9)
        MOV       R7,#0x1
        LJMP      ?BANKED_LEAVE_XDATA
// 2326 }
          CFI EndBlock cfiBlock43
// 2327 
// 2328 #if ( ZG_BUILD_JOINING_TYPE )
// 2329 /******************************************************************************
// 2330  * @fn          ZDSecMgrSetupPartner
// 2331  *
// 2332  * @brief       Setup for application key partner.
// 2333  *
// 2334  * @param       partNwkAddr - [in] partner network address
// 2335  *
// 2336  * @return      ZStatus_t
// 2337  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 2338 ZStatus_t ZDSecMgrSetupPartner( uint16 partNwkAddr, uint8* partExtAddr )
ZDSecMgrSetupPartner:
          CFI Block cfiBlock44 Using cfiCommon0
          CFI Function ZDSecMgrSetupPartner
        CODE
// 2339 {
        FUNCALL ZDSecMgrSetupPartner, AddrMgrExtAddrSet
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 25, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 25, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSetupPartner, AddrMgrEntryUpdate
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 25, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 25, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSetupPartner, ZDP_NwkAddrReq
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 25, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 25, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSetupPartner, AddrMgrExtAddrValid
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 25, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 25, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSetupPartner, ZDP_IEEEAddrReq
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 25, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 25, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        REQUIRE ?V2
        REQUIRE ?V3
        MOV       A,#-0xc
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 12)
        ; Saved register size: 12
        ; Auto size: 13
        MOV       A,#-0xd
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 25)
        MOV       ?V0,R2
        MOV       ?V1,R3
        MOV       ?V2,R4
        MOV       ?V3,R5
// 2340   AddrMgrEntry_t entry;
// 2341   ZStatus_t      status;
// 2342 
// 2343   status = ZFailure;
        MOV       R6,#0x1
// 2344 
// 2345   // update the address manager
// 2346   entry.user    = ADDRMGR_USER_SECURITY;
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOV       A,#0x2
        MOVX      @DPTR,A
// 2347   entry.nwkAddr = partNwkAddr;
        MOV       A,#0x1
        LCALL     ?XSTACK_DISP0_8
        MOV       A,?V0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,?V1
        MOVX      @DPTR,A
// 2348   AddrMgrExtAddrSet( entry.extAddr, partExtAddr );
        ; Setup parameters for call to function AddrMgrExtAddrSet
        MOV       R4,?V2
        MOV       R5,?V3
        MOV       A,#0x3
        LCALL     ?XSTACK_DISP0_8
        MOV       R2,DPL
        MOV       R3,DPH
        LCALL     `??AddrMgrExtAddrSet::?relay`; Banked call to: AddrMgrExtAddrSet
// 2349 
// 2350   if ( AddrMgrEntryUpdate( &entry ) == TRUE )
        ; Setup parameters for call to function AddrMgrEntryUpdate
        MOV       R2,?XSP + 0
        MOV       R3,?XSP + 1
        LCALL     `??AddrMgrEntryUpdate::?relay`; Banked call to: AddrMgrEntryUpdate
        MOV       A,R1
        XRL       A,#0x1
        JNZ       ??ZDSecMgrSetupPartner_0
// 2351   {
// 2352     status = ZSuccess;
        MOV       R6,#0x0
// 2353 
// 2354     // check for address discovery
// 2355     if ( partNwkAddr == INVALID_NODE_ADDR )
        MOV       A,#-0x2
        XRL       A,?V0
        JNZ       ??ZDSecMgrSetupPartner_1
        MOV       A,#-0x1
        XRL       A,?V1
??ZDSecMgrSetupPartner_1:
        JNZ       ??ZDSecMgrSetupPartner_2
// 2356     {
// 2357       status = ZDP_NwkAddrReq( partExtAddr, ZDP_ADDR_REQTYPE_SINGLE, 0, 0 );
        ; Setup parameters for call to function ZDP_NwkAddrReq
        MOV       R5,#0x0
        MOV       R4,#0x0
        MOV       R1,#0x0
        MOV       R2,?V2
        MOV       R3,?V3
        LCALL     `??ZDP_NwkAddrReq::?relay`; Banked call to: ZDP_NwkAddrReq
        MOV       A,R1
        MOV       R6,A
        SJMP      ??ZDSecMgrSetupPartner_0
// 2358     }
// 2359     else if ( !AddrMgrExtAddrValid( partExtAddr ) )
??ZDSecMgrSetupPartner_2:
        ; Setup parameters for call to function AddrMgrExtAddrValid
        MOV       R2,?V2
        MOV       R3,?V3
        LCALL     `??AddrMgrExtAddrValid::?relay`; Banked call to: AddrMgrExtAddrValid
        MOV       A,R1
        JNZ       ??ZDSecMgrSetupPartner_0
// 2360     {
// 2361       status = ZDP_IEEEAddrReq( partNwkAddr, ZDP_ADDR_REQTYPE_SINGLE, 0, 0 );
        ; Setup parameters for call to function ZDP_IEEEAddrReq
        MOV       R5,#0x0
        MOV       R4,#0x0
        MOV       R1,#0x0
        MOV       R2,?V0
        MOV       R3,?V1
        LCALL     `??ZDP_IEEEAddrReq::?relay`; Banked call to: ZDP_IEEEAddrReq
        MOV       A,R1
        MOV       R6,A
// 2362     }
// 2363   }
// 2364 
// 2365   return status;
??ZDSecMgrSetupPartner_0:
        MOV       A,R6
        MOV       R1,A
        MOV       A,#0xd
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 12)
        MOV       R7,#0x4
        LJMP      ?BANKED_LEAVE_XDATA
// 2366 }
          CFI EndBlock cfiBlock44
// 2367 #endif // ( ZG_BUILD_JOINING_TYPE )
// 2368 
// 2369 #if ( ZG_BUILD_COORDINATOR_TYPE )
// 2370 /******************************************************************************
// 2371  * @fn          ZDSecMgrAppKeyTypeSet
// 2372  *
// 2373  * @brief       Set application key type.
// 2374  *
// 2375  * @param       keyType - [in] application key type (KEY_TYPE_APP_MASTER@2 or
// 2376  *                                                   KEY_TYPE_APP_LINK@3
// 2377  *
// 2378  * @return      ZStatus_t
// 2379  */
// 2380 ZStatus_t ZDSecMgrAppKeyTypeSet( uint8 keyType )
// 2381 {
// 2382   if ( keyType == KEY_TYPE_APP_LINK )
// 2383   {
// 2384     ZDSecMgrAppKeyType = KEY_TYPE_APP_LINK;
// 2385   }
// 2386   else
// 2387   {
// 2388     ZDSecMgrAppKeyType = KEY_TYPE_APP_MASTER;
// 2389   }
// 2390 
// 2391   return ZSuccess;
// 2392 }
// 2393 #endif
// 2394 
// 2395 /******************************************************************************
// 2396  * ZigBee Device Security Manager - Stub Implementations
// 2397  */
// 2398 
// 2399 
// 2400 /******************************************************************************
// 2401  * @fn          ZDSecMgrLinkKeySet (stubs APSME_LinkKeySet)
// 2402  *
// 2403  * @brief       Set <APSME_LinkKeyData_t> for specified NWK address.
// 2404  *
// 2405  * @param       extAddr - [in] EXT address
// 2406  * @param       data    - [in] APSME_LinkKeyData_t
// 2407  *
// 2408  * @return      ZStatus_t
// 2409  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 2410 ZStatus_t ZDSecMgrLinkKeySet( uint8* extAddr, uint8* key )
APSME_LinkKeySet:
          CFI Block cfiBlock45 Using cfiCommon0
          CFI Function APSME_LinkKeySet
        CODE
// 2411 {
        FUNCALL APSME_LinkKeySet, ZDSecMgrEntryLookupExtGetIndex
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 24, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 24, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_LinkKeySet, osal_mem_alloc
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_LinkKeySet, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 26, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 26, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_LinkKeySet, osal_memcpy
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 25, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 25, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_LinkKeySet, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 26, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 26, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_LinkKeySet, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_LinkKeySet, osal_mem_free
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V2
        REQUIRE ?V3
        REQUIRE ?V4
        REQUIRE ?V5
        REQUIRE ?V6
        REQUIRE ?V8
        REQUIRE ?V9
        MOV       A,#-0x12
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V9 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V8 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 18)
        ; Saved register size: 18
        ; Auto size: 4
        MOV       A,#-0x4
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 22)
        MOV       ?V2,R2
        MOV       ?V3,R3
        MOV       A,R4
        MOV       R6,A
        MOV       A,R5
        MOV       R7,A
// 2412   ZStatus_t status;
// 2413   ZDSecMgrEntry_t* entry;
// 2414   APSME_LinkKeyData_t *pApsLinkKey = NULL;
        MOV       ?V8,#0x0
        MOV       ?V9,#0x0
// 2415   uint16 Index;
// 2416 
// 2417   // lookup entry index for specified EXT address
// 2418   status = ZDSecMgrEntryLookupExtGetIndex( extAddr, &entry, &Index );
        ; Setup parameters for call to function ZDSecMgrEntryLookupExtGetIndex
        MOV       A,#0x2
        LCALL     ?XSTACK_DISP100_8
        MOV       ?V4,R0
        MOV       ?V5,R1
        MOV       R0,#?V4
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 24)
        MOV       A,#0x2
        LCALL     ?XSTACK_DISP102_8
        MOV       R2,?V2
        MOV       R3,?V3
        LCALL     `??ZDSecMgrEntryLookupExtGetIndex::?relay`; Banked call to: ZDSecMgrEntryLookupExtGetIndex
        MOV       A,#0x2
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 22)
        MOV       A,R1
        MOV       ?V0,A
// 2419 
// 2420   if ( status == ZSuccess )
        MOV       A,?V0
        JZ        $+5
        LJMP      ??APSME_LinkKeySet_0 & 0xFFFF
// 2421   {
// 2422     // point to NV item
// 2423     entry->keyNvId = ZCD_NV_APS_LINK_KEY_DATA_START + Index;
        MOV       A,#0x2
        LCALL     ?XSTACK_DISP0_8
        MOVX      A,@DPTR
        ADD       A,#0x1
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        ADDC      A,#0x2
        MOV       R1,A
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOVX      A,@DPTR
        MOV       R2,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       DPH,A
        MOV       DPL,R2
        INC       DPTR
        INC       DPTR
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
// 2424 
// 2425     pApsLinkKey = (APSME_LinkKeyData_t *)osal_mem_alloc(sizeof(APSME_LinkKeyData_t));
        ; Setup parameters for call to function osal_mem_alloc
        MOV       R2,#0x18
        MOV       R3,#0x0
        LCALL     `??osal_mem_alloc::?relay`; Banked call to: osal_mem_alloc
        MOV       ?V4,R2
        MOV       ?V5,R3
        MOV       ?V8,?V4
        MOV       ?V9,?V5
// 2426 
// 2427     if (pApsLinkKey != NULL)
        MOV       A,?V8
        ORL       A,?V9
        JNZ       $+5
        LJMP      ??APSME_LinkKeySet_0 & 0xFFFF
// 2428     {
// 2429       // read the key form NV, keyNvId must be ZCD_NV_APS_LINK_KEY_DATA_START based
// 2430       osal_nv_read( entry->keyNvId, 0,
// 2431                    sizeof(APSME_LinkKeyData_t), pApsLinkKey );
        ; Setup parameters for call to function osal_nv_read
        MOV       R0,#?V8
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 24)
        MOV       ?V4,#0x18
        MOV       ?V5,#0x0
        MOV       R0,#?V4
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 26)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       A,#0x4
        LCALL     ?XSTACK_DISP0_8
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       DPH,A
        MOV       DPL,R0
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R2,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R3,A
        LCALL     `??osal_nv_read::?relay`; Banked call to: osal_nv_read
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 22)
        MOV       A,R1
// 2432 
// 2433       // set new values of the key
// 2434       osal_memcpy( pApsLinkKey->key, key, SEC_KEY_LEN );
        ; Setup parameters for call to function osal_memcpy
        MOV       ?V4,R6
        MOV       ?V5,R7
        MOV       ?V6,#0x0
        MOV       R0,#?V4
        LCALL     ?PUSH_XSTACK_I_THREE
          CFI CFA_XSP16 add(XSP16, 25)
        MOV       R4,#0x10
        MOV       R5,#0x0
        MOV       R2,?V8
        MOV       R3,?V9
        LCALL     `??osal_memcpy::?relay`; Banked call to: osal_memcpy
        MOV       A,#0x3
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 22)
// 2435       pApsLinkKey->rxFrmCntr = 0;
        MOV       A,?V8
        ADD       A,#0x14
        MOV       DPL,A
        CLR       A
        ADDC      A,?V9
        MOV       DPH,A
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
// 2436       pApsLinkKey->txFrmCntr = 0;
        MOV       A,?V8
        ADD       A,#0x10
        MOV       DPL,A
        CLR       A
        ADDC      A,?V9
        MOV       DPH,A
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
// 2437 
// 2438       osal_nv_write( entry->keyNvId, 0,
// 2439                     sizeof(APSME_LinkKeyData_t), pApsLinkKey );
        ; Setup parameters for call to function osal_nv_write
        MOV       R0,#?V8
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 24)
        MOV       ?V4,#0x18
        MOV       ?V5,#0x0
        MOV       R0,#?V4
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 26)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       A,#0x4
        LCALL     ?XSTACK_DISP0_8
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       DPH,A
        MOV       DPL,R0
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R2,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R3,A
        LCALL     `??osal_nv_write::?relay`; Banked call to: osal_nv_write
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 22)
        MOV       A,R1
// 2440 
// 2441       // clear copy of key in RAM
// 2442       osal_memset(pApsLinkKey, 0x00, sizeof(APSME_LinkKeyData_t));
        ; Setup parameters for call to function osal_memset
        MOV       R4,#0x18
        MOV       R5,#0x0
        MOV       R1,#0x0
        MOV       R2,?V8
        MOV       R3,?V9
        LCALL     `??osal_memset::?relay`; Banked call to: osal_memset
// 2443 
// 2444       osal_mem_free(pApsLinkKey);
        ; Setup parameters for call to function osal_mem_free
        MOV       R2,?V8
        MOV       R3,?V9
        LCALL     `??osal_mem_free::?relay`; Banked call to: osal_mem_free
// 2445 
// 2446       // set initial values for counters in RAM
// 2447       ApsLinkKeyFrmCntr[entry->keyNvId - ZCD_NV_APS_LINK_KEY_DATA_START].txFrmCntr = 0;
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       DPH,A
        MOV       DPL,R0
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       A,R0
        MOV       B,#0x9
        MUL       AB
        XCH       A,R0
        MOV       R2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R2
        MOV       R2,A
        MOV       B,#0x9
        MOV       A,R1
        MUL       AB
        ADD       A,R2
        MOV       R1,A
        MOV       A,#(ApsLinkKeyFrmCntr + 247) & 0xff
        ADD       A,R0
        MOV       DPL,A
        MOV       A,#((ApsLinkKeyFrmCntr - 4617) >> 8) & 0xff
        ADDC      A,R1
        MOV       DPH,A
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
// 2448       ApsLinkKeyFrmCntr[entry->keyNvId - ZCD_NV_APS_LINK_KEY_DATA_START].rxFrmCntr = 0;
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       DPH,A
        MOV       DPL,R0
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       A,R0
        MOV       B,#0x9
        MUL       AB
        XCH       A,R0
        MOV       R2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R2
        MOV       R2,A
        MOV       B,#0x9
        MOV       A,R1
        MUL       AB
        ADD       A,R2
        MOV       R1,A
        MOV       A,#(ApsLinkKeyFrmCntr + 251) & 0xff
        ADD       A,R0
        MOV       DPL,A
        MOV       A,#((ApsLinkKeyFrmCntr - 4613) >> 8) & 0xff
        ADDC      A,R1
        MOV       DPH,A
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
// 2449     }
// 2450   }
// 2451 
// 2452   return status;
??APSME_LinkKeySet_0:
        MOV       R1,?V0
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 18)
        MOV       R7,#0xa
        LJMP      ?BANKED_LEAVE_XDATA
// 2453 }
          CFI EndBlock cfiBlock45
// 2454 
// 2455 /******************************************************************************
// 2456  * @fn          ZDSecMgrAuthenticationSet
// 2457  *
// 2458  * @brief       Mark the specific device as authenticated or not
// 2459  *
// 2460  * @param       extAddr - [in] EXT address
// 2461  * @param       option  - [in] authenticated or not
// 2462  *
// 2463  * @return      ZStatus_t
// 2464  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 2465 ZStatus_t ZDSecMgrAuthenticationSet( uint8* extAddr, ZDSecMgr_Authentication_Option option )
ZDSecMgrAuthenticationSet:
          CFI Block cfiBlock46 Using cfiCommon0
          CFI Function ZDSecMgrAuthenticationSet
        CODE
// 2466 {
        FUNCALL ZDSecMgrAuthenticationSet, ZDSecMgrEntryLookupExt
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 12, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 12, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        MOV       A,#-0xa
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 10)
        ; Saved register size: 10
        ; Auto size: 2
        MOV       A,#-0x2
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 12)
        MOV       A,R2
        MOV       R6,A
        MOV       A,R3
        MOV       R7,A
        MOV       ?V1,R1
// 2467   ZStatus_t        status;
// 2468   ZDSecMgrEntry_t* entry;
// 2469 
// 2470 
// 2471   // lookup entry index for specified EXT address
// 2472   status = ZDSecMgrEntryLookupExt( extAddr, &entry );
        ; Setup parameters for call to function ZDSecMgrEntryLookupExt
        MOV       R4,?XSP + 0
        MOV       R5,?XSP + 1
        MOV       A,R6
        MOV       R2,A
        MOV       A,R7
        MOV       R3,A
        LCALL     `??ZDSecMgrEntryLookupExt::?relay`; Banked call to: ZDSecMgrEntryLookupExt
        MOV       A,R1
        MOV       ?V0,A
// 2473 
// 2474   if ( status == ZSuccess )
        MOV       A,?V0
        JNZ       ??ZDSecMgrAuthenticationSet_0
// 2475   {
// 2476     entry->authenticateOption = option;
        MOV       A,?V1
        PUSH      A
          CFI CFA_SP SP+-1
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       DPH,A
        MOV       DPL,R0
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        POP       A
          CFI CFA_SP SP+0
        MOVX      @DPTR,A
// 2477   }
// 2478 
// 2479   return status;
??ZDSecMgrAuthenticationSet_0:
        MOV       R1,?V0
        MOV       A,#0x2
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 10)
        MOV       R7,#0x2
        LJMP      ?BANKED_LEAVE_XDATA
// 2480 }
          CFI EndBlock cfiBlock46
// 2481 
// 2482 /******************************************************************************
// 2483  * @fn          ZDSecMgrAuthenticationCheck
// 2484  *
// 2485  * @brief       Check if the specific device has been authenticated or not
// 2486  *              For non-trust center device, always return TRUE
// 2487  *
// 2488  * @param       shortAddr - [in] short address
// 2489  *
// 2490  * @return      TRUE @ authenticated with CBKE
// 2491  *              FALSE @ not authenticated
// 2492  */
// 2493 

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 2494 uint8 ZDSecMgrAuthenticationCheck( uint16 shortAddr )
ZDSecMgrAuthenticationCheck:
          CFI Block cfiBlock47 Using cfiCommon0
          CFI Function ZDSecMgrAuthenticationCheck
        CODE
// 2495 {
        FUNCALL ZDSecMgrAuthenticationCheck, APSME_GetRequest
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrAuthenticationCheck, NLME_GetExtAddr
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrAuthenticationCheck, sAddrExtCmp
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrAuthenticationCheck, AddrMgrExtAddrLookup
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrAuthenticationCheck, ZDSecMgrEntryLookupExt
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrAuthenticationCheck, ZDSecMgrExtAddrLookup
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        MOV       A,#-0xa
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 10)
        ; Saved register size: 10
        ; Auto size: 12
        MOV       A,#-0xc
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 22)
        MOV       A,R2
        MOV       R6,A
        MOV       A,R3
        MOV       R7,A
// 2496 #if defined (TC_LINKKEY_JOIN)
// 2497 
// 2498   ZDSecMgrEntry_t* entry;
// 2499   uint8 extAddr[Z_EXTADDR_LEN];
// 2500 
// 2501   // If the local device is not the trust center, always return TRUE
// 2502   APSME_GetRequest( apsTrustCenterAddress, 0, extAddr );
        ; Setup parameters for call to function APSME_GetRequest
        MOV       A,#0x4
        LCALL     ?XSTACK_DISP102_8
        MOV       R2,#0x0
        MOV       R3,#0x0
        MOV       R1,#-0x55
        LCALL     `??APSME_GetRequest::?relay`; Banked call to: APSME_GetRequest
        MOV       A,R1
// 2503   if ( ! osal_ExtAddrEqual( extAddr , NLME_GetExtAddr() ) )
        ; Setup parameters for call to function NLME_GetExtAddr
        LCALL     `??NLME_GetExtAddr::?relay`; Banked call to: NLME_GetExtAddr
        MOV       ?V0,R2
        MOV       ?V1,R3
        MOV       R4,?V0
        MOV       R5,?V1
        ; Setup parameters for call to function sAddrExtCmp
        MOV       A,#0x4
        LCALL     ?XSTACK_DISP101_8
        LCALL     `??sAddrExtCmp::?relay`; Banked call to: sAddrExtCmp
        MOV       A,R1
        JNZ       ??ZDSecMgrAuthenticationCheck_0
// 2504   {
// 2505     return TRUE;
        MOV       R1,#0x1
        SJMP      ??ZDSecMgrAuthenticationCheck_1
// 2506   }
// 2507   // Otherwise, check the authentication option
// 2508   else if ( AddrMgrExtAddrLookup( shortAddr, extAddr ) )
??ZDSecMgrAuthenticationCheck_0:
        ; Setup parameters for call to function AddrMgrExtAddrLookup
        MOV       A,#0x4
        LCALL     ?XSTACK_DISP102_8
        MOV       A,R6
        MOV       R2,A
        MOV       A,R7
        MOV       R3,A
        LCALL     `??AddrMgrExtAddrLookup::?relay`; Banked call to: AddrMgrExtAddrLookup
        MOV       A,R1
        JZ        ??ZDSecMgrAuthenticationCheck_2
// 2509   {
// 2510     // lookup entry index for specified EXT address
// 2511     if ( ZDSecMgrEntryLookupExt( extAddr, &entry ) == ZSuccess )
        ; Setup parameters for call to function ZDSecMgrEntryLookupExt
        MOV       R4,?XSP + 0
        MOV       R5,?XSP + 1
        MOV       A,#0x4
        LCALL     ?XSTACK_DISP101_8
        LCALL     `??ZDSecMgrEntryLookupExt::?relay`; Banked call to: ZDSecMgrEntryLookupExt
        MOV       A,R1
        JNZ       ??ZDSecMgrAuthenticationCheck_3
// 2512     {
// 2513       if ( entry->authenticateOption != ZDSecMgr_Not_Authenticated )
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       DPH,A
        MOV       DPL,R0
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        JZ        ??ZDSecMgrAuthenticationCheck_4
// 2514       {
// 2515         return TRUE;
        MOV       R1,#0x1
        SJMP      ??ZDSecMgrAuthenticationCheck_1
// 2516       }
// 2517       else
// 2518       {
// 2519         return FALSE;
??ZDSecMgrAuthenticationCheck_4:
        MOV       R1,#0x0
        SJMP      ??ZDSecMgrAuthenticationCheck_1
// 2520       }
// 2521     }
// 2522     else
// 2523     {
// 2524       // it may have been secured with TCLK only
// 2525       uint16    ami;
// 2526 
// 2527       // lookup address index in address manager
// 2528       if ( ZDSecMgrExtAddrLookup( extAddr, &ami ) == ZSuccess )
??ZDSecMgrAuthenticationCheck_3:
        ; Setup parameters for call to function ZDSecMgrExtAddrLookup
        MOV       A,#0x2
        LCALL     ?XSTACK_DISP102_8
        MOV       A,#0x4
        LCALL     ?XSTACK_DISP101_8
        LCALL     `??ZDSecMgrExtAddrLookup::?relay`; Banked call to: ZDSecMgrExtAddrLookup
        MOV       A,R1
        JNZ       ??ZDSecMgrAuthenticationCheck_2
// 2529       {
// 2530         return TRUE;
        MOV       R1,#0x1
        SJMP      ??ZDSecMgrAuthenticationCheck_1
// 2531       }
// 2532     }
// 2533   }
// 2534   return FALSE;
??ZDSecMgrAuthenticationCheck_2:
        MOV       R1,#0x0
??ZDSecMgrAuthenticationCheck_1:
        MOV       A,#0xc
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 10)
        MOV       R7,#0x2
        LJMP      ?BANKED_LEAVE_XDATA
// 2535 
// 2536 #else
// 2537   (void)shortAddr;  // Intentionally unreferenced parameter
// 2538 
// 2539   // For non AMI/SE Profile, perform no check and always return TRUE.
// 2540   return TRUE;
// 2541 
// 2542 #endif // TC_LINKKEY_JOIN
// 2543 }
          CFI EndBlock cfiBlock47
// 2544 
// 2545 
// 2546 /******************************************************************************
// 2547  * @fn          ZDSecMgrLinkKeyNVIdGet (stubs APSME_LinkKeyNVIdGet)
// 2548  *
// 2549  * @brief       Get Key NV ID for specified NWK address.
// 2550  *
// 2551  * @param       extAddr - [in] EXT address
// 2552  * @param       keyNvId - [out] NV ID
// 2553  *
// 2554  * @return      ZStatus_t
// 2555  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 2556 ZStatus_t ZDSecMgrLinkKeyNVIdGet(uint8* extAddr, uint16 *pKeyNvId)
APSME_LinkKeyNVIdGet:
          CFI Block cfiBlock48 Using cfiCommon0
          CFI Function APSME_LinkKeyNVIdGet
        CODE
// 2557 {
        FUNCALL APSME_LinkKeyNVIdGet, ZDSecMgrEntryLookupExt
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 13, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 13, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        REQUIRE ?V2
        MOV       A,#-0xb
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 11)
        ; Saved register size: 11
        ; Auto size: 2
        MOV       A,#-0x2
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 13)
        MOV       A,R2
        MOV       R6,A
        MOV       A,R3
        MOV       R7,A
        MOV       ?V0,R4
        MOV       ?V1,R5
// 2558   ZStatus_t status;
// 2559   ZDSecMgrEntry_t* entry;
// 2560 
// 2561   // lookup entry index for specified NWK address
// 2562   status = ZDSecMgrEntryLookupExt( extAddr, &entry );
        ; Setup parameters for call to function ZDSecMgrEntryLookupExt
        MOV       R4,?XSP + 0
        MOV       R5,?XSP + 1
        MOV       A,R6
        MOV       R2,A
        MOV       A,R7
        MOV       R3,A
        LCALL     `??ZDSecMgrEntryLookupExt::?relay`; Banked call to: ZDSecMgrEntryLookupExt
        MOV       A,R1
        MOV       ?V2,A
// 2563 
// 2564   if ( status == ZSuccess )
        MOV       A,?V2
        JNZ       ??APSME_LinkKeyNVIdGet_0
// 2565   {
// 2566     // return the index to the NV table
// 2567     *pKeyNvId = entry->keyNvId;
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       DPH,A
        MOV       DPL,R0
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       DPL,?V0
        MOV       DPH,?V1
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
        SJMP      ??APSME_LinkKeyNVIdGet_1
// 2568   }
// 2569   else
// 2570   {
// 2571     *pKeyNvId = SEC_NO_KEY_NV_ID;
??APSME_LinkKeyNVIdGet_0:
        MOV       DPL,?V0
        MOV       DPH,?V1
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
// 2572   }
// 2573 
// 2574   return status;
??APSME_LinkKeyNVIdGet_1:
        MOV       R1,?V2
        MOV       A,#0x2
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 11)
        MOV       R7,#0x3
        LJMP      ?BANKED_LEAVE_XDATA
// 2575 }
          CFI EndBlock cfiBlock48
// 2576 
// 2577 /******************************************************************************
// 2578  * @fn          ZDSecMgrIsLinkKeyValid (stubs APSME_IsLinkKeyValid)
// 2579  *
// 2580  * @brief       Verifies if Link Key in NV has been set.
// 2581  *
// 2582  * @param       extAddr - [in] EXT address
// 2583  *
// 2584  * @return      TRUE - Link Key has been established
// 2585  *              FALSE - Link Key in NV has default value.
// 2586  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 2587 uint8 ZDSecMgrIsLinkKeyValid(uint8* extAddr)
APSME_IsLinkKeyValid:
          CFI Block cfiBlock49 Using cfiCommon0
          CFI Function APSME_IsLinkKeyValid
        CODE
// 2588 {
        FUNCALL APSME_IsLinkKeyValid, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 33, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 33, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_IsLinkKeyValid, APSME_LinkKeyNVIdGet
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 33, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 33, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_IsLinkKeyValid, osal_mem_alloc
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 33, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 33, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_IsLinkKeyValid, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 37, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 37, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_IsLinkKeyValid, osal_memcmp
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 36, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 36, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_IsLinkKeyValid, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 33, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 33, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_IsLinkKeyValid, osal_mem_free
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 33, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 33, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V2
        REQUIRE ?V3
        REQUIRE ?V4
        REQUIRE ?V5
        REQUIRE ?V6
        MOV       A,#-0xf
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 15)
        ; Saved register size: 15
        ; Auto size: 18
        MOV       A,#-0x12
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 33)
        MOV       A,R2
        MOV       R6,A
        MOV       A,R3
        MOV       R7,A
// 2589   APSME_LinkKeyData_t *pKeyData;
// 2590   uint16 apsLinkKeyNvId;
// 2591   uint8 nullKey[SEC_KEY_LEN];
// 2592   uint8 status = FALSE;
        MOV       ?V0,#0x0
// 2593 
// 2594   // initialize default vealue to compare to
// 2595   osal_memset(nullKey, 0x00, SEC_KEY_LEN);
        ; Setup parameters for call to function osal_memset
        MOV       R4,#0x10
        MOV       R5,#0x0
        MOV       R1,#0x0
        MOV       A,#0x2
        LCALL     ?XSTACK_DISP101_8
        LCALL     `??osal_memset::?relay`; Banked call to: osal_memset
// 2596 
// 2597   // check for APS link NV ID
// 2598   APSME_LinkKeyNVIdGet( extAddr, &apsLinkKeyNvId );
        ; Setup parameters for call to function APSME_LinkKeyNVIdGet
        MOV       R4,?XSP + 0
        MOV       R5,?XSP + 1
        MOV       A,R6
        MOV       R2,A
        MOV       A,R7
        MOV       R3,A
        LCALL     `??APSME_LinkKeyNVIdGet::?relay`; Banked call to: APSME_LinkKeyNVIdGet
        MOV       A,R1
// 2599 
// 2600   if (apsLinkKeyNvId != SEC_NO_KEY_NV_ID )
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       A,R0
        ORL       A,R1
        JNZ       $+5
        LJMP      ??APSME_IsLinkKeyValid_0 & 0xFFFF
// 2601   {
// 2602     pKeyData = (APSME_LinkKeyData_t *)osal_mem_alloc(sizeof(APSME_LinkKeyData_t));
        ; Setup parameters for call to function osal_mem_alloc
        MOV       R2,#0x18
        MOV       R3,#0x0
        LCALL     `??osal_mem_alloc::?relay`; Banked call to: osal_mem_alloc
        MOV       ?V4,R2
        MOV       ?V5,R3
        MOV       ?V2,?V4
        MOV       ?V3,?V5
// 2603 
// 2604     if (pKeyData != NULL)
        MOV       A,?V2
        ORL       A,?V3
        JZ        ??APSME_IsLinkKeyValid_0
// 2605     {
// 2606       // retrieve key from NV
// 2607       if ( osal_nv_read( apsLinkKeyNvId, 0,
// 2608                         sizeof(APSME_LinkKeyData_t), pKeyData) == ZSUCCESS)
        ; Setup parameters for call to function osal_nv_read
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 35)
        MOV       ?V4,#0x18
        MOV       ?V5,#0x0
        MOV       R0,#?V4
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 37)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       A,#0x4
        LCALL     ?XSTACK_DISP0_8
        MOVX      A,@DPTR
        MOV       R2,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R3,A
        LCALL     `??osal_nv_read::?relay`; Banked call to: osal_nv_read
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 33)
        MOV       A,R1
        JNZ       ??APSME_IsLinkKeyValid_1
// 2609       {
// 2610         // if stored key is different than default value, then a key has been established
// 2611         if (!osal_memcmp(pKeyData, nullKey, SEC_KEY_LEN))
        ; Setup parameters for call to function osal_memcmp
        MOV       A,#0x2
        LCALL     ?XSTACK_DISP100_8
        MOV       ?V4,R0
        MOV       ?V5,R1
        MOV       ?V6,#0x0
        MOV       R0,#?V4
        LCALL     ?PUSH_XSTACK_I_THREE
          CFI CFA_XSP16 add(XSP16, 36)
        MOV       R4,#0x10
        MOV       R5,#0x0
        MOV       DPL,?V2
        MOV       DPH,?V3
        MOV       R1,DPL
        MOV       R2,DPH
        MOV       R3,#0x0
        LCALL     `??osal_memcmp::?relay`; Banked call to: osal_memcmp
        MOV       A,#0x3
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 33)
        MOV       A,R1
        JNZ       ??APSME_IsLinkKeyValid_1
// 2612         {
// 2613           status = TRUE;
        MOV       ?V0,#0x1
// 2614         }
// 2615       }
// 2616 
// 2617       // clear copy of key in RAM
// 2618       osal_memset(pKeyData, 0x00, sizeof(APSME_LinkKeyData_t));
??APSME_IsLinkKeyValid_1:
        ; Setup parameters for call to function osal_memset
        MOV       R4,#0x18
        MOV       R5,#0x0
        MOV       R1,#0x0
        MOV       R2,?V2
        MOV       R3,?V3
        LCALL     `??osal_memset::?relay`; Banked call to: osal_memset
// 2619 
// 2620       osal_mem_free(pKeyData);
        ; Setup parameters for call to function osal_mem_free
        MOV       R2,?V2
        MOV       R3,?V3
        LCALL     `??osal_mem_free::?relay`; Banked call to: osal_mem_free
// 2621     }
// 2622   }
// 2623 
// 2624   return status;
??APSME_IsLinkKeyValid_0:
        MOV       R1,?V0
        MOV       A,#0x12
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 15)
        MOV       R7,#0x7
        LJMP      ?BANKED_LEAVE_XDATA
// 2625 }
          CFI EndBlock cfiBlock49
// 2626 
// 2627 /******************************************************************************
// 2628  * @fn          ZDSecMgrKeyFwdToChild (stubs APSME_KeyFwdToChild)
// 2629  *
// 2630  * @brief       Verify and process key transportation to child.
// 2631  *
// 2632  * @param       ind - [in] APSME_TransportKeyInd_t
// 2633  *
// 2634  * @return      uint8 - success(TRUE:FALSE)
// 2635  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 2636 uint8 ZDSecMgrKeyFwdToChild( APSME_TransportKeyInd_t* ind )
APSME_KeyFwdToChild:
          CFI Block cfiBlock50 Using cfiCommon0
          CFI Function APSME_KeyFwdToChild
        CODE
// 2637 {
        FUNCALL APSME_KeyFwdToChild, AssocGetWithExt
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_KeyFwdToChild, ZDSecMgrAssocDeviceAuth
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV       A,#-0x9
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
        MOV       A,R2
        MOV       R6,A
        MOV       A,R3
        MOV       R7,A
// 2638   // verify from Trust Center
// 2639   if ( ind->srcAddr == APSME_TRUSTCENTER_NWKADDR )
        MOV       DPL,R6
        MOV       DPH,R7
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       A,R0
        ORL       A,R1
        JNZ       ??APSME_KeyFwdToChild_0
// 2640   {
// 2641     // check for initial NWK key
// 2642     if ( ( ind->keyType == KEY_TYPE_NWK ) ||
// 2643          ( ind->keyType == 6            ) )
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        XRL       A,#0x1
        JZ        ??APSME_KeyFwdToChild_1
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        XRL       A,#0x6
        JNZ       ??APSME_KeyFwdToChild_2
// 2644     {
// 2645       // set association status to authenticated
// 2646       ZDSecMgrAssocDeviceAuth( AssocGetWithExt( ind->dstExtAddr ) );
??APSME_KeyFwdToChild_1:
        ; Setup parameters for call to function ZDSecMgrAssocDeviceAuth
        ; Setup parameters for call to function AssocGetWithExt
        MOV       DPL,R6
        MOV       DPH,R7
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R2,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R3,A
        LCALL     `??AssocGetWithExt::?relay`; Banked call to: AssocGetWithExt
        LCALL     `??ZDSecMgrAssocDeviceAuth::?relay`; Banked call to: ZDSecMgrAssocDeviceAuth
// 2647     }
// 2648 
// 2649     return TRUE;
??APSME_KeyFwdToChild_2:
        MOV       R1,#0x1
        SJMP      ??APSME_KeyFwdToChild_3
// 2650   }
// 2651 
// 2652   return FALSE;
??APSME_KeyFwdToChild_0:
        MOV       R1,#0x0
??APSME_KeyFwdToChild_3:
        MOV       R7,#0x1
        LJMP      ?BANKED_LEAVE_XDATA
// 2653 }
          CFI EndBlock cfiBlock50
// 2654 
// 2655 /******************************************************************************
// 2656  * @fn          ZDSecMgrAddLinkKey
// 2657  *
// 2658  * @brief       Add the application link key to ZDSecMgr. Also mark the device
// 2659  *              as authenticated in the authenticateOption. Note that this function
// 2660  *              is hardwared to CBKE right now.
// 2661  *
// 2662  * @param       shortAddr - short address of the partner device
// 2663  * @param       extAddr - extended address of the partner device
// 2664  * @param       key - link key
// 2665  *
// 2666  * @return      ZStatus_t
// 2667  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 2668 ZStatus_t ZDSecMgrAddLinkKey( uint16 shortAddr, uint8 *extAddr, uint8 *key)
ZDSecMgrAddLinkKey:
          CFI Block cfiBlock51 Using cfiCommon0
          CFI Function ZDSecMgrAddLinkKey
        CODE
// 2669 {
        FUNCALL ZDSecMgrAddLinkKey, ZDSecMgrAddrStore
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 20, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 20, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrAddLinkKey, ZDSecMgrEntryLookupAMI
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 18, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrAddLinkKey, ZDSecMgrEntryNew
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 18, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrAddLinkKey, APSME_LinkKeySet
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 18, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrAddLinkKey, ZDSecMgrAuthenticationSet
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 18, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrAddLinkKey, ZDSecMgrWriteNV
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 18, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        REQUIRE ?V2
        REQUIRE ?V3
        REQUIRE ?V4
        REQUIRE ?V5
        MOV       A,#-0xe
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 14)
        ; Saved register size: 14
        ; Auto size: 4
        MOV       A,#-0x4
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 18)
        MOV       ?V2,R2
        MOV       ?V3,R3
        MOV       A,R4
        MOV       R6,A
        MOV       A,R5
        MOV       R7,A
        MOV       A,#0x12
        LCALL     ?XSTACK_DISP0_8
        MOVX      A,@DPTR
        MOV       ?V0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       ?V1,A
// 2670   uint16           ami;
// 2671   ZDSecMgrEntry_t* entry;
// 2672 
// 2673   /* Store the device address in the addr manager */
// 2674   if( ZDSecMgrAddrStore( shortAddr, extAddr, &ami ) != ZSuccess )
        ; Setup parameters for call to function ZDSecMgrAddrStore
        MOV       A,#0x2
        LCALL     ?XSTACK_DISP100_8
        MOV       ?V4,R0
        MOV       ?V5,R1
        MOV       R0,#?V4
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 20)
        MOV       A,R6
        MOV       R4,A
        MOV       A,R7
        MOV       R5,A
        MOV       R2,?V2
        MOV       R3,?V3
        LCALL     `??ZDSecMgrAddrStore::?relay`; Banked call to: ZDSecMgrAddrStore
        MOV       A,#0x2
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 18)
        MOV       A,R1
        JZ        ??ZDSecMgrAddLinkKey_0
// 2675   {
// 2676     /* Adding to Addr Manager fails */
// 2677     return ZFailure;
        MOV       R1,#0x1
        SJMP      ??ZDSecMgrAddLinkKey_1
// 2678   }
// 2679 
// 2680   /* Lookup entry using specified address index */
// 2681   ZDSecMgrEntryLookupAMI( ami, &entry );
??ZDSecMgrAddLinkKey_0:
        ; Setup parameters for call to function ZDSecMgrEntryLookupAMI
        MOV       R4,?XSP + 0
        MOV       R5,?XSP + 1
        MOV       A,#0x2
        LCALL     ?XSTACK_DISP0_8
        MOVX      A,@DPTR
        MOV       R2,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R3,A
        LCALL     `??ZDSecMgrEntryLookupAMI::?relay`; Banked call to: ZDSecMgrEntryLookupAMI
        MOV       A,R1
// 2682 
// 2683   // If no existing entry, create one
// 2684   if ( entry == NULL )
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       A,R0
        ORL       A,R1
        JNZ       ??ZDSecMgrAddLinkKey_2
// 2685   {
// 2686     if ( ZDSecMgrEntryNew( &entry ) == ZSuccess )
        ; Setup parameters for call to function ZDSecMgrEntryNew
        MOV       R2,?XSP + 0
        MOV       R3,?XSP + 1
        LCALL     `??ZDSecMgrEntryNew::?relay`; Banked call to: ZDSecMgrEntryNew
        MOV       A,R1
        JNZ       ??ZDSecMgrAddLinkKey_3
// 2687     {
// 2688       entry->ami = ami;
        MOV       A,#0x2
        LCALL     ?XSTACK_DISP0_8
        MOVX      A,@DPTR
        MOV       R2,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R3,A
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       DPH,A
        MOV       DPL,R0
        MOV       A,R2
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R3
        MOVX      @DPTR,A
        SJMP      ??ZDSecMgrAddLinkKey_2
// 2689     }
// 2690     else
// 2691     {
// 2692       /* Security Manager full */
// 2693       return ZBufferFull;
??ZDSecMgrAddLinkKey_3:
        MOV       R1,#0x11
        SJMP      ??ZDSecMgrAddLinkKey_1
// 2694     }
// 2695   }
// 2696   // Write the link key
// 2697   APSME_LinkKeySet( extAddr, key );
??ZDSecMgrAddLinkKey_2:
        ; Setup parameters for call to function APSME_LinkKeySet
        MOV       R4,?V0
        MOV       R5,?V1
        MOV       A,R6
        MOV       R2,A
        MOV       A,R7
        MOV       R3,A
        LCALL     `??APSME_LinkKeySet::?relay`; Banked call to: APSME_LinkKeySet
        MOV       A,R1
// 2698 
// 2699 #if defined (TC_LINKKEY_JOIN)
// 2700   // Mark the device as authenticated.
// 2701   ZDSecMgrAuthenticationSet( extAddr, ZDSecMgr_Authenticated_CBCK );
        ; Setup parameters for call to function ZDSecMgrAuthenticationSet
        MOV       R1,#0x1
        MOV       A,R6
        MOV       R2,A
        MOV       A,R7
        MOV       R3,A
        LCALL     `??ZDSecMgrAuthenticationSet::?relay`; Banked call to: ZDSecMgrAuthenticationSet
        MOV       A,R1
// 2702 #endif
// 2703 
// 2704 #if defined NV_RESTORE
// 2705   ZDSecMgrWriteNV();  // Write the new established link key to NV.
        ; Setup parameters for call to function ZDSecMgrWriteNV
        LCALL     `??ZDSecMgrWriteNV::?relay`; Banked call to: ZDSecMgrWriteNV
// 2706 #endif
// 2707 
// 2708   return ZSuccess;
        MOV       R1,#0x0
??ZDSecMgrAddLinkKey_1:
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 14)
        MOV       R7,#0x6
        LJMP      ?BANKED_LEAVE_XDATA
// 2709 }
          CFI EndBlock cfiBlock51
// 2710 
// 2711 /******************************************************************************
// 2712  * @fn          ZDSecMgrInitNV
// 2713  *
// 2714  * @brief       Initialize the SecMgr entry data in NV with all values set to 0
// 2715  *
// 2716  * @param       none
// 2717  *
// 2718  * @return      uint8 - <osal_nv_item_init> return codes
// 2719  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 2720 uint8 ZDSecMgrInitNV(void)
ZDSecMgrInitNV:
          CFI Block cfiBlock52 Using cfiCommon0
          CFI Function ZDSecMgrInitNV
        CODE
// 2721 {
        FUNCALL ZDSecMgrInitNV, osal_nv_item_init
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrInitNV, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 16, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 16, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrInitNV, osal_nv_item_init
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        MOV       A,#-0xa
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 10)
        ; Saved register size: 10
        ; Auto size: 2
        MOV       A,#-0x2
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 12)
// 2722 
// 2723   uint8 rtrn = osal_nv_item_init(ZCD_NV_APS_LINK_KEY_TABLE,
// 2724                 (sizeof(nvDeviceListHdr_t) + (sizeof(ZDSecMgrEntry_t) * ZDSECMGR_ENTRY_MAX)), NULL);
        ; Setup parameters for call to function osal_nv_item_init
        CLR       A
        MOV       ?V0,A
        MOV       ?V1,A
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 14)
        MOV       R4,#0x11
        MOV       R5,#0x0
        MOV       R2,#0x4c
        MOV       R3,#0x0
        LCALL     `??osal_nv_item_init::?relay`; Banked call to: osal_nv_item_init
        MOV       A,#0x2
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 12)
        MOV       A,R1
        MOV       R6,A
// 2725 
// 2726   // If the item does not already exist, set all values to 0
// 2727   if (rtrn == NV_ITEM_UNINIT)
        MOV       A,#0x9
        XRL       A,R6
        JNZ       ??ZDSecMgrInitNV_0
// 2728   {
// 2729     nvDeviceListHdr_t hdr;
// 2730     hdr.numRecs = 0;
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
// 2731     osal_nv_write(ZCD_NV_APS_LINK_KEY_TABLE, 0, sizeof(nvDeviceListHdr_t), &hdr);
        ; Setup parameters for call to function osal_nv_write
        MOV       R0,?XSP + 0
        MOV       R1,?XSP + 1
        MOV       ?V0,R0
        MOV       ?V1,R1
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 14)
        MOV       ?V0,#0x2
        MOV       ?V1,#0x0
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 16)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       R2,#0x4c
        MOV       R3,#0x0
        LCALL     `??osal_nv_write::?relay`; Banked call to: osal_nv_write
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 12)
        MOV       A,R1
// 2732   }
// 2733 
// 2734   rtrn |= osal_nv_item_init( ZCD_NV_TRUSTCENTER_ADDR, Z_EXTADDR_LEN,
// 2735                              zgApsTrustCenterAddr );
??ZDSecMgrInitNV_0:
        ; Setup parameters for call to function osal_nv_item_init
        MOV       ?V0,#zgApsTrustCenterAddr & 0xff
        MOV       ?V1,#(zgApsTrustCenterAddr >> 8) & 0xff
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 14)
        MOV       R4,#0x8
        MOV       R5,#0x0
        MOV       R2,#0x71
        MOV       R3,#0x0
        LCALL     `??osal_nv_item_init::?relay`; Banked call to: osal_nv_item_init
        MOV       A,#0x2
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 12)
        MOV       A,R1
        XCH       A,R6
        ORL       A,R6
        XCH       A,R6
// 2736 
// 2737   return rtrn;
        MOV       A,R6
        MOV       R1,A
        MOV       A,#0x2
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 10)
        MOV       R7,#0x2
        LJMP      ?BANKED_LEAVE_XDATA
// 2738 }
          CFI EndBlock cfiBlock52
// 2739 
// 2740 #if defined ( NV_RESTORE )
// 2741 /*********************************************************************
// 2742  * @fn      ZDSecMgrWriteNV()
// 2743  *
// 2744  * @brief   Save off the APS link key list to NV
// 2745  *
// 2746  * @param   none
// 2747  *
// 2748  * @return  none
// 2749  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 2750 static void ZDSecMgrWriteNV( void )
ZDSecMgrWriteNV:
          CFI Block cfiBlock53 Using cfiCommon0
          CFI Function ZDSecMgrWriteNV
        CODE
// 2751 {
        FUNCALL ZDSecMgrWriteNV, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 16, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 16, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrWriteNV, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 16, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 16, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        MOV       A,#-0xa
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 10)
        ; Saved register size: 10
        ; Auto size: 2
        MOV       A,#-0x2
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 12)
// 2752   uint16 i;
// 2753   nvDeviceListHdr_t hdr;
// 2754 
// 2755   hdr.numRecs = 0;
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
// 2756 
// 2757   if (ZDSecMgrEntries != NULL)
        MOV       DPTR,#ZDSecMgrEntries
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       A,R0
        ORL       A,R1
        JNZ       $+5
        LJMP      ??ZDSecMgrWriteNV_0 & 0xFFFF
// 2758   {
// 2759     for ( i = 0; i < ZDSECMGR_ENTRY_MAX; i++ )
        MOV       R6,#0x0
        MOV       R7,#0x0
??ZDSecMgrWriteNV_1:
        CLR       C
        MOV       A,R6
        SUBB      A,#0x3
        MOV       A,R7
        SUBB      A,#0x0
        JC        $+5
        LJMP      ??ZDSecMgrWriteNV_0 & 0xFFFF
// 2760     {
// 2761       // Save off the record
// 2762       osal_nv_write( ZCD_NV_APS_LINK_KEY_TABLE,
// 2763                     (uint16)((sizeof(nvDeviceListHdr_t)) + (i * sizeof(ZDSecMgrEntry_t))),
// 2764                     sizeof(ZDSecMgrEntry_t), &ZDSecMgrEntries[i] );
        ; Setup parameters for call to function osal_nv_write
        MOV       A,R6
        MOV       R0,A
        MOV       A,R7
        MOV       R1,A
        MOV       A,R0
        MOV       B,#0x5
        MUL       AB
        XCH       A,R0
        MOV       R2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R2
        MOV       R2,A
        MOV       B,#0x5
        MOV       A,R1
        MUL       AB
        ADD       A,R2
        MOV       R1,A
        MOV       DPTR,#ZDSecMgrEntries
        MOVX      A,@DPTR
        ADD       A,R0
        MOV       ?V0,A
        INC       DPTR
        MOVX      A,@DPTR
        ADDC      A,R1
        MOV       ?V1,A
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 14)
        MOV       ?V0,#0x5
        MOV       ?V1,#0x0
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 16)
        MOV       A,R6
        MOV       R0,A
        MOV       A,R7
        MOV       R1,A
        MOV       A,R0
        MOV       B,#0x5
        MUL       AB
        XCH       A,R0
        MOV       R2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R2
        MOV       R2,A
        MOV       B,#0x5
        MOV       A,R1
        MUL       AB
        ADD       A,R2
        MOV       R1,A
        MOV       A,R0
        ADD       A,#0x2
        MOV       R4,A
        CLR       A
        ADDC      A,R1
        MOV       R5,A
        MOV       R2,#0x4c
        MOV       R3,#0x0
        LCALL     `??osal_nv_write::?relay`; Banked call to: osal_nv_write
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 12)
        MOV       A,R1
// 2765 
// 2766       if ( ZDSecMgrEntries[i].ami != INVALID_NODE_ADDR )
        MOV       A,R6
        MOV       R0,A
        MOV       A,R7
        MOV       R1,A
        MOV       A,R0
        MOV       B,#0x5
        MUL       AB
        XCH       A,R0
        MOV       R2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R2
        MOV       R2,A
        MOV       B,#0x5
        MOV       A,R1
        MUL       AB
        ADD       A,R2
        MOV       R1,A
        MOV       DPTR,#ZDSecMgrEntries
        MOVX      A,@DPTR
        ADD       A,R0
        MOV       R2,A
        INC       DPTR
        MOVX      A,@DPTR
        ADDC      A,R1
        MOV       DPL,R2
        MOV       DPH,A
        MOVX      A,@DPTR
        XRL       A,#0xfe
        JNZ       ??ZDSecMgrWriteNV_2
        INC       DPTR
        MOVX      A,@DPTR
        XRL       A,#0xff
??ZDSecMgrWriteNV_2:
        JZ        ??ZDSecMgrWriteNV_3
// 2767       {
// 2768         hdr.numRecs++;
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOVX      A,@DPTR
        ADD       A,#0x1
        MOVX      @DPTR,A
        INC       DPTR
        MOVX      A,@DPTR
        ADDC      A,#0x0
        MOVX      @DPTR,A
// 2769       }
// 2770     }
??ZDSecMgrWriteNV_3:
        INC       R6
        MOV       A,R6
        JNZ       ??ZDSecMgrWriteNV_4
        INC       R7
??ZDSecMgrWriteNV_4:
        LJMP      ??ZDSecMgrWriteNV_1 & 0xFFFF
// 2771   }
// 2772 
// 2773   // Save off the header
// 2774   osal_nv_write( ZCD_NV_APS_LINK_KEY_TABLE, 0, sizeof( nvDeviceListHdr_t ), &hdr );
??ZDSecMgrWriteNV_0:
        ; Setup parameters for call to function osal_nv_write
        MOV       R0,?XSP + 0
        MOV       R1,?XSP + 1
        MOV       ?V0,R0
        MOV       ?V1,R1
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 14)
        MOV       ?V0,#0x2
        MOV       ?V1,#0x0
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 16)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       R2,#0x4c
        MOV       R3,#0x0
        LCALL     `??osal_nv_write::?relay`; Banked call to: osal_nv_write
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 12)
        MOV       A,R1
// 2775 }
        MOV       A,#0x2
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 10)
        MOV       R7,#0x2
        LJMP      ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock53
// 2776 #endif // NV_RESTORE
// 2777 
// 2778 #if defined ( NV_RESTORE )
// 2779 /******************************************************************************
// 2780  * @fn          ZDSecMgrRestoreFromNV
// 2781  *
// 2782  * @brief       Restore the APS Link Key entry data from NV. It does not restore
// 2783  *              the key data itself as they remain in NV until they are used.
// 2784  *              Only list data is restored.
// 2785  *              Restore zgTrustCenterAdress from NV.
// 2786  *
// 2787  * @param       none
// 2788  *
// 2789  * @return      None.
// 2790  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 2791 static void ZDSecMgrRestoreFromNV( void )
ZDSecMgrRestoreFromNV:
          CFI Block cfiBlock54 Using cfiCommon0
          CFI Function ZDSecMgrRestoreFromNV
        CODE
// 2792 {
        FUNCALL ZDSecMgrRestoreFromNV, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrRestoreFromNV, osal_mem_alloc
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 18, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrRestoreFromNV, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrRestoreFromNV, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrRestoreFromNV, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrRestoreFromNV, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 18, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrRestoreFromNV, osal_mem_free
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 18, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrRestoreFromNV, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        REQUIRE ?V2
        REQUIRE ?V3
        REQUIRE ?V4
        REQUIRE ?V5
        REQUIRE ?V6
        REQUIRE ?V7
        MOV       A,#-0x10
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 16)
        ; Saved register size: 16
        ; Auto size: 2
        MOV       A,#-0x2
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 18)
// 2793   nvDeviceListHdr_t hdr;
// 2794   APSME_LinkKeyData_t *pApsLinkKey = NULL;
        MOV       ?V0,#0x0
        MOV       ?V1,#0x0
// 2795 
// 2796   if ((osal_nv_read(ZCD_NV_APS_LINK_KEY_TABLE, 0, sizeof(nvDeviceListHdr_t), &hdr) == ZSUCCESS) &&
// 2797       ((hdr.numRecs > 0) && (hdr.numRecs <= ZDSECMGR_ENTRY_MAX)))
        ; Setup parameters for call to function osal_nv_read
        MOV       R0,?XSP + 0
        MOV       R1,?XSP + 1
        MOV       ?V2,R0
        MOV       ?V3,R1
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 20)
        MOV       ?V2,#0x2
        MOV       ?V3,#0x0
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 22)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       R2,#0x4c
        MOV       R3,#0x0
        LCALL     `??osal_nv_read::?relay`; Banked call to: osal_nv_read
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 18)
        MOV       A,R1
        JZ        $+5
        LJMP      ??ZDSecMgrRestoreFromNV_0 & 0xFFFF
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       A,R0
        ORL       A,R1
        JNZ       $+5
        LJMP      ??ZDSecMgrRestoreFromNV_0 & 0xFFFF
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        CLR       C
        MOVX      A,@DPTR
        SUBB      A,#0x4
        INC       DPTR
        MOVX      A,@DPTR
        SUBB      A,#0x0
        JC        $+5
        LJMP      ??ZDSecMgrRestoreFromNV_0 & 0xFFFF
// 2798   {
// 2799     uint8 x;
// 2800 
// 2801     pApsLinkKey = (APSME_LinkKeyData_t *)osal_mem_alloc(sizeof(APSME_LinkKeyData_t));
        ; Setup parameters for call to function osal_mem_alloc
        MOV       R2,#0x18
        MOV       R3,#0x0
        LCALL     `??osal_mem_alloc::?relay`; Banked call to: osal_mem_alloc
        MOV       ?V2,R2
        MOV       ?V3,R3
        MOV       ?V0,?V2
        MOV       ?V1,?V3
// 2802 
// 2803     for (x = 0; x < ZDSECMGR_ENTRY_MAX; x++)
        MOV       R6,#0x0
??ZDSecMgrRestoreFromNV_1:
        MOV       A,R6
        CLR       C
        SUBB      A,#0x3
        JC        $+5
        LJMP      ??ZDSecMgrRestoreFromNV_2 & 0xFFFF
// 2804     {
// 2805       if ( osal_nv_read( ZCD_NV_APS_LINK_KEY_TABLE,
// 2806                         (uint16)(sizeof(nvDeviceListHdr_t) + (x * sizeof(ZDSecMgrEntry_t))),
// 2807                         sizeof(ZDSecMgrEntry_t), &ZDSecMgrEntries[x] ) == SUCCESS )
        ; Setup parameters for call to function osal_nv_read
        MOV       A,R6
        MOV       R0,A
        MOV       R1,#0x0
        MOV       A,R0
        MOV       B,#0x5
        MUL       AB
        XCH       A,R0
        MOV       R2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R2
        MOV       R2,A
        MOV       B,#0x5
        MOV       A,R1
        MUL       AB
        ADD       A,R2
        MOV       R1,A
        MOV       DPTR,#ZDSecMgrEntries
        MOVX      A,@DPTR
        ADD       A,R0
        MOV       ?V2,A
        INC       DPTR
        MOVX      A,@DPTR
        ADDC      A,R1
        MOV       ?V3,A
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 20)
        MOV       ?V2,#0x5
        MOV       ?V3,#0x0
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 22)
        MOV       A,R6
        MOV       R0,A
        MOV       R1,#0x0
        MOV       A,R0
        MOV       B,#0x5
        MUL       AB
        XCH       A,R0
        MOV       R2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R2
        MOV       R2,A
        MOV       B,#0x5
        MOV       A,R1
        MUL       AB
        ADD       A,R2
        MOV       R1,A
        MOV       A,R0
        ADD       A,#0x2
        MOV       R4,A
        CLR       A
        ADDC      A,R1
        MOV       R5,A
        MOV       R2,#0x4c
        MOV       R3,#0x0
        LCALL     `??osal_nv_read::?relay`; Banked call to: osal_nv_read
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 18)
        MOV       A,R1
        JZ        $+5
        LJMP      ??ZDSecMgrRestoreFromNV_3 & 0xFFFF
// 2808       {
// 2809         // update data only for valid entries
// 2810         if ( ZDSecMgrEntries[x].ami != INVALID_NODE_ADDR )
        MOV       A,R6
        MOV       R0,A
        MOV       R1,#0x0
        MOV       A,R0
        MOV       B,#0x5
        MUL       AB
        XCH       A,R0
        MOV       R2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R2
        MOV       R2,A
        MOV       B,#0x5
        MOV       A,R1
        MUL       AB
        ADD       A,R2
        MOV       R1,A
        MOV       DPTR,#ZDSecMgrEntries
        MOVX      A,@DPTR
        ADD       A,R0
        MOV       R2,A
        INC       DPTR
        MOVX      A,@DPTR
        ADDC      A,R1
        MOV       DPL,R2
        MOV       DPH,A
        MOVX      A,@DPTR
        XRL       A,#0xfe
        JNZ       ??ZDSecMgrRestoreFromNV_4
        INC       DPTR
        MOVX      A,@DPTR
        XRL       A,#0xff
??ZDSecMgrRestoreFromNV_4:
        JNZ       $+5
        LJMP      ??ZDSecMgrRestoreFromNV_3 & 0xFFFF
// 2811         {
// 2812           if (pApsLinkKey != NULL)
        MOV       A,?V0
        ORL       A,?V1
        JNZ       $+5
        LJMP      ??ZDSecMgrRestoreFromNV_3 & 0xFFFF
// 2813           {
// 2814             // read the key form NV, keyNvId must be ZCD_NV_APS_LINK_KEY_DATA_START based
// 2815             osal_nv_read( ZDSecMgrEntries[x].keyNvId, 0,
// 2816                          sizeof(APSME_LinkKeyData_t), pApsLinkKey );
        ; Setup parameters for call to function osal_nv_read
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 20)
        MOV       ?V2,#0x18
        MOV       ?V3,#0x0
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 22)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       A,R6
        MOV       R0,A
        MOV       R1,#0x0
        MOV       A,R0
        MOV       B,#0x5
        MUL       AB
        XCH       A,R0
        MOV       R2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R2
        MOV       R2,A
        MOV       B,#0x5
        MOV       A,R1
        MUL       AB
        ADD       A,R2
        MOV       R1,A
        MOV       DPTR,#ZDSecMgrEntries
        MOVX      A,@DPTR
        ADD       A,R0
        MOV       R2,A
        INC       DPTR
        MOVX      A,@DPTR
        ADDC      A,R1
        MOV       DPL,R2
        MOV       DPH,A
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R2,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R3,A
        LCALL     `??osal_nv_read::?relay`; Banked call to: osal_nv_read
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 18)
        MOV       A,R1
// 2817 
// 2818             // set new values for the counter
// 2819             pApsLinkKey->txFrmCntr += ( MAX_APS_FRAMECOUNTER_CHANGES + 1 );
        MOV       DPTR,#__Constant_3e9
        MOV       R0,#?V4
        LCALL     ?L_MOV_X
        MOV       A,?V0
        ADD       A,#0x10
        MOV       DPL,A
        CLR       A
        ADDC      A,?V1
        MOV       DPH,A
        MOV       R0,#?V4
        LCALL     ?L_ADD_TO_X
// 2820 
// 2821             // restore values for counters in RAM
// 2822             ApsLinkKeyFrmCntr[ZDSecMgrEntries[x].keyNvId - ZCD_NV_APS_LINK_KEY_DATA_START].txFrmCntr =
// 2823                                             pApsLinkKey->txFrmCntr;
        MOV       A,?V0
        ADD       A,#0x10
        MOV       DPL,A
        CLR       A
        ADDC      A,?V1
        MOV       DPH,A
        LCALL     ?XLOAD_R0123
        MOV       A,R6
        MOV       R4,A
        MOV       R5,#0x0
        MOV       A,R4
        MOV       B,#0x5
        MUL       AB
        XCH       A,R4
        MOV       R7,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R7
        MOV       R7,A
        MOV       B,#0x5
        MOV       A,R5
        MUL       AB
        ADD       A,R7
        MOV       R5,A
        MOV       DPTR,#ZDSecMgrEntries
        MOVX      A,@DPTR
        ADD       A,R4
        MOV       R7,A
        INC       DPTR
        MOVX      A,@DPTR
        ADDC      A,R5
        MOV       DPL,R7
        MOV       DPH,A
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R4,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R5,A
        MOV       A,R4
        MOV       B,#0x9
        MUL       AB
        XCH       A,R4
        MOV       R7,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R7
        MOV       R7,A
        MOV       B,#0x9
        MOV       A,R5
        MUL       AB
        ADD       A,R7
        MOV       R5,A
        MOV       A,#(ApsLinkKeyFrmCntr + 247) & 0xff
        ADD       A,R4
        MOV       DPL,A
        MOV       A,#((ApsLinkKeyFrmCntr - 4617) >> 8) & 0xff
        ADDC      A,R5
        MOV       DPH,A
        LCALL     ?XSTORE_R0123
// 2824 
// 2825             ApsLinkKeyFrmCntr[ZDSecMgrEntries[x].keyNvId - ZCD_NV_APS_LINK_KEY_DATA_START].rxFrmCntr =
// 2826                                             pApsLinkKey->rxFrmCntr;
        MOV       A,?V0
        ADD       A,#0x14
        MOV       DPL,A
        CLR       A
        ADDC      A,?V1
        MOV       DPH,A
        LCALL     ?XLOAD_R0123
        MOV       A,R6
        MOV       R4,A
        MOV       R5,#0x0
        MOV       A,R4
        MOV       B,#0x5
        MUL       AB
        XCH       A,R4
        MOV       R7,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R7
        MOV       R7,A
        MOV       B,#0x5
        MOV       A,R5
        MUL       AB
        ADD       A,R7
        MOV       R5,A
        MOV       DPTR,#ZDSecMgrEntries
        MOVX      A,@DPTR
        ADD       A,R4
        MOV       R7,A
        INC       DPTR
        MOVX      A,@DPTR
        ADDC      A,R5
        MOV       DPL,R7
        MOV       DPH,A
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R4,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R5,A
        MOV       A,R4
        MOV       B,#0x9
        MUL       AB
        XCH       A,R4
        MOV       R7,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R7
        MOV       R7,A
        MOV       B,#0x9
        MOV       A,R5
        MUL       AB
        ADD       A,R7
        MOV       R5,A
        MOV       A,#(ApsLinkKeyFrmCntr + 251) & 0xff
        ADD       A,R4
        MOV       DPL,A
        MOV       A,#((ApsLinkKeyFrmCntr - 4613) >> 8) & 0xff
        ADDC      A,R5
        MOV       DPH,A
        LCALL     ?XSTORE_R0123
// 2827 
// 2828             osal_nv_write( ZDSecMgrEntries[x].keyNvId, 0,
// 2829                           sizeof(APSME_LinkKeyData_t), pApsLinkKey );
        ; Setup parameters for call to function osal_nv_write
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 20)
        MOV       ?V2,#0x18
        MOV       ?V3,#0x0
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 22)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       A,R6
        MOV       R0,A
        MOV       R1,#0x0
        MOV       A,R0
        MOV       B,#0x5
        MUL       AB
        XCH       A,R0
        MOV       R2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R2
        MOV       R2,A
        MOV       B,#0x5
        MOV       A,R1
        MUL       AB
        ADD       A,R2
        MOV       R1,A
        MOV       DPTR,#ZDSecMgrEntries
        MOVX      A,@DPTR
        ADD       A,R0
        MOV       R2,A
        INC       DPTR
        MOVX      A,@DPTR
        ADDC      A,R1
        MOV       DPL,R2
        MOV       DPH,A
        INC       DPTR
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R2,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R3,A
        LCALL     `??osal_nv_write::?relay`; Banked call to: osal_nv_write
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 18)
        MOV       A,R1
// 2830 
// 2831             // clear copy of key in RAM
// 2832             osal_memset(pApsLinkKey, 0x00, sizeof(APSME_LinkKeyData_t));
        ; Setup parameters for call to function osal_memset
        MOV       R4,#0x18
        MOV       R5,#0x0
        MOV       R1,#0x0
        MOV       R2,?V0
        MOV       R3,?V1
        LCALL     `??osal_memset::?relay`; Banked call to: osal_memset
// 2833           }
// 2834         }
// 2835       }
// 2836     }
??ZDSecMgrRestoreFromNV_3:
        INC       R6
        LJMP      ??ZDSecMgrRestoreFromNV_1 & 0xFFFF
// 2837 
// 2838     if (pApsLinkKey != NULL)
??ZDSecMgrRestoreFromNV_2:
        MOV       A,?V0
        ORL       A,?V1
        JZ        ??ZDSecMgrRestoreFromNV_0
// 2839     {
// 2840       osal_mem_free(pApsLinkKey);
        ; Setup parameters for call to function osal_mem_free
        MOV       R2,?V0
        MOV       R3,?V1
        LCALL     `??osal_mem_free::?relay`; Banked call to: osal_mem_free
// 2841     }
// 2842   }
// 2843 
// 2844   osal_nv_read( ZCD_NV_TRUSTCENTER_ADDR, 0, Z_EXTADDR_LEN, zgApsTrustCenterAddr );
??ZDSecMgrRestoreFromNV_0:
        ; Setup parameters for call to function osal_nv_read
        MOV       ?V2,#zgApsTrustCenterAddr & 0xff
        MOV       ?V3,#(zgApsTrustCenterAddr >> 8) & 0xff
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 20)
        MOV       ?V2,#0x8
        MOV       ?V3,#0x0
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 22)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       R2,#0x71
        MOV       R3,#0x0
        LCALL     `??osal_nv_read::?relay`; Banked call to: osal_nv_read
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 18)
        MOV       A,R1
// 2845 }
        MOV       A,#0x2
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 16)
        MOV       R7,#0x8
        LJMP      ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock54
// 2846 #endif // NV_RESTORE
// 2847 
// 2848 /*********************************************************************
// 2849  * @fn          ZDSecMgrSetDefaultNV
// 2850  *
// 2851  * @brief       Write the defaults to NV for Entry table and for APS key data table
// 2852  *
// 2853  * @param       none
// 2854  *
// 2855  * @return      none
// 2856  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 2857 void ZDSecMgrSetDefaultNV( void )
ZDSecMgrSetDefaultNV:
          CFI Block cfiBlock55 Using cfiCommon0
          CFI Function ZDSecMgrSetDefaultNV
        CODE
// 2858 {
        FUNCALL ZDSecMgrSetDefaultNV, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 23, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 23, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSetDefaultNV, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 19, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 19, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSetDefaultNV, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 23, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 23, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSetDefaultNV, osal_mem_alloc
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 19, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 19, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSetDefaultNV, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 19, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 19, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSetDefaultNV, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 23, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 23, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSetDefaultNV, osal_mem_free
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 19, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 19, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        REQUIRE ?V2
        REQUIRE ?V3
        MOV       A,#-0xc
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 12)
        ; Saved register size: 12
        ; Auto size: 7
        MOV       A,#-0x7
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 19)
// 2859   uint16 i;
// 2860   nvDeviceListHdr_t hdr;
// 2861   ZDSecMgrEntry_t secMgrEntry;
// 2862   APSME_LinkKeyData_t *pApsLinkKey = NULL;
        MOV       ?V0,#0x0
        MOV       ?V1,#0x0
// 2863 
// 2864   // Initialize the header
// 2865   hdr.numRecs = 0;
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
// 2866 
// 2867   // clear the header
// 2868   osal_nv_write(ZCD_NV_APS_LINK_KEY_TABLE, 0, sizeof(nvDeviceListHdr_t), &hdr);
        ; Setup parameters for call to function osal_nv_write
        MOV       R0,?XSP + 0
        MOV       R1,?XSP + 1
        MOV       ?V2,R0
        MOV       ?V3,R1
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 21)
        MOV       ?V2,#0x2
        MOV       ?V3,#0x0
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 23)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       R2,#0x4c
        MOV       R3,#0x0
        LCALL     `??osal_nv_write::?relay`; Banked call to: osal_nv_write
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 19)
        MOV       A,R1
// 2869 
// 2870   osal_memset( &secMgrEntry, 0x00, sizeof(ZDSecMgrEntry_t) );
        ; Setup parameters for call to function osal_memset
        MOV       R4,#0x5
        MOV       R5,#0x0
        MOV       R1,#0x0
        MOV       A,#0x2
        LCALL     ?XSTACK_DISP101_8
        LCALL     `??osal_memset::?relay`; Banked call to: osal_memset
// 2871 
// 2872   for ( i = 0; i < ZDSECMGR_ENTRY_MAX; i++ )
        MOV       R6,#0x0
        MOV       R7,#0x0
??ZDSecMgrSetDefaultNV_0:
        CLR       C
        MOV       A,R6
        SUBB      A,#0x3
        MOV       A,R7
        SUBB      A,#0x0
        JNC       ??ZDSecMgrSetDefaultNV_1
// 2873   {
// 2874     // Clear the record
// 2875     osal_nv_write( ZCD_NV_APS_LINK_KEY_TABLE,
// 2876                 (uint16)((sizeof(nvDeviceListHdr_t)) + (i * sizeof(ZDSecMgrEntry_t))),
// 2877                         sizeof(ZDSecMgrEntry_t), &secMgrEntry );
        ; Setup parameters for call to function osal_nv_write
        MOV       A,#0x2
        LCALL     ?XSTACK_DISP100_8
        MOV       ?V2,R0
        MOV       ?V3,R1
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 21)
        MOV       ?V2,#0x5
        MOV       ?V3,#0x0
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 23)
        MOV       A,R6
        MOV       R0,A
        MOV       A,R7
        MOV       R1,A
        MOV       A,R0
        MOV       B,#0x5
        MUL       AB
        XCH       A,R0
        MOV       R2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R2
        MOV       R2,A
        MOV       B,#0x5
        MOV       A,R1
        MUL       AB
        ADD       A,R2
        MOV       R1,A
        MOV       A,R0
        ADD       A,#0x2
        MOV       R4,A
        CLR       A
        ADDC      A,R1
        MOV       R5,A
        MOV       R2,#0x4c
        MOV       R3,#0x0
        LCALL     `??osal_nv_write::?relay`; Banked call to: osal_nv_write
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 19)
        MOV       A,R1
// 2878   }
        INC       R6
        MOV       A,R6
        JNZ       ??ZDSecMgrSetDefaultNV_0
        INC       R7
        SJMP      ??ZDSecMgrSetDefaultNV_0
// 2879 
// 2880   pApsLinkKey = (APSME_LinkKeyData_t *)osal_mem_alloc(sizeof(APSME_LinkKeyData_t));
??ZDSecMgrSetDefaultNV_1:
        ; Setup parameters for call to function osal_mem_alloc
        MOV       R2,#0x18
        MOV       R3,#0x0
        LCALL     `??osal_mem_alloc::?relay`; Banked call to: osal_mem_alloc
        MOV       ?V2,R2
        MOV       ?V3,R3
        MOV       ?V0,?V2
        MOV       ?V1,?V3
// 2881 
// 2882   if (pApsLinkKey != NULL)
        MOV       A,?V0
        ORL       A,?V1
        JZ        ??ZDSecMgrSetDefaultNV_2
// 2883   {
// 2884     osal_memset( pApsLinkKey, 0x00, sizeof(APSME_LinkKeyData_t) );
        ; Setup parameters for call to function osal_memset
        MOV       R4,#0x18
        MOV       R5,#0x0
        MOV       R1,#0x0
        MOV       R2,?V0
        MOV       R3,?V1
        LCALL     `??osal_memset::?relay`; Banked call to: osal_memset
// 2885 
// 2886     for ( i = 0; i < ZDSECMGR_ENTRY_MAX; i++ )
        MOV       R6,#0x0
        MOV       R7,#0x0
??ZDSecMgrSetDefaultNV_3:
        CLR       C
        MOV       A,R6
        SUBB      A,#0x3
        MOV       A,R7
        SUBB      A,#0x0
        JNC       ??ZDSecMgrSetDefaultNV_4
// 2887     {
// 2888       // Clear the record
// 2889       osal_nv_write( (ZCD_NV_APS_LINK_KEY_DATA_START + i), 0,
// 2890                     sizeof(APSME_LinkKeyData_t), pApsLinkKey);
        ; Setup parameters for call to function osal_nv_write
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 21)
        MOV       ?V2,#0x18
        MOV       ?V3,#0x0
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 23)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       A,R6
        ADD       A,#0x1
        MOV       R2,A
        MOV       A,R7
        ADDC      A,#0x2
        MOV       R3,A
        LCALL     `??osal_nv_write::?relay`; Banked call to: osal_nv_write
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 19)
        MOV       A,R1
// 2891     }
        INC       R6
        MOV       A,R6
        JNZ       ??ZDSecMgrSetDefaultNV_3
        INC       R7
        SJMP      ??ZDSecMgrSetDefaultNV_3
// 2892 
// 2893     osal_mem_free(pApsLinkKey);
??ZDSecMgrSetDefaultNV_4:
        ; Setup parameters for call to function osal_mem_free
        MOV       R2,?V0
        MOV       R3,?V1
        LCALL     `??osal_mem_free::?relay`; Banked call to: osal_mem_free
// 2894   }
// 2895 }
??ZDSecMgrSetDefaultNV_2:
        MOV       A,#0x7
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 12)
        MOV       R7,#0x4
        LJMP      ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock55
// 2896 
// 2897 #if defined ( NV_RESTORE )
// 2898 /*********************************************************************
// 2899  * @fn      ZDSecMgrUpdateNV()
// 2900  *
// 2901  * @brief   Updates one entry of the APS link key table to NV
// 2902  *
// 2903  * @param   index - to the entry in security manager table
// 2904  *
// 2905  * @return  none
// 2906  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 2907 static void ZDSecMgrUpdateNV( uint16 index )
ZDSecMgrUpdateNV:
          CFI Block cfiBlock56 Using cfiCommon0
          CFI Function ZDSecMgrUpdateNV
        CODE
// 2908 {
        FUNCALL ZDSecMgrUpdateNV, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 16, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 16, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrUpdateNV, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 16, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 16, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrUpdateNV, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 16, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 16, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        MOV       A,#-0xa
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 10)
        ; Saved register size: 10
        ; Auto size: 2
        MOV       A,#-0x2
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 12)
        MOV       A,R2
        MOV       R6,A
        MOV       A,R3
        MOV       R7,A
// 2909   nvDeviceListHdr_t hdr;
// 2910 
// 2911   if (ZDSecMgrEntries != NULL)
        MOV       DPTR,#ZDSecMgrEntries
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       A,R0
        ORL       A,R1
        JZ        ??ZDSecMgrUpdateNV_0
// 2912   {
// 2913     // Save off the record
// 2914     osal_nv_write( ZCD_NV_APS_LINK_KEY_TABLE,
// 2915                    (uint16)((sizeof(nvDeviceListHdr_t)) + (index * sizeof(ZDSecMgrEntry_t))),
// 2916                    sizeof(ZDSecMgrEntry_t), &ZDSecMgrEntries[index] );
        ; Setup parameters for call to function osal_nv_write
        MOV       A,R6
        MOV       R0,A
        MOV       A,R7
        MOV       R1,A
        MOV       A,R0
        MOV       B,#0x5
        MUL       AB
        XCH       A,R0
        MOV       R2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R2
        MOV       R2,A
        MOV       B,#0x5
        MOV       A,R1
        MUL       AB
        ADD       A,R2
        MOV       R1,A
        MOV       DPTR,#ZDSecMgrEntries
        MOVX      A,@DPTR
        ADD       A,R0
        MOV       ?V0,A
        INC       DPTR
        MOVX      A,@DPTR
        ADDC      A,R1
        MOV       ?V1,A
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 14)
        MOV       ?V0,#0x5
        MOV       ?V1,#0x0
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 16)
        MOV       A,R6
        MOV       R0,A
        MOV       A,R7
        MOV       R1,A
        MOV       A,R0
        MOV       B,#0x5
        MUL       AB
        XCH       A,R0
        MOV       R2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R2
        MOV       R2,A
        MOV       B,#0x5
        MOV       A,R1
        MUL       AB
        ADD       A,R2
        MOV       R1,A
        MOV       A,R0
        ADD       A,#0x2
        MOV       R4,A
        CLR       A
        ADDC      A,R1
        MOV       R5,A
        MOV       R2,#0x4c
        MOV       R3,#0x0
        LCALL     `??osal_nv_write::?relay`; Banked call to: osal_nv_write
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 12)
        MOV       A,R1
// 2917   }
// 2918 
// 2919   if (osal_nv_read(ZCD_NV_APS_LINK_KEY_TABLE, 0, sizeof(nvDeviceListHdr_t), &hdr) == ZSUCCESS)
??ZDSecMgrUpdateNV_0:
        ; Setup parameters for call to function osal_nv_read
        MOV       R0,?XSP + 0
        MOV       R1,?XSP + 1
        MOV       ?V0,R0
        MOV       ?V1,R1
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 14)
        MOV       ?V0,#0x2
        MOV       ?V1,#0x0
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 16)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       R2,#0x4c
        MOV       R3,#0x0
        LCALL     `??osal_nv_read::?relay`; Banked call to: osal_nv_read
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 12)
        MOV       A,R1
        JZ        $+5
        LJMP      ??ZDSecMgrUpdateNV_1 & 0xFFFF
// 2920   {
// 2921     if ( ZDSecMgrEntries[index].ami == INVALID_NODE_ADDR )
        MOV       A,R6
        MOV       R0,A
        MOV       A,R7
        MOV       R1,A
        MOV       A,R0
        MOV       B,#0x5
        MUL       AB
        XCH       A,R0
        MOV       R2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R2
        MOV       R2,A
        MOV       B,#0x5
        MOV       A,R1
        MUL       AB
        ADD       A,R2
        MOV       R1,A
        MOV       DPTR,#ZDSecMgrEntries
        MOVX      A,@DPTR
        ADD       A,R0
        MOV       R2,A
        INC       DPTR
        MOVX      A,@DPTR
        ADDC      A,R1
        MOV       DPL,R2
        MOV       DPH,A
        MOVX      A,@DPTR
        XRL       A,#0xfe
        JNZ       ??ZDSecMgrUpdateNV_2
        INC       DPTR
        MOVX      A,@DPTR
        XRL       A,#0xff
??ZDSecMgrUpdateNV_2:
        JNZ       ??ZDSecMgrUpdateNV_3
// 2922     {
// 2923       if (hdr.numRecs > 0)
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOVX      A,@DPTR
        MOV       R0,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       R1,A
        MOV       A,R0
        ORL       A,R1
        JZ        ??ZDSecMgrUpdateNV_4
// 2924       {
// 2925         hdr.numRecs--;
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOVX      A,@DPTR
        ADD       A,#-0x1
        MOVX      @DPTR,A
        INC       DPTR
        MOVX      A,@DPTR
        ADDC      A,#-0x1
        MOVX      @DPTR,A
        SJMP      ??ZDSecMgrUpdateNV_4
// 2926       }
// 2927     }
// 2928     else
// 2929     {
// 2930       hdr.numRecs++;
??ZDSecMgrUpdateNV_3:
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOVX      A,@DPTR
        ADD       A,#0x1
        MOVX      @DPTR,A
        INC       DPTR
        MOVX      A,@DPTR
        ADDC      A,#0x0
        MOVX      @DPTR,A
// 2931     }
// 2932 
// 2933     // Save off the header
// 2934     osal_nv_write( ZCD_NV_APS_LINK_KEY_TABLE, 0, sizeof( nvDeviceListHdr_t ), &hdr );
??ZDSecMgrUpdateNV_4:
        ; Setup parameters for call to function osal_nv_write
        MOV       R0,?XSP + 0
        MOV       R1,?XSP + 1
        MOV       ?V0,R0
        MOV       ?V1,R1
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 14)
        MOV       ?V0,#0x2
        MOV       ?V1,#0x0
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 16)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       R2,#0x4c
        MOV       R3,#0x0
        LCALL     `??osal_nv_write::?relay`; Banked call to: osal_nv_write
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 12)
        MOV       A,R1
// 2935   }
// 2936 }
??ZDSecMgrUpdateNV_1:
        MOV       A,#0x2
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 10)
        MOV       R7,#0x2
        LJMP      ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock56
// 2937 #endif // NV_RESTORE
// 2938 
// 2939 /******************************************************************************
// 2940  * @fn          ZDSecMgrAPSRemove
// 2941  *
// 2942  * @brief       Remove device from network.
// 2943  *
// 2944  * @param       nwkAddr - device's NWK address
// 2945  * @param       extAddr - device's Extended address
// 2946  * @param       parentAddr - parent's NWK address
// 2947  *
// 2948  * @return      ZStatus_t
// 2949  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 2950 ZStatus_t ZDSecMgrAPSRemove( uint16 nwkAddr, uint8 *extAddr, uint16 parentAddr )
ZDSecMgrAPSRemove:
          CFI Block cfiBlock57 Using cfiCommon0
          CFI Function ZDSecMgrAPSRemove
        CODE
// 2951 {
        FUNCALL ZDSecMgrAPSRemove, ZDSecMgrDeviceRemove
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 20, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 20, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        REQUIRE ?V2
        REQUIRE ?V3
        MOV       A,#-0xc
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 12)
        ; Saved register size: 12
        ; Auto size: 8
        MOV       A,#-0x8
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 20)
        MOV       ?V0,R2
        MOV       ?V1,R3
        MOV       A,R4
        MOV       R6,A
        MOV       A,R5
        MOV       R7,A
        MOV       A,#0x14
        LCALL     ?XSTACK_DISP0_8
        MOVX      A,@DPTR
        MOV       ?V2,A
        INC       DPTR
        MOVX      A,@DPTR
        MOV       ?V3,A
// 2952   ZDSecMgrDevice_t device;
// 2953 
// 2954   if ( ( nwkAddr == INVALID_NODE_ADDR ) ||
// 2955        ( extAddr == NULL )              ||
// 2956        ( parentAddr == INVALID_NODE_ADDR ) )
        MOV       A,#-0x2
        XRL       A,?V0
        JNZ       ??ZDSecMgrAPSRemove_0
        MOV       A,#-0x1
        XRL       A,?V1
??ZDSecMgrAPSRemove_0:
        JZ        ??ZDSecMgrAPSRemove_1
        MOV       A,R6
        ORL       A,R7
        JZ        ??ZDSecMgrAPSRemove_1
        MOV       A,#-0x2
        XRL       A,?V2
        JNZ       ??ZDSecMgrAPSRemove_2
        MOV       A,#-0x1
        XRL       A,?V3
??ZDSecMgrAPSRemove_2:
        JNZ       ??ZDSecMgrAPSRemove_3
// 2957   {
// 2958     return ( ZFailure );
??ZDSecMgrAPSRemove_1:
        MOV       R1,#0x1
        SJMP      ??ZDSecMgrAPSRemove_4
// 2959   }
// 2960 
// 2961   device.nwkAddr = nwkAddr;
??ZDSecMgrAPSRemove_3:
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOV       A,?V0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,?V1
        MOVX      @DPTR,A
// 2962   device.extAddr = extAddr;
        MOV       A,#0x2
        LCALL     ?XSTACK_DISP0_8
        MOV       A,R6
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R7
        MOVX      @DPTR,A
// 2963   device.parentAddr = parentAddr;
        MOV       A,#0x4
        LCALL     ?XSTACK_DISP0_8
        MOV       A,?V2
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,?V3
        MOVX      @DPTR,A
// 2964 
// 2965   // remove device
// 2966   ZDSecMgrDeviceRemove( &device );
        ; Setup parameters for call to function ZDSecMgrDeviceRemove
        MOV       R2,?XSP + 0
        MOV       R3,?XSP + 1
        LCALL     `??ZDSecMgrDeviceRemove::?relay`; Banked call to: ZDSecMgrDeviceRemove
// 2967 
// 2968   return ( ZSuccess );
        MOV       R1,#0x0
??ZDSecMgrAPSRemove_4:
        MOV       A,#0x8
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 12)
        MOV       R7,#0x4
        LJMP      ?BANKED_LEAVE_XDATA
// 2969 }
          CFI EndBlock cfiBlock57
// 2970 
// 2971 /******************************************************************************
// 2972  * @fn          APSME_TCLinkKeyInit
// 2973  *
// 2974  * @brief       Initialize the NV table for preconfigured TC link key
// 2975  *
// 2976  *              When zgUseDefaultTCL is set to TRUE, the default preconfig
// 2977  *              Trust Center Link Key is written to NV. A single tclk is used
// 2978  *              by all devices joining the network.
// 2979  *
// 2980  * @param       setDefault - TRUE to set default values
// 2981  *
// 2982  * @return      none
// 2983  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 2984 void APSME_TCLinkKeyInit(uint8 setDefault)
APSME_TCLinkKeyInit:
          CFI Block cfiBlock58 Using cfiCommon0
          CFI Function APSME_TCLinkKeyInit
        CODE
// 2985 {
        FUNCALL APSME_TCLinkKeyInit, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 35, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 35, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeyInit, osal_nv_item_init
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 37, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 37, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeyInit, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 39, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 39, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeyInit, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 39, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 39, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeyInit, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 39, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 39, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeyInit, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 35, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 35, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeyInit, APSME_EraseICEntry
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 35, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 35, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        REQUIRE ?V2
        REQUIRE ?V3
        REQUIRE ?V4
        REQUIRE ?V5
        REQUIRE ?V6
        REQUIRE ?V7
        MOV       A,#-0x10
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 16)
        ; Saved register size: 16
        ; Auto size: 19
        MOV       A,#-0x13
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 35)
        MOV       ?V0,R1
// 2986   APSME_TCLKDevEntry_t TCLKDevEntry;
// 2987   uint8                rtrn;
// 2988   uint16               i;
// 2989   
// 2990   // Clear the data for the keys
// 2991   osal_memset( &TCLKDevEntry, 0x00, sizeof(APSME_TCLKDevEntry_t) );
        ; Setup parameters for call to function osal_memset
        MOV       R4,#0x13
        MOV       R5,#0x0
        MOV       R1,#0x0
        MOV       R2,?XSP + 0
        MOV       R3,?XSP + 1
        LCALL     `??osal_memset::?relay`; Banked call to: osal_memset
// 2992   TCLKDevEntry.keyAttributes = ZG_DEFAULT_KEY;
        MOV       A,#0x10
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#-0x1
        MOVX      @DPTR,A
// 2993   
// 2994   // Initialize all NV items
// 2995   for( i = 0; i < gZDSECMGR_TC_DEVICE_MAX; i++ )
        MOV       R6,#0x0
        MOV       R7,#0x0
??APSME_TCLinkKeyInit_0:
        MOV       DPTR,#gZDSECMGR_TC_DEVICE_MAX
        CLR       A
        MOVC      A,@A+DPTR
        MOV       R0,A
        MOV       A,#0x1
        MOVC      A,@A+DPTR
        MOV       R1,A
        CLR       C
        MOV       A,R6
        SUBB      A,R0
        MOV       A,R7
        SUBB      A,R1
        JC        $+5
        LJMP      ??APSME_TCLinkKeyInit_1 & 0xFFFF
// 2996   {
// 2997     // If the item doesn't exist in NV memory, create and initialize
// 2998     // it with the default value passed in, either defaultTCLK or 0
// 2999     rtrn = osal_nv_item_init( (ZCD_NV_TCLK_TABLE_START + i),
// 3000                                sizeof(APSME_TCLKDevEntry_t), &TCLKDevEntry);
        ; Setup parameters for call to function osal_nv_item_init
        MOV       R0,?XSP + 0
        MOV       R1,?XSP + 1
        MOV       ?V2,R0
        MOV       ?V3,R1
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 37)
        MOV       R4,#0x13
        MOV       R5,#0x0
        MOV       A,R6
        ADD       A,#0x11
        MOV       R2,A
        MOV       A,R7
        ADDC      A,#0x1
        MOV       R3,A
        LCALL     `??osal_nv_item_init::?relay`; Banked call to: osal_nv_item_init
        MOV       A,#0x2
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 35)
        MOV       A,R1
        MOV       ?V1,A
// 3001 
// 3002     if (rtrn == SUCCESS)
        MOV       A,?V1
        JZ        $+5
        LJMP      ??APSME_TCLinkKeyInit_2 & 0xFFFF
// 3003     {
// 3004       if(setDefault)
        MOV       A,?V0
        JNZ       $+5
        LJMP      ??APSME_TCLinkKeyInit_3 & 0xFFFF
// 3005       {
// 3006         //Force to initialize the entry
// 3007         osal_nv_write(ZCD_NV_TCLK_TABLE_START + i, 0, sizeof(APSME_TCLKDevEntry_t), &TCLKDevEntry);
        ; Setup parameters for call to function osal_nv_write
        MOV       R0,?XSP + 0
        MOV       R1,?XSP + 1
        MOV       ?V2,R0
        MOV       ?V3,R1
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 37)
        MOV       ?V2,#0x13
        MOV       ?V3,#0x0
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 39)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       A,R6
        ADD       A,#0x11
        MOV       R2,A
        MOV       A,R7
        ADDC      A,#0x1
        MOV       R3,A
        LCALL     `??osal_nv_write::?relay`; Banked call to: osal_nv_write
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 35)
        MOV       A,R1
// 3008         TCLinkKeyFrmCntr[i].txFrmCntr = 0;
        MOV       A,R6
        MOV       R0,A
        MOV       A,R7
        MOV       R1,A
        MOV       A,R0
        MOV       B,#0x9
        MUL       AB
        XCH       A,R0
        MOV       R2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R2
        MOV       R2,A
        MOV       B,#0x9
        MOV       A,R1
        MUL       AB
        ADD       A,R2
        MOV       R1,A
        MOV       A,#TCLinkKeyFrmCntr & 0xff
        ADD       A,R0
        MOV       DPL,A
        MOV       A,#(TCLinkKeyFrmCntr >> 8) & 0xff
        ADDC      A,R1
        MOV       DPH,A
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
// 3009         TCLinkKeyFrmCntr[i].rxFrmCntr = 0;
        MOV       A,R6
        MOV       R0,A
        MOV       A,R7
        MOV       R1,A
        MOV       A,R0
        MOV       B,#0x9
        MUL       AB
        XCH       A,R0
        MOV       R2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R2
        MOV       R2,A
        MOV       B,#0x9
        MOV       A,R1
        MUL       AB
        ADD       A,R2
        MOV       R1,A
        MOV       A,#(TCLinkKeyFrmCntr + 4) & 0xff
        ADD       A,R0
        MOV       DPL,A
        MOV       A,#((TCLinkKeyFrmCntr + 4) >> 8) & 0xff
        ADDC      A,R1
        MOV       DPH,A
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
        LJMP      ??APSME_TCLinkKeyInit_2 & 0xFFFF
// 3010       }
// 3011       else
// 3012       {
// 3013         // set the Frame counters to 0 to existing keys in NV
// 3014         osal_nv_read( ( ZCD_NV_TCLK_TABLE_START + i), 0,
// 3015                        sizeof(APSME_TCLKDevEntry_t), &TCLKDevEntry );
??APSME_TCLinkKeyInit_3:
        ; Setup parameters for call to function osal_nv_read
        MOV       R0,?XSP + 0
        MOV       R1,?XSP + 1
        MOV       ?V2,R0
        MOV       ?V3,R1
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 37)
        MOV       ?V2,#0x13
        MOV       ?V3,#0x0
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 39)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       A,R6
        ADD       A,#0x11
        MOV       R2,A
        MOV       A,R7
        ADDC      A,#0x1
        MOV       R3,A
        LCALL     `??osal_nv_read::?relay`; Banked call to: osal_nv_read
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 35)
        MOV       A,R1
// 3016 
// 3017         // increase the value stored in NV
// 3018         TCLKDevEntry.txFrmCntr += ( MAX_TCLK_FRAMECOUNTER_CHANGES + 1 );
        MOV       DPTR,#__Constant_b
        MOV       R0,#?V4
        LCALL     ?L_MOV_X
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOV       R0,#?V4
        LCALL     ?L_ADD_TO_X
// 3019 
// 3020         osal_nv_write( ( ZCD_NV_TCLK_TABLE_START + i), 0,
// 3021                         sizeof(APSME_TCLKDevEntry_t), &TCLKDevEntry );
        ; Setup parameters for call to function osal_nv_write
        MOV       R0,?XSP + 0
        MOV       R1,?XSP + 1
        MOV       ?V2,R0
        MOV       ?V3,R1
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 37)
        MOV       ?V2,#0x13
        MOV       ?V3,#0x0
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 39)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       A,R6
        ADD       A,#0x11
        MOV       R2,A
        MOV       A,R7
        ADDC      A,#0x1
        MOV       R3,A
        LCALL     `??osal_nv_write::?relay`; Banked call to: osal_nv_write
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 35)
        MOV       A,R1
// 3022 
// 3023         // set initial values for counters in RAM
// 3024         TCLinkKeyFrmCntr[i].txFrmCntr = TCLKDevEntry.txFrmCntr;
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        LCALL     ?XLOAD_R0123
        MOV       A,R6
        MOV       R4,A
        MOV       A,R7
        MOV       R5,A
        MOV       A,R4
        MOV       B,#0x9
        MUL       AB
        XCH       A,R4
        MOV       ?V2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,?V2
        MOV       ?V2,A
        MOV       B,#0x9
        MOV       A,R5
        MUL       AB
        ADD       A,?V2
        MOV       R5,A
        MOV       A,#TCLinkKeyFrmCntr & 0xff
        ADD       A,R4
        MOV       DPL,A
        MOV       A,#(TCLinkKeyFrmCntr >> 8) & 0xff
        ADDC      A,R5
        MOV       DPH,A
        LCALL     ?XSTORE_R0123
// 3025         TCLinkKeyFrmCntr[i].rxFrmCntr = TCLKDevEntry.rxFrmCntr;
        MOV       A,#0x4
        LCALL     ?XSTACK_DISP0_8
        LCALL     ?XLOAD_R0123
        MOV       A,R6
        MOV       R4,A
        MOV       A,R7
        MOV       R5,A
        MOV       A,R4
        MOV       B,#0x9
        MUL       AB
        XCH       A,R4
        MOV       ?V2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,?V2
        MOV       ?V2,A
        MOV       B,#0x9
        MOV       A,R5
        MUL       AB
        ADD       A,?V2
        MOV       R5,A
        MOV       A,#(TCLinkKeyFrmCntr + 4) & 0xff
        ADD       A,R4
        MOV       DPL,A
        MOV       A,#((TCLinkKeyFrmCntr + 4) >> 8) & 0xff
        ADDC      A,R5
        MOV       DPH,A
        LCALL     ?XSTORE_R0123
// 3026         
// 3027         // Making sure data is cleared and set to default for every key all the time
// 3028         osal_memset( &TCLKDevEntry, 0x00, sizeof(APSME_TCLKDevEntry_t) );
        ; Setup parameters for call to function osal_memset
        MOV       R4,#0x13
        MOV       R5,#0x0
        MOV       R1,#0x0
        MOV       R2,?XSP + 0
        MOV       R3,?XSP + 1
        LCALL     `??osal_memset::?relay`; Banked call to: osal_memset
// 3029         TCLKDevEntry.keyAttributes = ZG_DEFAULT_KEY;
        MOV       A,#0x10
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#-0x1
        MOVX      @DPTR,A
// 3030       }
// 3031     }
// 3032   }
??APSME_TCLinkKeyInit_2:
        INC       R6
        MOV       A,R6
        JNZ       ??APSME_TCLinkKeyInit_4
        INC       R7
??APSME_TCLinkKeyInit_4:
        LJMP      ??APSME_TCLinkKeyInit_0 & 0xFFFF
// 3033 
// 3034   if(setDefault)
??APSME_TCLinkKeyInit_1:
        MOV       A,?V0
        JZ        ??APSME_TCLinkKeyInit_5
// 3035   {
// 3036     //Force to erase all IC
// 3037     APSME_EraseICEntry(NULL);
        ; Setup parameters for call to function APSME_EraseICEntry
        MOV       R2,#0x0
        MOV       R3,#0x0
        LCALL     `??APSME_EraseICEntry::?relay`; Banked call to: APSME_EraseICEntry
// 3038   }
// 3039 }
??APSME_TCLinkKeyInit_5:
        MOV       A,#0x13
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 16)
        MOV       R7,#0x8
        LJMP      ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock58
// 3040 
// 3041 
// 3042 /******************************************************************************
// 3043  * @fn          APSME_TCLinkKeySync
// 3044  *
// 3045  * @brief       Sync Trust Center LINK key data.
// 3046  *
// 3047  * @param       srcAddr - [in] srcAddr
// 3048  * @param       si      - [in, out] SSP_Info_t
// 3049  *
// 3050  * @return      ZStatus_t
// 3051  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 3052 ZStatus_t APSME_TCLinkKeySync( uint16 srcAddr, SSP_Info_t* si )
APSME_TCLinkKeySync:
          CFI Block cfiBlock59 Using cfiCommon0
          CFI Function APSME_TCLinkKeySync
        CODE
// 3053 {
        FUNCALL APSME_TCLinkKeySync, AddrMgrExtAddrValid
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 50, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 50, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeySync, APSME_LookupExtAddr
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 50, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 50, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeySync, APSME_SearchTCLinkKeyEntry
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 52, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 52, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeySync, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 50, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 50, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeySync, APSME_SearchTCLinkKeyEntry
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 52, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 52, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeySync, osal_memcpy
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 53, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 53, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeySync, bdb_doTrustCenterRequireKeyExchange
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 50, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 50, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V2
        REQUIRE ?V3
        REQUIRE ?V4
        REQUIRE ?V5
        REQUIRE ?V6
        REQUIRE ?V7
        REQUIRE ?V8
        REQUIRE ?V9
        REQUIRE ?V10
        REQUIRE ?V11
        REQUIRE ?V12
        REQUIRE ?V13
        MOV       A,#-0x16
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V13 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V12 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V11 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V10 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V9 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V8 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-19)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-20)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-21)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-22)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 22)
        ; Saved register size: 22
        ; Auto size: 28
        MOV       A,#-0x1c
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 50)
        MOV       ?V12,R2
        MOV       ?V13,R3
        MOV       A,R4
        MOV       R6,A
        MOV       A,R5
        MOV       R7,A
// 3054   APSME_TCLKDevEntry_t  TCLKDevEntry;
// 3055   ZStatus_t             status = ZSecNoKey;
        MOV       ?V0,#-0x5f
// 3056   uint32                *tclkRxFrmCntr;
// 3057   uint16                entryIndex = 0xFFFF;
        MOV       ?V2,#-0x1
        MOV       ?V3,#-0x1
// 3058   uint16                selectedId = gZDSECMGR_TC_DEVICE_MAX;
        MOV       DPTR,#gZDSECMGR_TC_DEVICE_MAX
        CLR       A
        MOVC      A,@A+DPTR
        PUSH      A
          CFI CFA_SP SP+-1
        MOV       A,#0x1
        MOVC      A,@A+DPTR
        MOV       DPH,A
        POP       DPL
          CFI CFA_SP SP+0
        MOV       ?V8,DPL
        MOV       ?V9,DPH
// 3059   uint8                 entryFound = FALSE;
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOV       A,#0x0
        MOVX      @DPTR,A
// 3060   
// 3061 #if ZG_BUILD_JOINING_TYPE
// 3062   uint8   defaultEntry[Z_EXTADDR_LEN];
// 3063 #endif
// 3064  
// 3065   // Look up the IEEE address of the trust center if it's available
// 3066   if ( AddrMgrExtAddrValid( si->extAddr ) == FALSE )
        ; Setup parameters for call to function AddrMgrExtAddrValid
        MOV       A,R6
        ADD       A,#0x6
        MOV       R2,A
        CLR       A
        ADDC      A,R7
        MOV       R3,A
        LCALL     `??AddrMgrExtAddrValid::?relay`; Banked call to: AddrMgrExtAddrValid
        MOV       A,R1
        JNZ       ??APSME_TCLinkKeySync_0
// 3067   {
// 3068     APSME_LookupExtAddr( srcAddr, si->extAddr );
        ; Setup parameters for call to function APSME_LookupExtAddr
        MOV       A,R6
        ADD       A,#0x6
        MOV       R4,A
        CLR       A
        ADDC      A,R7
        MOV       R5,A
        MOV       R2,?V12
        MOV       R3,?V13
        LCALL     `??APSME_LookupExtAddr::?relay`; Banked call to: APSME_LookupExtAddr
        MOV       A,R1
// 3069   }
// 3070 
// 3071   entryIndex = APSME_SearchTCLinkKeyEntry(si->extAddr,&entryFound,&TCLKDevEntry);
??APSME_TCLinkKeySync_0:
        ; Setup parameters for call to function APSME_SearchTCLinkKeyEntry
        MOV       A,#0x9
        LCALL     ?XSTACK_DISP100_8
        MOV       ?V4,R0
        MOV       ?V5,R1
        MOV       R0,#?V4
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 52)
        MOV       A,#0x2
        LCALL     ?XSTACK_DISP102_8
        MOV       A,R6
        ADD       A,#0x6
        MOV       R2,A
        CLR       A
        ADDC      A,R7
        MOV       R3,A
        LCALL     `??APSME_SearchTCLinkKeyEntry::?relay`; Banked call to: APSME_SearchTCLinkKeyEntry
        MOV       A,#0x2
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 50)
        MOV       ?V4,R2
        MOV       ?V5,R3
        MOV       ?V2,?V4
        MOV       ?V3,?V5
// 3072   
// 3073 #if ZG_BUILD_JOINING_TYPE
// 3074   if(ZG_DEVICE_JOINING_TYPE && !entryFound)
        MOV       DPTR,#zgDeviceLogicalType
        MOVX      A,@DPTR
        XRL       A,#0x1
        JZ        ??APSME_TCLinkKeySync_1
        MOV       DPTR,#zgDeviceLogicalType
        MOVX      A,@DPTR
        XRL       A,#0x2
        JNZ       ??APSME_TCLinkKeySync_2
??APSME_TCLinkKeySync_1:
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOVX      A,@DPTR
        JNZ       ??APSME_TCLinkKeySync_2
// 3075   {
// 3076     osal_memset(defaultEntry, 0, Z_EXTADDR_LEN);
        ; Setup parameters for call to function osal_memset
        MOV       R4,#0x8
        MOV       R5,#0x0
        MOV       R1,#0x0
        MOV       A,#0x1
        LCALL     ?XSTACK_DISP101_8
        LCALL     `??osal_memset::?relay`; Banked call to: osal_memset
// 3077     entryIndex = APSME_SearchTCLinkKeyEntry(defaultEntry,&entryFound,&TCLKDevEntry);
        ; Setup parameters for call to function APSME_SearchTCLinkKeyEntry
        MOV       A,#0x9
        LCALL     ?XSTACK_DISP100_8
        MOV       ?V4,R0
        MOV       ?V5,R1
        MOV       R0,#?V4
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 52)
        MOV       A,#0x2
        LCALL     ?XSTACK_DISP102_8
        MOV       A,#0x3
        LCALL     ?XSTACK_DISP101_8
        LCALL     `??APSME_SearchTCLinkKeyEntry::?relay`; Banked call to: APSME_SearchTCLinkKeyEntry
        MOV       A,#0x2
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 50)
        MOV       ?V4,R2
        MOV       ?V5,R3
        MOV       ?V2,?V4
        MOV       ?V3,?V5
// 3078   }
// 3079 #endif
// 3080   
// 3081   if(entryFound)
??APSME_TCLinkKeySync_2:
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOVX      A,@DPTR
        JNZ       $+5
        LJMP      ??APSME_TCLinkKeySync_3 & 0xFFFF
// 3082   {
// 3083     status = ZSuccess;
        MOV       ?V0,#0x0
// 3084     
// 3085     selectedId = entryIndex - ZCD_NV_TCLK_TABLE_START;
        MOV       A,?V2
        ADD       A,#-0x11
        MOV       R0,A
        MOV       A,?V3
        ADDC      A,#-0x2
        MOV       R1,A
        MOV       ?V8,R0
        MOV       ?V9,R1
// 3086 
// 3087     switch(TCLKDevEntry.keyAttributes)
        MOV       A,#0x19
        LCALL     ?XSTACK_DISP0_8
        MOVX      A,@DPTR
        JZ        ??APSME_TCLinkKeySync_4
        DEC       A
        JZ        ??APSME_TCLinkKeySync_5
        DEC       A
        JNZ       $+5
        LJMP      ??APSME_TCLinkKeySync_6 & 0xFFFF
        ADD       A,#0x5
        JNZ       $+5
        LJMP      ??APSME_TCLinkKeySync_6 & 0xFFFF
        ADD       A,#-0x2
        JZ        ??APSME_TCLinkKeySync_7
        LJMP      ??APSME_TCLinkKeySync_8 & 0xFFFF
// 3088     {
// 3089       case ZG_UNVERIFIED_KEY:
// 3090         #if ZG_BUILD_JOINING_TYPE
// 3091         if(ZG_DEVICE_JOINING_TYPE)
??APSME_TCLinkKeySync_5:
        MOV       DPTR,#zgDeviceLogicalType
        MOVX      A,@DPTR
        XRL       A,#0x1
        JZ        ??APSME_TCLinkKeySync_9
        MOV       DPTR,#zgDeviceLogicalType
        MOVX      A,@DPTR
        XRL       A,#0x2
        JNZ       ??APSME_TCLinkKeySync_7
// 3092         {   
// 3093           si->keyNvId = ZCD_NV_TCLK_JOIN_DEV;
??APSME_TCLinkKeySync_9:
        MOV       A,R6
        ADD       A,#0xf
        MOV       DPL,A
        CLR       A
        ADDC      A,R7
        MOV       DPH,A
        MOV       A,#0x2
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x1
        MOVX      @DPTR,A
// 3094           break;
        LJMP      ??APSME_TCLinkKeySync_8 & 0xFFFF
// 3095         }
// 3096         #endif
// 3097       case ZG_DEFAULT_KEY:
// 3098         if(ZG_DEVICE_JOINING_TYPE)
??APSME_TCLinkKeySync_7:
        MOV       DPTR,#zgDeviceLogicalType
        MOVX      A,@DPTR
        XRL       A,#0x1
        JZ        ??APSME_TCLinkKeySync_10
        MOV       DPTR,#zgDeviceLogicalType
        MOVX      A,@DPTR
        XRL       A,#0x2
        JNZ       ??APSME_TCLinkKeySync_11
// 3099         { 
// 3100           //If default was found, then it is joining as FN, then try distributed key as well
// 3101           si->distributedKeyTry = TRUE;
??APSME_TCLinkKeySync_10:
        MOV       A,R6
        ADD       A,#0x20
        MOV       DPL,A
        CLR       A
        ADDC      A,R7
        MOV       DPH,A
        MOV       A,#0x1
        MOVX      @DPTR,A
// 3102         }
// 3103         si->keyNvId = ZCD_NV_TCLK_DEFAULT;
??APSME_TCLinkKeySync_11:
        MOV       A,R6
        ADD       A,#0xf
        MOV       DPL,A
        CLR       A
        ADDC      A,R7
        MOV       DPH,A
        MOV       A,#0x3
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x1
        MOVX      @DPTR,A
// 3104       break;
        LJMP      ??APSME_TCLinkKeySync_8 & 0xFFFF
// 3105       case ZG_PROVISIONAL_KEY:
// 3106         si->keyNvId = ZCD_NV_TCLK_IC_TABLE_START + TCLKDevEntry.SeedShift_IcIndex;
??APSME_TCLinkKeySync_4:
        MOV       A,#0x1b
        LCALL     ?XSTACK_DISP0_8
        MOVX      A,@DPTR
        MOV       R0,A
        MOV       R1,#0x0
        MOV       A,R0
        ADD       A,#0x4
        MOV       R0,A
        MOV       A,R1
        ADDC      A,#0x1
        MOV       R1,A
        MOV       A,R6
        ADD       A,#0xf
        MOV       DPL,A
        CLR       A
        ADDC      A,R7
        MOV       DPH,A
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
// 3107         //Attempt to use default keys (centralized and distributed) if IC fails?
// 3108         si->distributedKeyTry = gZDSECMGR_TC_ATTEMPT_DEFAULT_KEY;
        MOV       DPTR,#gZDSECMGR_TC_ATTEMPT_DEFAULT_KEY
        MOVX      A,@DPTR
        PUSH      A
          CFI CFA_SP SP+-1
        MOV       A,R6
        ADD       A,#0x20
        MOV       DPL,A
        CLR       A
        ADDC      A,R7
        MOV       DPH,A
        POP       A
          CFI CFA_SP SP+0
        MOVX      @DPTR,A
// 3109         si->defaultKeyTry = gZDSECMGR_TC_ATTEMPT_DEFAULT_KEY;
        MOV       DPTR,#gZDSECMGR_TC_ATTEMPT_DEFAULT_KEY
        MOVX      A,@DPTR
        PUSH      A
          CFI CFA_SP SP+-1
        MOV       A,R6
        ADD       A,#0x21
        MOV       DPL,A
        CLR       A
        ADDC      A,R7
        MOV       DPH,A
        POP       A
          CFI CFA_SP SP+0
        MOVX      @DPTR,A
// 3110       break;
        LJMP      ??APSME_TCLinkKeySync_8 & 0xFFFF
// 3111       case ZG_VERIFIED_KEY:
// 3112       case ZG_NON_R21_NWK_JOINED:
// 3113         //Only verify the frame counter for Verified keys, or keys used with non R21 TC
// 3114         tclkRxFrmCntr = &TCLinkKeyFrmCntr[selectedId].rxFrmCntr;
??APSME_TCLinkKeySync_6:
        MOV       R0,?V8
        MOV       R1,?V9
        MOV       A,R0
        MOV       B,#0x9
        MUL       AB
        XCH       A,R0
        MOV       R2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R2
        MOV       R2,A
        MOV       B,#0x9
        MOV       A,R1
        MUL       AB
        ADD       A,R2
        MOV       R1,A
        MOV       A,#(TCLinkKeyFrmCntr + 4) & 0xff
        ADD       A,R0
        MOV       R0,A
        MOV       A,#((TCLinkKeyFrmCntr + 4) >> 8) & 0xff
        ADDC      A,R1
        MOV       R1,A
        MOV       ?V10,R0
        MOV       ?V11,R1
// 3115 
// 3116         if ( si->frmCntr >= *tclkRxFrmCntr )
        MOV       DPL,?V10
        MOV       DPH,?V11
        MOV       R0,#?V4
        LCALL     ?L_MOV_X
        MOV       A,R6
        ADD       A,#0x12
        MOV       DPL,A
        CLR       A
        ADDC      A,R7
        MOV       DPH,A
        MOV       R0,#?V4
        LCALL     ?UL_GT_X
        JC        ??APSME_TCLinkKeySync_12
// 3117         {
// 3118           // update the rx frame counter
// 3119           *tclkRxFrmCntr = si->frmCntr + 1;
        MOV       A,R6
        ADD       A,#0x12
        MOV       DPL,A
        CLR       A
        ADDC      A,R7
        MOV       DPH,A
        MOV       R0,#?V4
        LCALL     ?L_MOV_X
        MOV       DPTR,#__Constant_1
        MOV       R0,#?V4
        LCALL     ?L_ADD_X
        MOV       R2,?V4
        MOV       R3,?V5
        MOV       R4,?V6
        MOV       R5,?V7
        MOV       DPL,?V10
        MOV       DPH,?V11
        MOV       A,R2
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R3
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R4
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R5
        MOVX      @DPTR,A
// 3120           status = ZSuccess;
        MOV       ?V0,#0x0
// 3121           
// 3122           #if ZG_BUILD_JOINING_TYPE
// 3123           if(ZG_DEVICE_JOINING_TYPE)
        MOV       DPTR,#zgDeviceLogicalType
        MOVX      A,@DPTR
        XRL       A,#0x1
        JZ        ??APSME_TCLinkKeySync_13
        MOV       DPTR,#zgDeviceLogicalType
        MOVX      A,@DPTR
        XRL       A,#0x2
        JNZ       ??APSME_TCLinkKeySync_14
// 3124           {   
// 3125             si->keyNvId = ZCD_NV_TCLK_JOIN_DEV;
??APSME_TCLinkKeySync_13:
        MOV       A,R6
        ADD       A,#0xf
        MOV       DPL,A
        CLR       A
        ADDC      A,R7
        MOV       DPH,A
        MOV       A,#0x2
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x1
        MOVX      @DPTR,A
// 3126             break;
        SJMP      ??APSME_TCLinkKeySync_8
// 3127           }
// 3128           #endif
// 3129           #if ZG_BUILD_COORDINATOR_TYPE
// 3130           if(ZG_DEVICE_COORDINATOR_TYPE)
// 3131           {
// 3132             si->keyNvId = ZCD_NV_TCLK_SEED;
// 3133             si->seedShift = TCLKDevEntry.SeedShift_IcIndex;
// 3134           }
// 3135           #endif
// 3136           osal_memcpy(si->dstExtAddr, TCLKDevEntry.extAddr,Z_EXTADDR_LEN);
??APSME_TCLinkKeySync_14:
        ; Setup parameters for call to function osal_memcpy
        MOV       A,#0x11
        LCALL     ?XSTACK_DISP0_8
        MOV       R1,DPL
        MOV       R2,DPH
        MOV       R3,#0x0
        MOV       ?V4,R1
        MOV       ?V5,R2
        MOV       ?V6,R3
        MOV       R0,#?V4
        LCALL     ?PUSH_XSTACK_I_THREE
          CFI CFA_XSP16 add(XSP16, 53)
        MOV       R4,#0x8
        MOV       R5,#0x0
        MOV       A,R6
        ADD       A,#0x18
        MOV       R2,A
        CLR       A
        ADDC      A,R7
        MOV       R3,A
        LCALL     `??osal_memcpy::?relay`; Banked call to: osal_memcpy
        MOV       A,#0x3
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 50)
        SJMP      ??APSME_TCLinkKeySync_8
// 3137         }
// 3138         else
// 3139         {
// 3140           status = ZSecOldFrmCount;
??APSME_TCLinkKeySync_12:
        MOV       ?V0,#-0x5e
// 3141         }
// 3142       break;
        SJMP      ??APSME_TCLinkKeySync_8
// 3143       default:
// 3144         //This should not happen
// 3145       break;
// 3146     }
// 3147   }
// 3148   else
// 3149   {
// 3150     if (ZG_DEVICE_COORDINATOR_TYPE) 
??APSME_TCLinkKeySync_3:
        MOV       DPTR,#zgDeviceLogicalType
        MOVX      A,@DPTR
        JNZ       ??APSME_TCLinkKeySync_8
// 3151     {    
// 3152       if(bdb_doTrustCenterRequireKeyExchange() == FALSE)
        ; Setup parameters for call to function bdb_doTrustCenterRequireKeyExchange
        LCALL     `??bdb_doTrustCenterRequireKeyExchange::?relay`; Banked call to: bdb_doTrustCenterRequireKeyExchange
        MOV       A,R1
        JNZ       ??APSME_TCLinkKeySync_8
// 3153       {
// 3154         //If the TCLK exchange is not mandated, and the key cannot be found for this device, 
// 3155         //is because we have erased the entry. Try with default key.
// 3156         si->keyNvId = ZCD_NV_TCLK_DEFAULT;
        MOV       A,R6
        ADD       A,#0xf
        MOV       DPL,A
        CLR       A
        ADDC      A,R7
        MOV       DPH,A
        MOV       A,#0x3
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x1
        MOVX      @DPTR,A
// 3157         status = ZSuccess;
        MOV       ?V0,#0x0
// 3158       }
// 3159     }
// 3160   }
// 3161   
// 3162   
// 3163   return status;
??APSME_TCLinkKeySync_8:
        MOV       R1,?V0
        MOV       A,#0x1c
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 22)
        MOV       R7,#0xe
        LJMP      ?BANKED_LEAVE_XDATA
// 3164 }
          CFI EndBlock cfiBlock59
// 3165 
// 3166 /******************************************************************************
// 3167  * @fn          APSME_TCLinkKeyLoad
// 3168  *
// 3169  * @brief       Load Trust Center LINK key data.
// 3170  *
// 3171  * @param       dstAddr - [in] dstAddr
// 3172  * @param       si      - [in, out] SSP_Info_t
// 3173  *
// 3174  * @return      ZStatus_t
// 3175  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 3176 ZStatus_t APSME_TCLinkKeyLoad( uint16 dstAddr, SSP_Info_t* si )
APSME_TCLinkKeyLoad:
          CFI Block cfiBlock60 Using cfiCommon0
          CFI Function APSME_TCLinkKeyLoad
        CODE
// 3177 {
        FUNCALL APSME_TCLinkKeyLoad, AddrMgrExtAddrValid
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 57, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 57, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeyLoad, APSME_SearchTCLinkKeyEntry
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 59, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 59, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeyLoad, osal_memcpy
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 60, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 60, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeyLoad, osal_memcpy
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 60, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 60, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeyLoad, osal_rand
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 57, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 57, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeyLoad, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 61, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 61, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeyLoad, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 57, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 57, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeyLoad, osal_set_event
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 57, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 57, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeyLoad, AddrMgrEntryLookupNwk
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 57, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 57, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeyLoad, AddrMgrEntryRelease
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 57, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 57, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        REQUIRE ?V2
        REQUIRE ?V3
        REQUIRE ?V4
        REQUIRE ?V5
        REQUIRE ?V6
        REQUIRE ?V7
        REQUIRE ?V8
        REQUIRE ?V9
        REQUIRE ?V10
        REQUIRE ?V11
        REQUIRE ?V12
        REQUIRE ?V13
        REQUIRE ?V14
        REQUIRE ?V15
        MOV       A,#-0x18
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V15 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V14 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V13 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V12 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V11 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V10 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V9 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V8 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-19)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-20)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-21)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-22)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-23)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-24)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 24)
        ; Saved register size: 24
        ; Auto size: 33
        MOV       A,#-0x21
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 57)
        MOV       ?V14,R2
        MOV       ?V15,R3
        MOV       ?V0,R4
        MOV       ?V1,R5
// 3178   APSME_TCLKDevEntry_t TCLKDevEntry;
// 3179   AddrMgrEntry_t       addrEntry;
// 3180   ZStatus_t            status = ZSecNoKey;
        MOV       ?V2,#-0x5f
// 3181   uint16               entryIndex;
// 3182   uint8                extAddrFound;
// 3183   uint8                found;
// 3184 
// 3185   
// 3186   // Look up the ami of the srcAddr if available
// 3187   addrEntry.user    = ADDRMGR_USER_DEFAULT;
        MOV       A,#0x14
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x0
        MOVX      @DPTR,A
// 3188   addrEntry.nwkAddr = dstAddr;
        MOV       A,#0x15
        LCALL     ?XSTACK_DISP0_8
        MOV       A,?V14
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,?V15
        MOVX      @DPTR,A
// 3189 
// 3190   extAddrFound = AddrMgrExtAddrValid( si->extAddr );
        ; Setup parameters for call to function AddrMgrExtAddrValid
        MOV       A,?V0
        ADD       A,#0x6
        MOV       R2,A
        CLR       A
        ADDC      A,?V1
        MOV       R3,A
        LCALL     `??AddrMgrExtAddrValid::?relay`; Banked call to: AddrMgrExtAddrValid
        MOV       A,R1
        MOV       ?V3,A
// 3191   
// 3192   if(extAddrFound)
        MOV       A,?V3
        JNZ       $+5
        LJMP      ??APSME_TCLinkKeyLoad_0 & 0xFFFF
// 3193   {
// 3194     entryIndex = APSME_SearchTCLinkKeyEntry(si->extAddr,&found,&TCLKDevEntry);
        ; Setup parameters for call to function APSME_SearchTCLinkKeyEntry
        MOV       A,#0x1
        LCALL     ?XSTACK_DISP100_8
        MOV       ?V4,R0
        MOV       ?V5,R1
        MOV       R0,#?V4
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 59)
        MOV       A,#0x2
        LCALL     ?XSTACK_DISP102_8
        MOV       A,?V0
        ADD       A,#0x6
        MOV       R2,A
        CLR       A
        ADDC      A,?V1
        MOV       R3,A
        LCALL     `??APSME_SearchTCLinkKeyEntry::?relay`; Banked call to: APSME_SearchTCLinkKeyEntry
        MOV       A,#0x2
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 57)
        MOV       ?V4,R2
        MOV       ?V5,R3
        MOV       ?V12,?V4
        MOV       ?V13,?V5
// 3195     if(entryIndex != 0xFFFF)
        MOV       A,#-0x1
        XRL       A,?V12
        JNZ       ??APSME_TCLinkKeyLoad_1
        MOV       A,#-0x1
        XRL       A,?V13
??APSME_TCLinkKeyLoad_1:
        JNZ       $+5
        LJMP      ??APSME_TCLinkKeyLoad_2 & 0xFFFF
// 3196     {
// 3197       uint16 i = entryIndex - ZCD_NV_TCLK_TABLE_START;
        MOV       A,?V12
        ADD       A,#-0x11
        MOV       R6,A
        MOV       A,?V13
        ADDC      A,#-0x2
        MOV       R7,A
// 3198       
// 3199       if(found)
        MOV       DPL,?XSP + 0
        MOV       DPH,?XSP + 1
        MOVX      A,@DPTR
        JNZ       $+5
        LJMP      ??APSME_TCLinkKeyLoad_3 & 0xFFFF
// 3200       {
// 3201         switch(TCLKDevEntry.keyAttributes)
        MOV       A,#0x11
        LCALL     ?XSTACK_DISP0_8
        MOVX      A,@DPTR
        JZ        ??APSME_TCLinkKeyLoad_4
        DEC       A
        JZ        ??APSME_TCLinkKeyLoad_5
        DEC       A
        JZ        ??APSME_TCLinkKeyLoad_6
        ADD       A,#0x5
        JZ        ??APSME_TCLinkKeyLoad_7
        ADD       A,#-0x2
        JZ        ??APSME_TCLinkKeyLoad_7
        LJMP      ??APSME_TCLinkKeyLoad_8 & 0xFFFF
// 3202         {
// 3203           case ZG_UNVERIFIED_KEY:
// 3204             #if ZG_BUILD_JOINING_TYPE
// 3205             if(ZG_DEVICE_JOINING_TYPE)
??APSME_TCLinkKeyLoad_5:
        MOV       DPTR,#zgDeviceLogicalType
        MOVX      A,@DPTR
        XRL       A,#0x1
        JZ        ??APSME_TCLinkKeyLoad_9
        MOV       DPTR,#zgDeviceLogicalType
        MOVX      A,@DPTR
        XRL       A,#0x2
        JNZ       ??APSME_TCLinkKeyLoad_7
// 3206             {   
// 3207               si->keyNvId = ZCD_NV_TCLK_JOIN_DEV;
??APSME_TCLinkKeyLoad_9:
        MOV       A,?V0
        ADD       A,#0xf
        MOV       DPL,A
        CLR       A
        ADDC      A,?V1
        MOV       DPH,A
        MOV       A,#0x2
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x1
        MOVX      @DPTR,A
// 3208               break;
        LJMP      ??APSME_TCLinkKeyLoad_8 & 0xFFFF
// 3209             }
// 3210             #endif
// 3211           case ZG_DEFAULT_KEY:
// 3212           case ZG_NON_R21_NWK_JOINED:
// 3213             si->keyNvId = ZCD_NV_TCLK_DEFAULT;
??APSME_TCLinkKeyLoad_7:
        MOV       A,?V0
        ADD       A,#0xf
        MOV       DPL,A
        CLR       A
        ADDC      A,?V1
        MOV       DPH,A
        MOV       A,#0x3
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x1
        MOVX      @DPTR,A
// 3214           break;
        LJMP      ??APSME_TCLinkKeyLoad_8 & 0xFFFF
// 3215           case ZG_PROVISIONAL_KEY:
// 3216             si->keyNvId = ZCD_NV_TCLK_IC_TABLE_START + TCLKDevEntry.SeedShift_IcIndex;
??APSME_TCLinkKeyLoad_4:
        MOV       A,#0x13
        LCALL     ?XSTACK_DISP0_8
        MOVX      A,@DPTR
        MOV       R0,A
        MOV       R1,#0x0
        MOV       A,R0
        ADD       A,#0x4
        MOV       R0,A
        MOV       A,R1
        ADDC      A,#0x1
        MOV       R1,A
        MOV       A,?V0
        ADD       A,#0xf
        MOV       DPL,A
        CLR       A
        ADDC      A,?V1
        MOV       DPH,A
        MOV       A,R0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,R1
        MOVX      @DPTR,A
// 3217           break;
        LJMP      ??APSME_TCLinkKeyLoad_8 & 0xFFFF
// 3218           case ZG_VERIFIED_KEY:
// 3219             #if ZG_BUILD_JOINING_TYPE
// 3220             if(ZG_DEVICE_JOINING_TYPE)
??APSME_TCLinkKeyLoad_6:
        MOV       DPTR,#zgDeviceLogicalType
        MOVX      A,@DPTR
        XRL       A,#0x1
        JZ        ??APSME_TCLinkKeyLoad_10
        MOV       DPTR,#zgDeviceLogicalType
        MOVX      A,@DPTR
        XRL       A,#0x2
        JNZ       ??APSME_TCLinkKeyLoad_11
// 3221             {   
// 3222               si->keyNvId = ZCD_NV_TCLK_JOIN_DEV;
??APSME_TCLinkKeyLoad_10:
        MOV       A,?V0
        ADD       A,#0xf
        MOV       DPL,A
        CLR       A
        ADDC      A,?V1
        MOV       DPH,A
        MOV       A,#0x2
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x1
        MOVX      @DPTR,A
// 3223               break;
        LJMP      ??APSME_TCLinkKeyLoad_8 & 0xFFFF
// 3224             }
// 3225             #endif
// 3226             #if ZG_BUILD_COORDINATOR_TYPE
// 3227             if(ZG_DEVICE_COORDINATOR_TYPE)
// 3228             {
// 3229               si->keyNvId = ZCD_NV_TCLK_SEED;
// 3230               si->seedShift = TCLKDevEntry.SeedShift_IcIndex;
// 3231             }
// 3232             #endif
// 3233             osal_memcpy(si->dstExtAddr, TCLKDevEntry.extAddr,Z_EXTADDR_LEN);
??APSME_TCLinkKeyLoad_11:
        ; Setup parameters for call to function osal_memcpy
        MOV       A,#0x9
        LCALL     ?XSTACK_DISP0_8
        MOV       R1,DPL
        MOV       R2,DPH
        MOV       R3,#0x0
        MOV       ?V4,R1
        MOV       ?V5,R2
        MOV       ?V6,R3
        MOV       R0,#?V4
        LCALL     ?PUSH_XSTACK_I_THREE
          CFI CFA_XSP16 add(XSP16, 60)
        MOV       R4,#0x8
        MOV       R5,#0x0
        MOV       A,?V0
        ADD       A,#0x18
        MOV       R2,A
        CLR       A
        ADDC      A,?V1
        MOV       R3,A
        LCALL     `??osal_memcpy::?relay`; Banked call to: osal_memcpy
        MOV       A,#0x3
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 57)
// 3234           break;
        LJMP      ??APSME_TCLinkKeyLoad_8 & 0xFFFF
// 3235           default:
// 3236             //This should not happen
// 3237           break;
// 3238         }
// 3239       }
// 3240       //Not found, then create an entry for it. Adding the device to the TCLKDev Entries for first time
// 3241       else
// 3242       {
// 3243         //Initialize the entry
// 3244         osal_memcpy(TCLKDevEntry.extAddr, si->extAddr, Z_EXTADDR_LEN);
??APSME_TCLinkKeyLoad_3:
        ; Setup parameters for call to function osal_memcpy
        MOV       A,?V0
        ADD       A,#0x6
        MOV       ?V4,A
        CLR       A
        ADDC      A,?V1
        MOV       ?V5,A
        MOV       ?V6,#0x0
        MOV       R0,#?V4
        LCALL     ?PUSH_XSTACK_I_THREE
          CFI CFA_XSP16 add(XSP16, 60)
        MOV       R4,#0x8
        MOV       R5,#0x0
        MOV       A,#0xc
        LCALL     ?XSTACK_DISP0_8
        MOV       R2,DPL
        MOV       R3,DPH
        LCALL     `??osal_memcpy::?relay`; Banked call to: osal_memcpy
        MOV       A,#0x3
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 57)
// 3245         TCLKDevEntry.keyAttributes = ZG_DEFAULT_KEY;
        MOV       A,#0x11
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#-0x1
        MOVX      @DPTR,A
// 3246         TCLKDevEntry.keyType = ZG_GLOBAL_LINK_KEY;
        MOV       A,#0x12
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x1
        MOVX      @DPTR,A
// 3247         //Create the entry with a random shift of the seed. Validate the maximum shift of the seed which is 15
// 3248         TCLKDevEntry.SeedShift_IcIndex = osal_rand() & 0x000F;
        ; Setup parameters for call to function osal_rand
        LCALL     `??osal_rand::?relay`; Banked call to: osal_rand
        MOV       A,R2
        ANL       A,#0xf
        PUSH      A
          CFI CFA_SP SP+-1
        MOV       A,#0x13
        LCALL     ?XSTACK_DISP0_8
        POP       A
          CFI CFA_SP SP+0
        MOVX      @DPTR,A
// 3249         TCLKDevEntry.txFrmCntr = 0;
        MOV       A,#0x1
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
// 3250         TCLKDevEntry.rxFrmCntr = 0;
        MOV       A,#0x5
        LCALL     ?XSTACK_DISP0_8
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x0
        MOVX      @DPTR,A
// 3251         //save entry in nv
// 3252         osal_nv_write(entryIndex,0,sizeof(APSME_TCLKDevEntry_t),&TCLKDevEntry);
        ; Setup parameters for call to function osal_nv_write
        MOV       A,#0x1
        LCALL     ?XSTACK_DISP100_8
        MOV       ?V4,R0
        MOV       ?V5,R1
        MOV       R0,#?V4
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 59)
        MOV       ?V4,#0x13
        MOV       ?V5,#0x0
        MOV       R0,#?V4
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 61)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       R2,?V12
        MOV       R3,?V13
        LCALL     `??osal_nv_write::?relay`; Banked call to: osal_nv_write
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 57)
        MOV       A,R1
// 3253         //Initialize framecounter
// 3254         osal_memset(&TCLinkKeyFrmCntr[i],0,sizeof(APSME_TCLinkKeyFrmCntr_t));
        ; Setup parameters for call to function osal_memset
        MOV       R4,#0x9
        MOV       R5,#0x0
        MOV       R1,#0x0
        MOV       A,R6
        MOV       R2,A
        MOV       A,R7
        MOV       R3,A
        MOV       A,R2
        MOV       B,#0x9
        MUL       AB
        XCH       A,R2
        MOV       R0,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R0
        MOV       R0,A
        MOV       B,#0x9
        MOV       A,R3
        MUL       AB
        ADD       A,R0
        MOV       R3,A
        MOV       A,#TCLinkKeyFrmCntr & 0xff
        ADD       A,R2
        MOV       R2,A
        MOV       A,#(TCLinkKeyFrmCntr >> 8) & 0xff
        ADDC      A,R3
        MOV       R3,A
        LCALL     `??osal_memset::?relay`; Banked call to: osal_memset
// 3255         // set the keyNvId to use
// 3256         si->keyNvId = ZCD_NV_TCLK_DEFAULT;
        MOV       A,?V0
        ADD       A,#0xf
        MOV       DPL,A
        CLR       A
        ADDC      A,?V1
        MOV       DPH,A
        MOV       A,#0x3
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x1
        MOVX      @DPTR,A
// 3257       }
// 3258 
// 3259       // update link key related fields
// 3260       si->keyID   = SEC_KEYID_LINK;
??APSME_TCLinkKeyLoad_8:
        MOV       A,?V0
        ADD       A,#0xe
        MOV       DPL,A
        CLR       A
        ADDC      A,?V1
        MOV       DPH,A
        MOV       A,#0x0
        MOVX      @DPTR,A
// 3261       si->frmCntr = TCLinkKeyFrmCntr[i].txFrmCntr;
        MOV       A,R6
        MOV       R0,A
        MOV       A,R7
        MOV       R1,A
        MOV       A,R0
        MOV       B,#0x9
        MUL       AB
        XCH       A,R0
        MOV       R2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R2
        MOV       R2,A
        MOV       B,#0x9
        MOV       A,R1
        MUL       AB
        ADD       A,R2
        MOV       R1,A
        MOV       A,#TCLinkKeyFrmCntr & 0xff
        ADD       A,R0
        MOV       DPL,A
        MOV       A,#(TCLinkKeyFrmCntr >> 8) & 0xff
        ADDC      A,R1
        MOV       DPH,A
        LCALL     ?XLOAD_R0123
        MOV       A,?V0
        ADD       A,#0x12
        MOV       DPL,A
        CLR       A
        ADDC      A,?V1
        MOV       DPH,A
        LCALL     ?XSTORE_R0123
// 3262 
// 3263       // update outgoing frame counter
// 3264       TCLinkKeyFrmCntr[i].txFrmCntr++;
        MOV       DPTR,#__Constant_1
        MOV       R0,#?V4
        LCALL     ?L_MOV_X
        MOV       A,R6
        MOV       R0,A
        MOV       A,R7
        MOV       R1,A
        MOV       A,R0
        MOV       B,#0x9
        MUL       AB
        XCH       A,R0
        MOV       R2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R2
        MOV       R2,A
        MOV       B,#0x9
        MOV       A,R1
        MUL       AB
        ADD       A,R2
        MOV       R1,A
        MOV       A,#TCLinkKeyFrmCntr & 0xff
        ADD       A,R0
        MOV       DPL,A
        MOV       A,#(TCLinkKeyFrmCntr >> 8) & 0xff
        ADDC      A,R1
        MOV       DPH,A
        MOV       R0,#?V4
        LCALL     ?L_ADD_TO_X
// 3265 
// 3266   #if defined ( NV_RESTORE )
// 3267       // write periodically to NV
// 3268       if ( !(TCLinkKeyFrmCntr[i].txFrmCntr % MAX_TCLK_FRAMECOUNTER_CHANGES) )
        MOV       A,R6
        MOV       R0,A
        MOV       A,R7
        MOV       R1,A
        MOV       A,R0
        MOV       B,#0x9
        MUL       AB
        XCH       A,R0
        MOV       R2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R2
        MOV       R2,A
        MOV       B,#0x9
        MOV       A,R1
        MUL       AB
        ADD       A,R2
        MOV       R1,A
        MOV       A,#TCLinkKeyFrmCntr & 0xff
        ADD       A,R0
        MOV       DPL,A
        MOV       A,#(TCLinkKeyFrmCntr >> 8) & 0xff
        ADDC      A,R1
        MOV       DPH,A
        MOV       R0,#?V8
        LCALL     ?L_MOV_X
        MOV       DPTR,#__Constant_a
        MOV       R0,#?V4
        LCALL     ?L_MOV_X
        MOV       R0,#?V8
        MOV       R1,#?V4
        LCALL     ?UL_DIV_MOD
        MOV       A,?V4
        ORL       A,?V5
        ORL       A,?V6
        ORL       A,?V7
        JNZ       ??APSME_TCLinkKeyLoad_12
// 3269       {
// 3270         // set the flag to write key to NV
// 3271         TCLinkKeyFrmCntr[i].pendingFlag = TRUE;
        MOV       A,R6
        MOV       R0,A
        MOV       A,R7
        MOV       R1,A
        MOV       A,R0
        MOV       B,#0x9
        MUL       AB
        XCH       A,R0
        MOV       R2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R2
        MOV       R2,A
        MOV       B,#0x9
        MOV       A,R1
        MUL       AB
        ADD       A,R2
        MOV       R1,A
        MOV       A,#(TCLinkKeyFrmCntr + 8) & 0xff
        ADD       A,R0
        MOV       DPL,A
        MOV       A,#((TCLinkKeyFrmCntr + 8) >> 8) & 0xff
        ADDC      A,R1
        MOV       DPH,A
        MOV       A,#0x1
        MOVX      @DPTR,A
// 3272 
// 3273         // Notify the ZDApp that the frame counter has changed.
// 3274         osal_set_event( ZDAppTaskID, ZDO_TCLK_FRAMECOUNTER_CHANGE );
        ; Setup parameters for call to function osal_set_event
        MOV       R2,#0x0
        MOV       R3,#0x4
        MOV       DPTR,#ZDAppTaskID
        MOVX      A,@DPTR
        MOV       R1,A
        LCALL     `??osal_set_event::?relay`; Banked call to: osal_set_event
        MOV       A,R1
        SJMP      ??APSME_TCLinkKeyLoad_12
// 3275       }
// 3276   #endif
// 3277     }  
// 3278     else
// 3279     {
// 3280       //If no more TCLK entries, try global so we can try to add legacy devices
// 3281       si->keyNvId = ZCD_NV_TCLK_DEFAULT;
??APSME_TCLinkKeyLoad_2:
        MOV       A,?V0
        ADD       A,#0xf
        MOV       DPL,A
        CLR       A
        ADDC      A,?V1
        MOV       DPH,A
        MOV       A,#0x3
        MOVX      @DPTR,A
        INC       DPTR
        MOV       A,#0x1
        MOVX      @DPTR,A
// 3282     }
// 3283     status = ZSuccess;
??APSME_TCLinkKeyLoad_12:
        MOV       ?V2,#0x0
// 3284   }
// 3285   
// 3286   // If no TC link key found, remove the device from the address manager
// 3287   if ( (status != ZSuccess) && (AddrMgrEntryLookupNwk(&addrEntry) == TRUE) )
??APSME_TCLinkKeyLoad_0:
        MOV       A,?V2
        JZ        ??APSME_TCLinkKeyLoad_13
        ; Setup parameters for call to function AddrMgrEntryLookupNwk
        MOV       A,#0x14
        LCALL     ?XSTACK_DISP101_8
        LCALL     `??AddrMgrEntryLookupNwk::?relay`; Banked call to: AddrMgrEntryLookupNwk
        MOV       A,R1
        XRL       A,#0x1
        JNZ       ??APSME_TCLinkKeyLoad_13
// 3288   {
// 3289     AddrMgrEntryRelease( &addrEntry );
        ; Setup parameters for call to function AddrMgrEntryRelease
        MOV       A,#0x14
        LCALL     ?XSTACK_DISP101_8
        LCALL     `??AddrMgrEntryRelease::?relay`; Banked call to: AddrMgrEntryRelease
        MOV       A,R1
// 3290   }
// 3291 
// 3292   return status;
??APSME_TCLinkKeyLoad_13:
        MOV       R1,?V2
        MOV       A,#0x21
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 24)
        MOV       R7,#0x10
        LJMP      ?BANKED_LEAVE_XDATA
// 3293 }
          CFI EndBlock cfiBlock60
// 3294 
// 3295 /******************************************************************************
// 3296  * @fn          APSME_IsDefaultTCLK
// 3297  *
// 3298  * @brief       Return TRUE or FALSE based on the extended address.  If the
// 3299  *              input ext address is all FFs, it means the trust center link
// 3300  *              assoiciated with the address is the default trust center link key
// 3301  *
// 3302  * @param       extAddr - [in] extended address
// 3303  *
// 3304  * @return      uint8 TRUE/FALSE
// 3305  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 3306 uint8 APSME_IsDefaultTCLK( uint8 *extAddr )
APSME_IsDefaultTCLK:
          CFI Block cfiBlock61 Using cfiCommon0
          CFI Function APSME_IsDefaultTCLK
        CODE
// 3307 {
        FUNCALL APSME_IsDefaultTCLK, osal_isbufset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV       A,#-0x9
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
        MOV       A,R2
        MOV       R6,A
        MOV       A,R3
        MOV       R7,A
// 3308   return osal_isbufset( extAddr, 0xFF, Z_EXTADDR_LEN );
        ; Setup parameters for call to function osal_isbufset
        MOV       R4,#0x8
        MOV       R1,#-0x1
        MOV       A,R6
        MOV       R2,A
        MOV       A,R7
        MOV       R3,A
        LCALL     `??osal_isbufset::?relay`; Banked call to: osal_isbufset
        MOV       R7,#0x1
        LJMP      ?BANKED_LEAVE_XDATA
// 3309 }
          CFI EndBlock cfiBlock61
// 3310 
// 3311 /******************************************************************************
// 3312  * @fn          ZDSecMgrNwkKeyInit
// 3313  *
// 3314  * @brief       Initialize the NV items for
// 3315  *                  ZCD_NV_NWKKEY,
// 3316  *                  ZCD_NV_NWK_ACTIVE_KEY_INFO and
// 3317  *                  ZCD_NV_NWK_ALTERN_KEY_INFO
// 3318  *
// 3319  * @param       setDefault
// 3320  *
// 3321  * @return      none
// 3322  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 3323 void ZDSecMgrNwkKeyInit(uint8 setDefault)
ZDSecMgrNwkKeyInit:
          CFI Block cfiBlock62 Using cfiCommon0
          CFI Function ZDSecMgrNwkKeyInit
        CODE
// 3324 {
        FUNCALL ZDSecMgrNwkKeyInit, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 62, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 62, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrNwkKeyInit, zgReadStartupOptions
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 62, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 62, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrNwkKeyInit, osal_nv_item_init
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 64, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 64, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrNwkKeyInit, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 66, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 66, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrNwkKeyInit, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 62, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 62, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrNwkKeyInit, osal_nv_item_init
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 64, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 64, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrNwkKeyInit, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 66, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 66, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrNwkKeyInit, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 62, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 62, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrNwkKeyInit, osal_nv_item_init
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 64, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 64, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrNwkKeyInit, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 66, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 66, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrNwkKeyInit, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 62, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 62, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrNwkKeyInit, osal_nv_item_init
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 64, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 64, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrNwkKeyInit, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 66, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 66, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrNwkKeyInit, osal_nv_item_init
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 64, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 64, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrNwkKeyInit, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 66, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 66, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        REQUIRE ?V2
        REQUIRE ?V3
        MOV       A,#-0xc
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 12)
        ; Saved register size: 12
        ; Auto size: 50
        MOV       A,#-0x32
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 62)
        MOV       ?V1,R1
// 3325   uint8 status;
// 3326   nwkKeyDesc nwkKey;
// 3327   // Initialize NV items for NWK key, this structure contains the frame counter
// 3328   // and is only used when NV_RESTORE is enabled
// 3329   nwkActiveKeyItems keyItems;
// 3330   
// 3331 
// 3332   uint8 i,nwkFrameCounterReset = FALSE;
        MOV       ?V0,#0x0
// 3333   nwkSecMaterialDesc_t nwkSecMaterialDesc;
// 3334   
// 3335   //NwkSecMaterial entry is empty if set to 0s
// 3336   osal_memset(&nwkSecMaterialDesc,0,sizeof(nwkSecMaterialDesc_t));
        ; Setup parameters for call to function osal_memset
        MOV       R4,#0xc
        MOV       R5,#0x0
        MOV       R1,#0x0
        MOV       R2,?XSP + 0
        MOV       R3,?XSP + 1
        LCALL     `??osal_memset::?relay`; Banked call to: osal_memset
// 3337 #ifdef NV_RESTORE  
// 3338   // Has been set to reset the nwk security material?
// 3339   if ( zgReadStartupOptions() & ZCD_STARTOPT_CLEAR_NWK_FRAME_COUNTER )
        ; Setup parameters for call to function zgReadStartupOptions
        LCALL     `??zgReadStartupOptions::?relay`; Banked call to: zgReadStartupOptions
        MOV       A,R1
        MOV       R0,A
        MOV       A,R0
        MOV       C,0xE0 /* A   */.7
        JNC       ??ZDSecMgrNwkKeyInit_0
// 3340   {
// 3341     nwkFrameCounterReset = TRUE;
        MOV       ?V0,#0x1
// 3342   }
// 3343 #else
// 3344   nwkFrameCounterReset = TRUE;
// 3345 #endif
// 3346   
// 3347   //Initialize the nwk security material
// 3348   for( i = 0; i < gMAX_NWK_SEC_MATERIAL_TABLE_ENTRIES; i++)
??ZDSecMgrNwkKeyInit_0:
        MOV       R7,#0x0
??ZDSecMgrNwkKeyInit_1:
        MOV       DPTR,#gMAX_NWK_SEC_MATERIAL_TABLE_ENTRIES
        CLR       A
        MOVC      A,@A+DPTR
        MOV       R0,A
        MOV       A,R7
        CLR       C
        SUBB      A,R0
        JNC       ??ZDSecMgrNwkKeyInit_2
// 3349   {
// 3350     if((osal_nv_item_init(ZCD_NV_NWK_SEC_MATERIAL_TABLE_START + i,sizeof(nwkSecMaterialDesc_t),&nwkSecMaterialDesc) == SUCCESS) && (nwkFrameCounterReset))
        ; Setup parameters for call to function osal_nv_item_init
        MOV       R0,?XSP + 0
        MOV       R1,?XSP + 1
        MOV       ?V2,R0
        MOV       ?V3,R1
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 64)
        MOV       R4,#0xc
        MOV       R5,#0x0
        MOV       A,R7
        MOV       R0,A
        MOV       R1,#0x0
        MOV       A,R0
        ADD       A,#0x75
        MOV       R2,A
        CLR       A
        ADDC      A,R1
        MOV       R3,A
        LCALL     `??osal_nv_item_init::?relay`; Banked call to: osal_nv_item_init
        MOV       A,#0x2
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 62)
        MOV       A,R1
        JNZ       ??ZDSecMgrNwkKeyInit_3
        MOV       A,?V0
        JZ        ??ZDSecMgrNwkKeyInit_3
// 3351     {
// 3352       osal_nv_write(ZCD_NV_NWK_SEC_MATERIAL_TABLE_START + i,0,sizeof(nwkSecMaterialDesc_t),&nwkSecMaterialDesc);
        ; Setup parameters for call to function osal_nv_write
        MOV       R0,?XSP + 0
        MOV       R1,?XSP + 1
        MOV       ?V2,R0
        MOV       ?V3,R1
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 64)
        MOV       ?V2,#0xc
        MOV       ?V3,#0x0
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 66)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       A,R7
        MOV       R0,A
        MOV       R1,#0x0
        MOV       A,R0
        ADD       A,#0x75
        MOV       R2,A
        CLR       A
        ADDC      A,R1
        MOV       R3,A
        LCALL     `??osal_nv_write::?relay`; Banked call to: osal_nv_write
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 62)
        MOV       A,R1
// 3353     }
// 3354   }
??ZDSecMgrNwkKeyInit_3:
        INC       R7
        SJMP      ??ZDSecMgrNwkKeyInit_1
// 3355   //Set the last item to the generic nwk security material by setting extPanId to 0xFFs
// 3356   osal_memset(nwkSecMaterialDesc.extendedPanID,0xFF,Z_EXTADDR_LEN);
??ZDSecMgrNwkKeyInit_2:
        ; Setup parameters for call to function osal_memset
        MOV       R4,#0x8
        MOV       R5,#0x0
        MOV       R1,#-0x1
        MOV       A,#0x4
        LCALL     ?XSTACK_DISP0_8
        MOV       R2,DPL
        MOV       R3,DPH
        LCALL     `??osal_memset::?relay`; Banked call to: osal_memset
// 3357   
// 3358   if((osal_nv_item_init(ZCD_NV_NWK_SEC_MATERIAL_TABLE_START + i - 1,sizeof(nwkSecMaterialDesc_t),&nwkSecMaterialDesc) == SUCCESS) && (nwkFrameCounterReset))
        ; Setup parameters for call to function osal_nv_item_init
        MOV       R0,?XSP + 0
        MOV       R1,?XSP + 1
        MOV       ?V2,R0
        MOV       ?V3,R1
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 64)
        MOV       R4,#0xc
        MOV       R5,#0x0
        MOV       A,R7
        MOV       R0,A
        MOV       R1,#0x0
        MOV       A,R0
        ADD       A,#0x74
        MOV       R2,A
        CLR       A
        ADDC      A,R1
        MOV       R3,A
        LCALL     `??osal_nv_item_init::?relay`; Banked call to: osal_nv_item_init
        MOV       A,#0x2
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 62)
        MOV       A,R1
        JNZ       ??ZDSecMgrNwkKeyInit_4
        MOV       A,?V0
        JZ        ??ZDSecMgrNwkKeyInit_4
// 3359   {
// 3360     osal_nv_write(ZCD_NV_NWK_SEC_MATERIAL_TABLE_START + i - 1,0,sizeof(nwkSecMaterialDesc_t),&nwkSecMaterialDesc);
        ; Setup parameters for call to function osal_nv_write
        MOV       R0,?XSP + 0
        MOV       R1,?XSP + 1
        MOV       ?V2,R0
        MOV       ?V3,R1
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 64)
        MOV       ?V2,#0xc
        MOV       ?V3,#0x0
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 66)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       A,R7
        MOV       R0,A
        MOV       R1,#0x0
        MOV       A,R0
        ADD       A,#0x74
        MOV       R2,A
        CLR       A
        ADDC      A,R1
        MOV       R3,A
        LCALL     `??osal_nv_write::?relay`; Banked call to: osal_nv_write
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 62)
        MOV       A,R1
// 3361   }
// 3362 
// 3363 
// 3364   osal_memset( &keyItems, 0, sizeof( nwkActiveKeyItems ) );
??ZDSecMgrNwkKeyInit_4:
        ; Setup parameters for call to function osal_memset
        MOV       R4,#0x15
        MOV       R5,#0x0
        MOV       R1,#0x0
        MOV       A,#0x1d
        LCALL     ?XSTACK_DISP101_8
        LCALL     `??osal_memset::?relay`; Banked call to: osal_memset
// 3365 
// 3366   status = osal_nv_item_init( ZCD_NV_NWKKEY, sizeof(nwkActiveKeyItems), (void *)&keyItems );
        ; Setup parameters for call to function osal_nv_item_init
        MOV       A,#0x1d
        LCALL     ?XSTACK_DISP100_8
        MOV       ?V2,R0
        MOV       ?V3,R1
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 64)
        MOV       R4,#0x15
        MOV       R5,#0x0
        MOV       R2,#-0x7e
        MOV       R3,#0x0
        LCALL     `??osal_nv_item_init::?relay`; Banked call to: osal_nv_item_init
        MOV       A,#0x2
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 62)
        MOV       A,R1
        MOV       R6,A
// 3367 
// 3368 #if defined ( NV_RESTORE )
// 3369   // reset the values of NV items if NV_RESTORE is not enabled
// 3370   if ((status == SUCCESS) && (setDefault == TRUE))
        MOV       A,R6
        JNZ       ??ZDSecMgrNwkKeyInit_5
        MOV       A,#0x1
        XRL       A,?V1
        JNZ       ??ZDSecMgrNwkKeyInit_5
// 3371   {
// 3372     // clear NV data to default values
// 3373     osal_nv_write( ZCD_NV_NWKKEY, 0, sizeof(nwkActiveKeyItems), &keyItems );
        ; Setup parameters for call to function osal_nv_write
        MOV       A,#0x1d
        LCALL     ?XSTACK_DISP100_8
        MOV       ?V2,R0
        MOV       ?V3,R1
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 64)
        MOV       ?V2,#0x15
        MOV       ?V3,#0x0
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 66)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       R2,#-0x7e
        MOV       R3,#0x0
        LCALL     `??osal_nv_write::?relay`; Banked call to: osal_nv_write
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 62)
        MOV       A,R1
// 3374   }
// 3375 #else
// 3376   (void)setDefault;   // to eliminate compiler warning
// 3377 
// 3378   // reset the values of NV items if NV_RESTORE is not enabled
// 3379   if (status == SUCCESS)
// 3380   {
// 3381     osal_nv_write( ZCD_NV_NWKKEY, 0, sizeof(nwkActiveKeyItems), &keyItems );
// 3382   }
// 3383 #endif // defined (NV_RESTORE)
// 3384 
// 3385   // Initialize NV items for NWK Active and Alternate keys. These items are used
// 3386   // all the time, independently of NV_RESTORE being set or not
// 3387   osal_memset( &nwkKey, 0x00, sizeof(nwkKey) );
??ZDSecMgrNwkKeyInit_5:
        ; Setup parameters for call to function osal_memset
        MOV       R4,#0x11
        MOV       R5,#0x0
        MOV       R1,#0x0
        MOV       A,#0xc
        LCALL     ?XSTACK_DISP101_8
        LCALL     `??osal_memset::?relay`; Banked call to: osal_memset
// 3388 
// 3389   status = osal_nv_item_init( ZCD_NV_NWK_ACTIVE_KEY_INFO, sizeof(nwkKey), &nwkKey);
        ; Setup parameters for call to function osal_nv_item_init
        MOV       A,#0xc
        LCALL     ?XSTACK_DISP100_8
        MOV       ?V2,R0
        MOV       ?V3,R1
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 64)
        MOV       R4,#0x11
        MOV       R5,#0x0
        MOV       R2,#0x3a
        MOV       R3,#0x0
        LCALL     `??osal_nv_item_init::?relay`; Banked call to: osal_nv_item_init
        MOV       A,#0x2
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 62)
        MOV       A,R1
        MOV       R6,A
// 3390 
// 3391 #if defined ( NV_RESTORE )
// 3392   // reset the values of NV items if NV_RESTORE is not enabled
// 3393   if ((status == SUCCESS) && (setDefault == TRUE))
        MOV       A,R6
        JNZ       ??ZDSecMgrNwkKeyInit_6
        MOV       A,#0x1
        XRL       A,?V1
        JNZ       ??ZDSecMgrNwkKeyInit_6
// 3394   {
// 3395     // clear NV data to default values
// 3396     osal_nv_write( ZCD_NV_NWK_ACTIVE_KEY_INFO, 0, sizeof(nwkKey), &nwkKey );
        ; Setup parameters for call to function osal_nv_write
        MOV       A,#0xc
        LCALL     ?XSTACK_DISP100_8
        MOV       ?V2,R0
        MOV       ?V3,R1
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 64)
        MOV       ?V2,#0x11
        MOV       ?V3,#0x0
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 66)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       R2,#0x3a
        MOV       R3,#0x0
        LCALL     `??osal_nv_write::?relay`; Banked call to: osal_nv_write
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 62)
        MOV       A,R1
// 3397   }
// 3398 #else
// 3399   // reset the values of NV items if NV_RESTORE is not enabled
// 3400   if (status == SUCCESS)
// 3401   {
// 3402     osal_nv_write( ZCD_NV_NWK_ACTIVE_KEY_INFO, 0, sizeof(nwkKey), &nwkKey );
// 3403   }
// 3404 #endif // defined (NV_RESTORE)
// 3405 
// 3406   status = osal_nv_item_init( ZCD_NV_NWK_ALTERN_KEY_INFO, sizeof(nwkKey), &nwkKey );
??ZDSecMgrNwkKeyInit_6:
        ; Setup parameters for call to function osal_nv_item_init
        MOV       A,#0xc
        LCALL     ?XSTACK_DISP100_8
        MOV       ?V2,R0
        MOV       ?V3,R1
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 64)
        MOV       R4,#0x11
        MOV       R5,#0x0
        MOV       R2,#0x3b
        MOV       R3,#0x0
        LCALL     `??osal_nv_item_init::?relay`; Banked call to: osal_nv_item_init
        MOV       A,#0x2
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 62)
        MOV       A,R1
        MOV       R6,A
// 3407 
// 3408 #if defined ( NV_RESTORE )
// 3409   // reset the values of NV items if NV_RESTORE is not enabled
// 3410   if ((status == SUCCESS) && (setDefault == TRUE))
        MOV       A,R6
        JNZ       ??ZDSecMgrNwkKeyInit_7
        MOV       A,#0x1
        XRL       A,?V1
        JNZ       ??ZDSecMgrNwkKeyInit_7
// 3411   {
// 3412     // clear NV data to default values
// 3413     osal_nv_write( ZCD_NV_NWK_ALTERN_KEY_INFO, 0, sizeof(nwkKey), &nwkKey );
        ; Setup parameters for call to function osal_nv_write
        MOV       A,#0xc
        LCALL     ?XSTACK_DISP100_8
        MOV       ?V2,R0
        MOV       ?V3,R1
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 64)
        MOV       ?V2,#0x11
        MOV       ?V3,#0x0
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 66)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       R2,#0x3b
        MOV       R3,#0x0
        LCALL     `??osal_nv_write::?relay`; Banked call to: osal_nv_write
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 62)
        MOV       A,R1
// 3414   }
// 3415 #else
// 3416   // reset the values of NV items if NV_RESTORE is not enabled
// 3417   if (status == SUCCESS)
// 3418   {
// 3419     osal_nv_write( ZCD_NV_NWK_ALTERN_KEY_INFO, 0, sizeof(nwkKey), &nwkKey );
// 3420   }
// 3421 #endif // defined (NV_RESTORE)
// 3422 
// 3423 }
??ZDSecMgrNwkKeyInit_7:
        MOV       A,#0x32
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 12)
        MOV       R7,#0x4
        LJMP      ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock62
// 3424 
// 3425 
// 3426 
// 3427 /*********************************************************************
// 3428  * @fn          ZDSecMgrReadKeyFromNv
// 3429  *
// 3430  * @brief       Looks for a specific key in NV based on Index value
// 3431  *
// 3432  * @param   keyNvId - Index of key to look in NV
// 3433  *                    valid values are:
// 3434  *                    ZCD_NV_NWK_ACTIVE_KEY_INFO
// 3435  *                    ZCD_NV_NWK_ALTERN_KEY_INFO
// 3436  *                    ZCD_NV_TCLK_TABLE_START + <offset_in_table>
// 3437  *                    ZCD_NV_APS_LINK_KEY_DATA_START + <offset_in_table>
// 3438  *                    ZCD_NV_PRECFGKEY
// 3439  *
// 3440  * @param  *keyinfo - Data is read into this buffer.
// 3441  *
// 3442  * @return  SUCCESS if NV data was copied to the keyinfo parameter .
// 3443  *          Otherwise, NV_OPER_FAILED for failure.
// 3444  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 3445 ZStatus_t ZDSecMgrReadKeyFromNv(uint16 keyNvId, void *keyinfo)
ZDSecMgrReadKeyFromNv:
          CFI Block cfiBlock63 Using cfiCommon0
          CFI Function ZDSecMgrReadKeyFromNv
        CODE
// 3446 {
        FUNCALL ZDSecMgrReadKeyFromNv, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 19, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 19, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrReadKeyFromNv, osal_memcpy
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 18, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrReadKeyFromNv, osal_memcpy
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 18, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrReadKeyFromNv, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 19, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 19, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrReadKeyFromNv, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 19, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 19, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrReadKeyFromNv, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 19, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 19, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrReadKeyFromNv, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 19, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 19, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        REQUIRE ?V2
        REQUIRE ?V3
        REQUIRE ?V4
        REQUIRE ?V5
        REQUIRE ?V6
        MOV       A,#-0xf
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 15)
        ; Saved register size: 15
        ; Auto size: 0
        MOV       A,R2
        MOV       R6,A
        MOV       A,R3
        MOV       R7,A
        MOV       ?V0,R4
        MOV       ?V1,R5
// 3447   if ((keyNvId == ZCD_NV_NWK_ACTIVE_KEY_INFO) ||
// 3448       (keyNvId == ZCD_NV_NWK_ALTERN_KEY_INFO))
        MOV       A,#0x3a
        XRL       A,R6
        JNZ       ??ZDSecMgrReadKeyFromNv_0
        MOV       A,#0x0
        XRL       A,R7
??ZDSecMgrReadKeyFromNv_0:
        JZ        ??ZDSecMgrReadKeyFromNv_1
        MOV       A,#0x3b
        XRL       A,R6
        JNZ       ??ZDSecMgrReadKeyFromNv_2
        MOV       A,#0x0
        XRL       A,R7
??ZDSecMgrReadKeyFromNv_2:
        JNZ       ??ZDSecMgrReadKeyFromNv_3
// 3449   {
// 3450     // get NWK active or alternate key from NV
// 3451     return (osal_nv_read(keyNvId,
// 3452                          osal_offsetof(nwkKeyDesc, key),
// 3453                          SEC_KEY_LEN,
// 3454                          keyinfo));
??ZDSecMgrReadKeyFromNv_1:
        ; Setup parameters for call to function osal_nv_read
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 17)
        MOV       ?V2,#0x10
        MOV       ?V3,#0x0
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 19)
        MOV       R4,#0x1
        MOV       R5,#0x0
        MOV       A,R6
        MOV       R2,A
        MOV       A,R7
        MOV       R3,A
        LCALL     `??osal_nv_read::?relay`; Banked call to: osal_nv_read
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 15)
        LJMP      ??ZDSecMgrReadKeyFromNv_4 & 0xFFFF
// 3455   }
// 3456   
// 3457   else if(keyNvId == ZCD_NV_TCLK_DEFAULT)
??ZDSecMgrReadKeyFromNv_3:
        MOV       A,#0x3
        XRL       A,R6
        JNZ       ??ZDSecMgrReadKeyFromNv_5
        MOV       A,#0x1
        XRL       A,R7
??ZDSecMgrReadKeyFromNv_5:
        JNZ       ??ZDSecMgrReadKeyFromNv_6
// 3458   {
// 3459     osal_memcpy(keyinfo,defaultTCLinkKey,SEC_KEY_LEN);
        ; Setup parameters for call to function osal_memcpy
        MOV       ?V4,#defaultTCLinkKey & 0xff
        MOV       ?V5,#(defaultTCLinkKey >> 8) & 0xff
        MOV       ?V6,#-0x80
        MOV       R0,#?V4
        LCALL     ?PUSH_XSTACK_I_THREE
          CFI CFA_XSP16 add(XSP16, 18)
        MOV       R4,#0x10
        MOV       R5,#0x0
        MOV       R2,?V0
        MOV       R3,?V1
        LCALL     `??osal_memcpy::?relay`; Banked call to: osal_memcpy
        MOV       A,#0x3
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 15)
// 3460     return ZSuccess;
        MOV       R1,#0x0
        LJMP      ??ZDSecMgrReadKeyFromNv_4 & 0xFFFF
// 3461   }
// 3462   
// 3463 #if (ZG_BUILD_JOINING_TYPE) 
// 3464   else if(keyNvId == ZCD_NV_DISTRIBUTED_KEY)
??ZDSecMgrReadKeyFromNv_6:
        MOV       A,#0x68
        XRL       A,R6
        JNZ       ??ZDSecMgrReadKeyFromNv_7
        MOV       A,#0x0
        XRL       A,R7
??ZDSecMgrReadKeyFromNv_7:
        JNZ       ??ZDSecMgrReadKeyFromNv_8
// 3465   {
// 3466     if(ZG_DEVICE_JOINING_TYPE)
        MOV       DPTR,#zgDeviceLogicalType
        MOVX      A,@DPTR
        XRL       A,#0x1
        JZ        ??ZDSecMgrReadKeyFromNv_9
        MOV       DPTR,#zgDeviceLogicalType
        MOVX      A,@DPTR
        XRL       A,#0x2
        JZ        $+5
        LJMP      ??ZDSecMgrReadKeyFromNv_10 & 0xFFFF
// 3467     {
// 3468       osal_memcpy(keyinfo,distributedDefaultKey,SEC_KEY_LEN);
??ZDSecMgrReadKeyFromNv_9:
        ; Setup parameters for call to function osal_memcpy
        MOV       ?V4,#distributedDefaultKey & 0xff
        MOV       ?V5,#(distributedDefaultKey >> 8) & 0xff
        MOV       ?V6,#-0x80
        MOV       R0,#?V4
        LCALL     ?PUSH_XSTACK_I_THREE
          CFI CFA_XSP16 add(XSP16, 18)
        MOV       R4,#0x10
        MOV       R5,#0x0
        MOV       R2,?V0
        MOV       R3,?V1
        LCALL     `??osal_memcpy::?relay`; Banked call to: osal_memcpy
        MOV       A,#0x3
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 15)
// 3469       return ZSuccess;
        MOV       R1,#0x0
        LJMP      ??ZDSecMgrReadKeyFromNv_4 & 0xFFFF
// 3470     }
// 3471   }
// 3472 #endif
// 3473   
// 3474   else if((keyNvId == ZCD_NV_TCLK_JOIN_DEV) || (keyNvId == ZCD_NV_PRECFGKEY)) 
??ZDSecMgrReadKeyFromNv_8:
        MOV       A,#0x2
        XRL       A,R6
        JNZ       ??ZDSecMgrReadKeyFromNv_11
        MOV       A,#0x1
        XRL       A,R7
??ZDSecMgrReadKeyFromNv_11:
        JZ        ??ZDSecMgrReadKeyFromNv_12
        MOV       A,#0x62
        XRL       A,R6
        JNZ       ??ZDSecMgrReadKeyFromNv_13
        MOV       A,#0x0
        XRL       A,R7
??ZDSecMgrReadKeyFromNv_13:
        JNZ       ??ZDSecMgrReadKeyFromNv_14
// 3475   {
// 3476     // Read entry keyNvId of the TC link key table from NV. keyNvId should be
// 3477     // ZCD_NV_TCLK_TABLE_START + <offset_in_table>
// 3478     return (osal_nv_read(keyNvId,
// 3479                          0,
// 3480                          SEC_KEY_LEN,
// 3481                          keyinfo));
??ZDSecMgrReadKeyFromNv_12:
        ; Setup parameters for call to function osal_nv_read
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 17)
        MOV       ?V2,#0x10
        MOV       ?V3,#0x0
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 19)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       A,R6
        MOV       R2,A
        MOV       A,R7
        MOV       R3,A
        LCALL     `??osal_nv_read::?relay`; Banked call to: osal_nv_read
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 15)
        LJMP      ??ZDSecMgrReadKeyFromNv_4 & 0xFFFF
// 3482   }
// 3483     else if (keyNvId == ZCD_NV_PRECFGKEY)
??ZDSecMgrReadKeyFromNv_14:
        MOV       A,#0x62
        XRL       A,R6
        JNZ       ??ZDSecMgrReadKeyFromNv_15
        MOV       A,#0x0
        XRL       A,R7
??ZDSecMgrReadKeyFromNv_15:
        JNZ       ??ZDSecMgrReadKeyFromNv_16
// 3484   {
// 3485     // Read entry keyNvId of the Preconfig key from NV.
// 3486     return (osal_nv_read(keyNvId,
// 3487                          0,
// 3488                          SEC_KEY_LEN,
// 3489                          keyinfo));
        ; Setup parameters for call to function osal_nv_read
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 17)
        MOV       ?V2,#0x10
        MOV       ?V3,#0x0
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 19)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       A,R6
        MOV       R2,A
        MOV       A,R7
        MOV       R3,A
        LCALL     `??osal_nv_read::?relay`; Banked call to: osal_nv_read
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 15)
        SJMP      ??ZDSecMgrReadKeyFromNv_4
// 3490   }
// 3491 
// 3492   else if((keyNvId >= ZCD_NV_TCLK_IC_TABLE_START) &&
// 3493            (keyNvId < (ZCD_NV_TCLK_IC_TABLE_START + gZDSECMGR_TC_DEVICE_IC_MAX)))
??ZDSecMgrReadKeyFromNv_16:
        CLR       C
        MOV       A,R6
        SUBB      A,#0x4
        MOV       A,R7
        SUBB      A,#0x1
        JC        ??ZDSecMgrReadKeyFromNv_17
        MOV       DPTR,#gZDSECMGR_TC_DEVICE_IC_MAX
        CLR       A
        MOVC      A,@A+DPTR
        ADD       A,#0x4
        MOV       R0,A
        INC       DPTR
        CLR       A
        MOVC      A,@A+DPTR
        ADDC      A,#0x1
        MOV       R1,A
        CLR       C
        MOV       A,R6
        SUBB      A,R0
        MOV       A,R7
        SUBB      A,R1
        JNC       ??ZDSecMgrReadKeyFromNv_17
// 3494   {
// 3495     //Read the key derived from the IC
// 3496     return (osal_nv_read(keyNvId,
// 3497                          0,
// 3498                          SEC_KEY_LEN,
// 3499                          keyinfo));
        ; Setup parameters for call to function osal_nv_read
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 17)
        MOV       ?V2,#0x10
        MOV       ?V3,#0x0
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 19)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       A,R6
        MOV       R2,A
        MOV       A,R7
        MOV       R3,A
        LCALL     `??osal_nv_read::?relay`; Banked call to: osal_nv_read
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 15)
        SJMP      ??ZDSecMgrReadKeyFromNv_4
// 3500   
// 3501   }
// 3502   else if ((keyNvId >= ZCD_NV_APS_LINK_KEY_DATA_START) &&
// 3503            (keyNvId < (ZCD_NV_APS_LINK_KEY_DATA_START + ZDSECMGR_ENTRY_MAX)))
??ZDSecMgrReadKeyFromNv_17:
        CLR       C
        MOV       A,R6
        SUBB      A,#0x1
        MOV       A,R7
        SUBB      A,#0x2
        JC        ??ZDSecMgrReadKeyFromNv_10
        CLR       C
        MOV       A,R6
        SUBB      A,#0x4
        MOV       A,R7
        SUBB      A,#0x2
        JNC       ??ZDSecMgrReadKeyFromNv_10
// 3504   {
// 3505     // Read entry keyNvId of the APS link key table from NV. keyNvId should be
// 3506     // ZCD_NV_APS_LINK_KEY_DATA_START + <offset_in_table>
// 3507     return (osal_nv_read(keyNvId,
// 3508                          osal_offsetof(APSME_LinkKeyData_t, key),
// 3509                          SEC_KEY_LEN,
// 3510                          keyinfo));
        ; Setup parameters for call to function osal_nv_read
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 17)
        MOV       ?V2,#0x10
        MOV       ?V3,#0x0
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 19)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       A,R6
        MOV       R2,A
        MOV       A,R7
        MOV       R3,A
        LCALL     `??osal_nv_read::?relay`; Banked call to: osal_nv_read
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 15)
        SJMP      ??ZDSecMgrReadKeyFromNv_4
// 3511   }
// 3512 
// 3513   return NV_OPER_FAILED;
??ZDSecMgrReadKeyFromNv_10:
        MOV       R1,#0xa
??ZDSecMgrReadKeyFromNv_4:
        MOV       R7,#0x7
        LJMP      ?BANKED_LEAVE_XDATA
// 3514 }
          CFI EndBlock cfiBlock63
// 3515 
// 3516 /******************************************************************************
// 3517  * @fn          ZDSecMgrApsLinkKeyInit
// 3518  *
// 3519  * @brief       Initialize the NV table for Application link keys
// 3520  *
// 3521  * @param       setDefault - TRUE to set default values
// 3522  *
// 3523  * @return      none
// 3524  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 3525 void ZDSecMgrApsLinkKeyInit(uint8 setDefault)
ZDSecMgrApsLinkKeyInit:
          CFI Block cfiBlock64 Using cfiCommon0
          CFI Function ZDSecMgrApsLinkKeyInit
        CODE
// 3526 {
        FUNCALL ZDSecMgrApsLinkKeyInit, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 36, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 36, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrApsLinkKeyInit, osal_nv_item_init
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 38, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 38, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrApsLinkKeyInit, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 40, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 40, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V2
        REQUIRE ?V3
        MOV       A,#-0xc
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 12)
        ; Saved register size: 12
        ; Auto size: 24
        MOV       A,#-0x18
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 36)
        MOV       ?V0,R1
// 3527   APSME_LinkKeyData_t pApsLinkKey;
// 3528   uint8 i;
// 3529   uint8 status;
// 3530 
// 3531   // Initialize all NV items for APS link key, if not exist already.
// 3532   osal_memset( &pApsLinkKey, 0x00, sizeof(APSME_LinkKeyData_t) );
        ; Setup parameters for call to function osal_memset
        MOV       R4,#0x18
        MOV       R5,#0x0
        MOV       R1,#0x0
        MOV       R2,?XSP + 0
        MOV       R3,?XSP + 1
        LCALL     `??osal_memset::?relay`; Banked call to: osal_memset
// 3533 
// 3534   for( i = 0; i < ZDSECMGR_ENTRY_MAX; i++ )
        MOV       R6,#0x0
??ZDSecMgrApsLinkKeyInit_0:
        MOV       A,R6
        CLR       C
        SUBB      A,#0x3
        JNC       ??ZDSecMgrApsLinkKeyInit_1
// 3535   {
// 3536     status = osal_nv_item_init( (ZCD_NV_APS_LINK_KEY_DATA_START + i),
// 3537                                sizeof(APSME_LinkKeyData_t), &pApsLinkKey );
        ; Setup parameters for call to function osal_nv_item_init
        MOV       R0,?XSP + 0
        MOV       R1,?XSP + 1
        MOV       ?V2,R0
        MOV       ?V3,R1
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 38)
        MOV       R4,#0x18
        MOV       R5,#0x0
        MOV       A,R6
        MOV       R0,A
        MOV       R1,#0x0
        MOV       A,R0
        ADD       A,#0x1
        MOV       R2,A
        MOV       A,R1
        ADDC      A,#0x2
        MOV       R3,A
        LCALL     `??osal_nv_item_init::?relay`; Banked call to: osal_nv_item_init
        MOV       A,#0x2
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 36)
        MOV       A,R1
        MOV       R7,A
// 3538 
// 3539 #if defined ( NV_RESTORE )
// 3540   // If the set default is requested, the APS Link key needs to be erased, regardless of the NV_RESTORE enabled
// 3541       if ((status == SUCCESS) && (setDefault == TRUE ))
        MOV       A,R7
        JNZ       ??ZDSecMgrApsLinkKeyInit_2
        MOV       A,#0x1
        XRL       A,?V0
        JNZ       ??ZDSecMgrApsLinkKeyInit_2
// 3542       {
// 3543         osal_nv_write( (ZCD_NV_APS_LINK_KEY_DATA_START + i), 0,
// 3544                       sizeof(APSME_LinkKeyData_t), &pApsLinkKey );
        ; Setup parameters for call to function osal_nv_write
        MOV       R0,?XSP + 0
        MOV       R1,?XSP + 1
        MOV       ?V2,R0
        MOV       ?V3,R1
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 38)
        MOV       ?V2,#0x18
        MOV       ?V3,#0x0
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 40)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       A,R6
        MOV       R0,A
        MOV       R1,#0x0
        MOV       A,R0
        ADD       A,#0x1
        MOV       R2,A
        MOV       A,R1
        ADDC      A,#0x2
        MOV       R3,A
        LCALL     `??osal_nv_write::?relay`; Banked call to: osal_nv_write
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 36)
        MOV       A,R1
// 3545 
// 3546       }
// 3547 #else
// 3548     // reset the values of NV items if NV_RESTORE is not enabled
// 3549     if (status == SUCCESS)
// 3550     {
// 3551       osal_nv_write( (ZCD_NV_APS_LINK_KEY_DATA_START + i), 0,
// 3552                     sizeof(APSME_LinkKeyData_t), &pApsLinkKey );
// 3553 
// 3554     }
// 3555 #endif // defined (NV_RESTORE)
// 3556   }
??ZDSecMgrApsLinkKeyInit_2:
        INC       R6
        SJMP      ??ZDSecMgrApsLinkKeyInit_0
// 3557 }
??ZDSecMgrApsLinkKeyInit_1:
        MOV       A,#0x18
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 12)
        MOV       R7,#0x4
        LJMP      ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock64
// 3558 
// 3559 
// 3560 /******************************************************************************
// 3561  * @fn          ZDSecMgrInitNVKeyTables
// 3562  *
// 3563  * @brief       Initialize the NV table for All keys: NWK, Master, TCLK and APS
// 3564  *
// 3565  * @param       setDefault - TRUE to set default values
// 3566  *
// 3567  * @return      none
// 3568  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 3569 void ZDSecMgrInitNVKeyTables(uint8 setDefault)
ZDSecMgrInitNVKeyTables:
          CFI Block cfiBlock65 Using cfiCommon0
          CFI Function ZDSecMgrInitNVKeyTables
        CODE
// 3570 {
        FUNCALL ZDSecMgrInitNVKeyTables, ZDSecMgrNwkKeyInit
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrInitNVKeyTables, ZDSecMgrApsLinkKeyInit
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrInitNVKeyTables, APSME_TCLinkKeyInit
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV       A,#-0x9
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
        MOV       A,R1
        MOV       R6,A
// 3571   ZDSecMgrNwkKeyInit(setDefault);
        ; Setup parameters for call to function ZDSecMgrNwkKeyInit
        MOV       A,R6
        MOV       R1,A
        LCALL     `??ZDSecMgrNwkKeyInit::?relay`; Banked call to: ZDSecMgrNwkKeyInit
// 3572   ZDSecMgrApsLinkKeyInit(setDefault); 
        ; Setup parameters for call to function ZDSecMgrApsLinkKeyInit
        MOV       A,R6
        MOV       R1,A
        LCALL     `??ZDSecMgrApsLinkKeyInit::?relay`; Banked call to: ZDSecMgrApsLinkKeyInit
// 3573   APSME_TCLinkKeyInit(setDefault);
        ; Setup parameters for call to function APSME_TCLinkKeyInit
        MOV       A,R6
        MOV       R1,A
        LCALL     `??APSME_TCLinkKeyInit::?relay`; Banked call to: APSME_TCLinkKeyInit
// 3574   
// 3575 #if ZG_BUILD_COORDINATOR_TYPE
// 3576   if(ZG_DEVICE_COORDINATOR_TYPE)
// 3577   {
// 3578     ZDSecMgrGenerateSeed(setDefault);
// 3579     
// 3580   }
// 3581 #endif
// 3582 }
        MOV       R7,#0x1
        LJMP      ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock65
// 3583 
// 3584 
// 3585 /******************************************************************************
// 3586  * @fn          ZDSecMgrSaveApsLinkKey
// 3587  *
// 3588  * @brief       Save APS Link Key to NV. It will loop through all the keys
// 3589  *              to see which one to save.
// 3590  *
// 3591  * @param       none
// 3592  *
// 3593  * @return      none
// 3594  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 3595 void ZDSecMgrSaveApsLinkKey(void)
ZDSecMgrSaveApsLinkKey:
          CFI Block cfiBlock66 Using cfiCommon0
          CFI Function ZDSecMgrSaveApsLinkKey
        CODE
// 3596 {
        FUNCALL ZDSecMgrSaveApsLinkKey, osal_mem_alloc
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 12, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 12, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSaveApsLinkKey, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 16, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 16, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSaveApsLinkKey, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 16, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 16, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSaveApsLinkKey, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 12, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 12, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSaveApsLinkKey, osal_mem_free
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 12, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 12, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        REQUIRE ?V2
        REQUIRE ?V3
        MOV       A,#-0xc
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 12)
        ; Saved register size: 12
        ; Auto size: 0
// 3597   APSME_LinkKeyData_t *pKeyData = NULL;
        MOV       ?V0,#0x0
        MOV       ?V1,#0x0
// 3598   int i;
// 3599 
// 3600   pKeyData = (APSME_LinkKeyData_t *)osal_mem_alloc(sizeof(APSME_LinkKeyData_t));
        ; Setup parameters for call to function osal_mem_alloc
        MOV       R2,#0x18
        MOV       R3,#0x0
        LCALL     `??osal_mem_alloc::?relay`; Banked call to: osal_mem_alloc
        MOV       ?V2,R2
        MOV       ?V3,R3
        MOV       ?V0,?V2
        MOV       ?V1,?V3
// 3601 
// 3602   if (pKeyData != NULL)
        MOV       A,?V0
        ORL       A,?V1
        JNZ       $+5
        LJMP      ??ZDSecMgrSaveApsLinkKey_0 & 0xFFFF
// 3603   {
// 3604     // checks all pending flags to know which one to save
// 3605     for (i = 0; i < ZDSECMGR_ENTRY_MAX; i++)
        MOV       R6,#0x0
        MOV       R7,#0x0
??ZDSecMgrSaveApsLinkKey_1:
        CLR       C
        MOV       A,R6
        SUBB      A,#0x3
        MOV       A,R7
        SUBB      A,#0x0
        MOV       C,0xD0 /* PSW */.2
        XRL       A,PSW
        RLC       A
        JC        $+5
        LJMP      ??ZDSecMgrSaveApsLinkKey_2 & 0xFFFF
// 3606     {
// 3607       if (ApsLinkKeyFrmCntr[i].pendingFlag == TRUE)
        MOV       A,R6
        MOV       R0,A
        MOV       A,R7
        MOV       R1,A
        MOV       A,R0
        MOV       B,#0x9
        MUL       AB
        XCH       A,R0
        MOV       R2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R2
        MOV       R2,A
        MOV       B,#0x9
        MOV       A,R1
        MUL       AB
        ADD       A,R2
        MOV       R1,A
        MOV       A,#(ApsLinkKeyFrmCntr + 8) & 0xff
        ADD       A,R0
        MOV       DPL,A
        MOV       A,#((ApsLinkKeyFrmCntr + 8) >> 8) & 0xff
        ADDC      A,R1
        MOV       DPH,A
        MOVX      A,@DPTR
        XRL       A,#0x1
        JZ        $+5
        LJMP      ??ZDSecMgrSaveApsLinkKey_3 & 0xFFFF
// 3608       {
// 3609         // retrieve key from NV
// 3610         if (osal_nv_read(ZCD_NV_APS_LINK_KEY_DATA_START + i, 0,
// 3611                          sizeof(APSME_LinkKeyData_t), pKeyData) == SUCCESS)
        ; Setup parameters for call to function osal_nv_read
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 14)
        MOV       ?V2,#0x18
        MOV       ?V3,#0x0
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 16)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       A,R6
        ADD       A,#0x1
        MOV       R2,A
        MOV       A,R7
        ADDC      A,#0x2
        MOV       R3,A
        LCALL     `??osal_nv_read::?relay`; Banked call to: osal_nv_read
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 12)
        MOV       A,R1
        JZ        $+5
        LJMP      ??ZDSecMgrSaveApsLinkKey_3 & 0xFFFF
// 3612         {
// 3613           pKeyData->txFrmCntr = ApsLinkKeyFrmCntr[i].txFrmCntr;
        MOV       A,R6
        MOV       R0,A
        MOV       A,R7
        MOV       R1,A
        MOV       A,R0
        MOV       B,#0x9
        MUL       AB
        XCH       A,R0
        MOV       R2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R2
        MOV       R2,A
        MOV       B,#0x9
        MOV       A,R1
        MUL       AB
        ADD       A,R2
        MOV       R1,A
        MOV       A,#ApsLinkKeyFrmCntr & 0xff
        ADD       A,R0
        MOV       DPL,A
        MOV       A,#(ApsLinkKeyFrmCntr >> 8) & 0xff
        ADDC      A,R1
        MOV       DPH,A
        LCALL     ?XLOAD_R0123
        MOV       A,?V0
        ADD       A,#0x10
        MOV       DPL,A
        CLR       A
        ADDC      A,?V1
        MOV       DPH,A
        LCALL     ?XSTORE_R0123
// 3614           pKeyData->rxFrmCntr = ApsLinkKeyFrmCntr[i].rxFrmCntr;
        MOV       A,R6
        MOV       R0,A
        MOV       A,R7
        MOV       R1,A
        MOV       A,R0
        MOV       B,#0x9
        MUL       AB
        XCH       A,R0
        MOV       R2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R2
        MOV       R2,A
        MOV       B,#0x9
        MOV       A,R1
        MUL       AB
        ADD       A,R2
        MOV       R1,A
        MOV       A,#(ApsLinkKeyFrmCntr + 4) & 0xff
        ADD       A,R0
        MOV       DPL,A
        MOV       A,#((ApsLinkKeyFrmCntr + 4) >> 8) & 0xff
        ADDC      A,R1
        MOV       DPH,A
        LCALL     ?XLOAD_R0123
        MOV       A,?V0
        ADD       A,#0x14
        MOV       DPL,A
        CLR       A
        ADDC      A,?V1
        MOV       DPH,A
        LCALL     ?XSTORE_R0123
// 3615 
// 3616           // Write the APS link key back to the NV
// 3617           osal_nv_write(ZCD_NV_APS_LINK_KEY_DATA_START + i, 0,
// 3618                         sizeof(APSME_LinkKeyData_t), pKeyData);
        ; Setup parameters for call to function osal_nv_write
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 14)
        MOV       ?V2,#0x18
        MOV       ?V3,#0x0
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 16)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       A,R6
        ADD       A,#0x1
        MOV       R2,A
        MOV       A,R7
        ADDC      A,#0x2
        MOV       R3,A
        LCALL     `??osal_nv_write::?relay`; Banked call to: osal_nv_write
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 12)
        MOV       A,R1
// 3619 
// 3620           // clear the pending write flag
// 3621           ApsLinkKeyFrmCntr[i].pendingFlag = FALSE;
        MOV       A,R6
        MOV       R0,A
        MOV       A,R7
        MOV       R1,A
        MOV       A,R0
        MOV       B,#0x9
        MUL       AB
        XCH       A,R0
        MOV       R2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R2
        MOV       R2,A
        MOV       B,#0x9
        MOV       A,R1
        MUL       AB
        ADD       A,R2
        MOV       R1,A
        MOV       A,#(ApsLinkKeyFrmCntr + 8) & 0xff
        ADD       A,R0
        MOV       DPL,A
        MOV       A,#((ApsLinkKeyFrmCntr + 8) >> 8) & 0xff
        ADDC      A,R1
        MOV       DPH,A
        MOV       A,#0x0
        MOVX      @DPTR,A
// 3622         }
// 3623       }
// 3624     }
??ZDSecMgrSaveApsLinkKey_3:
        INC       R6
        MOV       A,R6
        JNZ       ??ZDSecMgrSaveApsLinkKey_4
        INC       R7
??ZDSecMgrSaveApsLinkKey_4:
        LJMP      ??ZDSecMgrSaveApsLinkKey_1 & 0xFFFF
// 3625 
// 3626     // clear copy of key in RAM
// 3627     osal_memset( pKeyData, 0x00, sizeof(APSME_LinkKeyData_t) );
??ZDSecMgrSaveApsLinkKey_2:
        ; Setup parameters for call to function osal_memset
        MOV       R4,#0x18
        MOV       R5,#0x0
        MOV       R1,#0x0
        MOV       R2,?V0
        MOV       R3,?V1
        LCALL     `??osal_memset::?relay`; Banked call to: osal_memset
// 3628 
// 3629     osal_mem_free(pKeyData);
        ; Setup parameters for call to function osal_mem_free
        MOV       R2,?V0
        MOV       R3,?V1
        LCALL     `??osal_mem_free::?relay`; Banked call to: osal_mem_free
// 3630   }
// 3631 }
??ZDSecMgrSaveApsLinkKey_0:
        MOV       R7,#0x4
        LJMP      ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock66
// 3632 
// 3633 /******************************************************************************
// 3634  * @fn          ZDSecMgrSaveTCLinkKey
// 3635  *
// 3636  * @brief       Save TC Link Key to NV. It will loop through all the keys
// 3637  *              to see which one to save.
// 3638  *
// 3639  * @param       none
// 3640  *
// 3641  * @return      none
// 3642  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 3643 void ZDSecMgrSaveTCLinkKey(void)
ZDSecMgrSaveTCLinkKey:
          CFI Block cfiBlock67 Using cfiCommon0
          CFI Function ZDSecMgrSaveTCLinkKey
        CODE
// 3644 {
        FUNCALL ZDSecMgrSaveTCLinkKey, osal_mem_alloc
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 12, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 12, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSaveTCLinkKey, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 16, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 16, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSaveTCLinkKey, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 16, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 16, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSaveTCLinkKey, osal_mem_free
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 12, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 12, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        REQUIRE ?V2
        REQUIRE ?V3
        MOV       A,#-0xc
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 12)
        ; Saved register size: 12
        ; Auto size: 0
// 3645   APSME_TCLKDevEntry_t *pKeyData = NULL;
        MOV       ?V0,#0x0
        MOV       ?V1,#0x0
// 3646   uint16 i;
// 3647 
// 3648   pKeyData = (APSME_TCLKDevEntry_t *)osal_mem_alloc(sizeof(APSME_TCLKDevEntry_t));
        ; Setup parameters for call to function osal_mem_alloc
        MOV       R2,#0x13
        MOV       R3,#0x0
        LCALL     `??osal_mem_alloc::?relay`; Banked call to: osal_mem_alloc
        MOV       ?V2,R2
        MOV       ?V3,R3
        MOV       ?V0,?V2
        MOV       ?V1,?V3
// 3649 
// 3650   if (pKeyData != NULL)
        MOV       A,?V0
        ORL       A,?V1
        JNZ       $+5
        LJMP      ??ZDSecMgrSaveTCLinkKey_0 & 0xFFFF
// 3651   {
// 3652     for( i = 0; i < gZDSECMGR_TC_DEVICE_MAX; i++ )
        MOV       R6,#0x0
        MOV       R7,#0x0
??ZDSecMgrSaveTCLinkKey_1:
        MOV       DPTR,#gZDSECMGR_TC_DEVICE_MAX
        CLR       A
        MOVC      A,@A+DPTR
        MOV       R0,A
        MOV       A,#0x1
        MOVC      A,@A+DPTR
        MOV       R1,A
        CLR       C
        MOV       A,R6
        SUBB      A,R0
        MOV       A,R7
        SUBB      A,R1
        JC        $+5
        LJMP      ??ZDSecMgrSaveTCLinkKey_2 & 0xFFFF
// 3653     {
// 3654       if (TCLinkKeyFrmCntr[i].pendingFlag == TRUE)
        MOV       A,R6
        MOV       R0,A
        MOV       A,R7
        MOV       R1,A
        MOV       A,R0
        MOV       B,#0x9
        MUL       AB
        XCH       A,R0
        MOV       R2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R2
        MOV       R2,A
        MOV       B,#0x9
        MOV       A,R1
        MUL       AB
        ADD       A,R2
        MOV       R1,A
        MOV       A,#(TCLinkKeyFrmCntr + 8) & 0xff
        ADD       A,R0
        MOV       DPL,A
        MOV       A,#((TCLinkKeyFrmCntr + 8) >> 8) & 0xff
        ADDC      A,R1
        MOV       DPH,A
        MOVX      A,@DPTR
        XRL       A,#0x1
        JZ        $+5
        LJMP      ??ZDSecMgrSaveTCLinkKey_3 & 0xFFFF
// 3655       {
// 3656         if (osal_nv_read(ZCD_NV_TCLK_TABLE_START + i, 0,
// 3657                          sizeof(APSME_TCLKDevEntry_t), pKeyData) == SUCCESS)
        ; Setup parameters for call to function osal_nv_read
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 14)
        MOV       ?V2,#0x13
        MOV       ?V3,#0x0
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 16)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       A,R6
        ADD       A,#0x11
        MOV       R2,A
        MOV       A,R7
        ADDC      A,#0x1
        MOV       R3,A
        LCALL     `??osal_nv_read::?relay`; Banked call to: osal_nv_read
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 12)
        MOV       A,R1
        JZ        $+5
        LJMP      ??ZDSecMgrSaveTCLinkKey_3 & 0xFFFF
// 3658         {
// 3659           pKeyData->txFrmCntr = TCLinkKeyFrmCntr[i].txFrmCntr;
        MOV       A,R6
        MOV       R0,A
        MOV       A,R7
        MOV       R1,A
        MOV       A,R0
        MOV       B,#0x9
        MUL       AB
        XCH       A,R0
        MOV       R2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R2
        MOV       R2,A
        MOV       B,#0x9
        MOV       A,R1
        MUL       AB
        ADD       A,R2
        MOV       R1,A
        MOV       A,#TCLinkKeyFrmCntr & 0xff
        ADD       A,R0
        MOV       DPL,A
        MOV       A,#(TCLinkKeyFrmCntr >> 8) & 0xff
        ADDC      A,R1
        MOV       DPH,A
        LCALL     ?XLOAD_R0123
        MOV       DPL,?V0
        MOV       DPH,?V1
        LCALL     ?XSTORE_R0123
// 3660           pKeyData->rxFrmCntr = TCLinkKeyFrmCntr[i].rxFrmCntr;
        MOV       A,R6
        MOV       R0,A
        MOV       A,R7
        MOV       R1,A
        MOV       A,R0
        MOV       B,#0x9
        MUL       AB
        XCH       A,R0
        MOV       R2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R2
        MOV       R2,A
        MOV       B,#0x9
        MOV       A,R1
        MUL       AB
        ADD       A,R2
        MOV       R1,A
        MOV       A,#(TCLinkKeyFrmCntr + 4) & 0xff
        ADD       A,R0
        MOV       DPL,A
        MOV       A,#((TCLinkKeyFrmCntr + 4) >> 8) & 0xff
        ADDC      A,R1
        MOV       DPH,A
        LCALL     ?XLOAD_R0123
        MOV       DPL,?V0
        MOV       DPH,?V1
        INC       DPTR
        INC       DPTR
        INC       DPTR
        INC       DPTR
        LCALL     ?XSTORE_R0123
// 3661 
// 3662           // Write the TC link key back to the NV
// 3663           osal_nv_write(ZCD_NV_TCLK_TABLE_START + i, 0,
// 3664                         sizeof(APSME_TCLKDevEntry_t), pKeyData);
        ; Setup parameters for call to function osal_nv_write
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 14)
        MOV       ?V2,#0x13
        MOV       ?V3,#0x0
        MOV       R0,#?V2
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 16)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       A,R6
        ADD       A,#0x11
        MOV       R2,A
        MOV       A,R7
        ADDC      A,#0x1
        MOV       R3,A
        LCALL     `??osal_nv_write::?relay`; Banked call to: osal_nv_write
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 12)
        MOV       A,R1
// 3665 
// 3666           // clear the pending write flag
// 3667           TCLinkKeyFrmCntr[i].pendingFlag = FALSE;
        MOV       A,R6
        MOV       R0,A
        MOV       A,R7
        MOV       R1,A
        MOV       A,R0
        MOV       B,#0x9
        MUL       AB
        XCH       A,R0
        MOV       R2,B
        MOV       B,#0x0
        MUL       AB
        ADD       A,R2
        MOV       R2,A
        MOV       B,#0x9
        MOV       A,R1
        MUL       AB
        ADD       A,R2
        MOV       R1,A
        MOV       A,#(TCLinkKeyFrmCntr + 8) & 0xff
        ADD       A,R0
        MOV       DPL,A
        MOV       A,#((TCLinkKeyFrmCntr + 8) >> 8) & 0xff
        ADDC      A,R1
        MOV       DPH,A
        MOV       A,#0x0
        MOVX      @DPTR,A
// 3668         }
// 3669       }
// 3670     }
??ZDSecMgrSaveTCLinkKey_3:
        INC       R6
        MOV       A,R6
        JNZ       ??ZDSecMgrSaveTCLinkKey_4
        INC       R7
??ZDSecMgrSaveTCLinkKey_4:
        LJMP      ??ZDSecMgrSaveTCLinkKey_1 & 0xFFFF
// 3671 
// 3672     osal_mem_free(pKeyData);
??ZDSecMgrSaveTCLinkKey_2:
        ; Setup parameters for call to function osal_mem_free
        MOV       R2,?V0
        MOV       R3,?V1
        LCALL     `??osal_mem_free::?relay`; Banked call to: osal_mem_free
// 3673   }
// 3674 }
??ZDSecMgrSaveTCLinkKey_0:
        MOV       R7,#0x4
        LJMP      ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock67
// 3675 
// 3676 /******************************************************************************
// 3677  * @fn          ZDSecMgrUpdateTCAddress
// 3678  *
// 3679  * @brief       Update Trust Center address and save to NV.
// 3680  *
// 3681  * @param       extAddr - [in] extended address or NULL if no TC protected
// 3682  *
// 3683  * @return      none
// 3684  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 3685 void ZDSecMgrUpdateTCAddress( uint8 *extAddr )
ZDSecMgrUpdateTCAddress:
          CFI Block cfiBlock68 Using cfiCommon0
          CFI Function ZDSecMgrUpdateTCAddress
        CODE
// 3686 {
        FUNCALL ZDSecMgrUpdateTCAddress, APSME_SetRequest
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 18, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrUpdateTCAddress, sAddrExtCpy
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 18, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrUpdateTCAddress, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        MOV       A,#-0xa
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 10)
        ; Saved register size: 10
        ; Auto size: 8
        MOV       A,#-0x8
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 18)
        MOV       A,R2
        MOV       R6,A
        MOV       A,R3
        MOV       R7,A
// 3687   uint8 noTCAddress[Z_EXTADDR_LEN] = { 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF };
        MOV       DPTR,#`?<Constant {255, 255, 255, 255, 255, 255, 255,`
        MOV       R4,?XSP + 0
        MOV       R5,?XSP + 1
        MOV       A,#0x8
        LCALL     ?MOVE_LONG8_XDATA_XDATA
// 3688   APSME_SetRequest( apsTrustCenterAddress, 0, ( extAddr != NULL) ? extAddr : noTCAddress );
        MOV       A,R6
        ORL       A,R7
        JZ        ??ZDSecMgrUpdateTCAddress_0
        MOV       A,R6
        MOV       R4,A
        MOV       A,R7
        MOV       R5,A
        SJMP      ??ZDSecMgrUpdateTCAddress_1
??ZDSecMgrUpdateTCAddress_0:
        MOV       R0,?XSP + 0
        MOV       R1,?XSP + 1
        MOV       ?V0,R0
        MOV       ?V1,R1
        MOV       R4,?V0
        MOV       R5,?V1
??ZDSecMgrUpdateTCAddress_1:
        ; Setup parameters for call to function APSME_SetRequest
        MOV       R2,#0x0
        MOV       R3,#0x0
        MOV       R1,#-0x55
        LCALL     `??APSME_SetRequest::?relay`; Banked call to: APSME_SetRequest
        MOV       A,R1
// 3689   osal_cpyExtAddr( zgApsTrustCenterAddr, ( extAddr != NULL) ? extAddr : noTCAddress );
        MOV       A,R6
        ORL       A,R7
        JZ        ??ZDSecMgrUpdateTCAddress_2
        MOV       A,R6
        MOV       R4,A
        MOV       A,R7
        MOV       R5,A
        SJMP      ??ZDSecMgrUpdateTCAddress_3
??ZDSecMgrUpdateTCAddress_2:
        MOV       R0,?XSP + 0
        MOV       R1,?XSP + 1
        MOV       ?V0,R0
        MOV       ?V1,R1
        MOV       R4,?V0
        MOV       R5,?V1
??ZDSecMgrUpdateTCAddress_3:
        ; Setup parameters for call to function sAddrExtCpy
        MOV       R2,#zgApsTrustCenterAddr & 0xff
        MOV       R3,#(zgApsTrustCenterAddr >> 8) & 0xff
        LCALL     `??sAddrExtCpy::?relay`; Banked call to: sAddrExtCpy
// 3690   
// 3691 #if defined ( NV_RESTORE )
// 3692   osal_nv_write( ZCD_NV_TRUSTCENTER_ADDR, 0, Z_EXTADDR_LEN, zgApsTrustCenterAddr );
        ; Setup parameters for call to function osal_nv_write
        MOV       ?V0,#zgApsTrustCenterAddr & 0xff
        MOV       ?V1,#(zgApsTrustCenterAddr >> 8) & 0xff
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 20)
        MOV       ?V0,#0x8
        MOV       ?V1,#0x0
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 22)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       R2,#0x71
        MOV       R3,#0x0
        LCALL     `??osal_nv_write::?relay`; Banked call to: osal_nv_write
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 18)
        MOV       A,R1
// 3693 #endif
// 3694 }
        MOV       A,#0x8
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 10)
        MOV       R7,#0x2
        LJMP      ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock68
// 3695 
// 3696 #if defined ( ZBA_FALLBACK_NWKKEY )
// 3697 /******************************************************************************
// 3698  * @fn          ZDSecMgrFallbackNwkKey
// 3699  *
// 3700  * @brief       Use the ZBA fallback network key.
// 3701  *
// 3702  * @param       none
// 3703  *
// 3704  * @return      none
// 3705  */
// 3706 void ZDSecMgrFallbackNwkKey( void )
// 3707 {
// 3708   if ( !_NIB.nwkKeyLoaded )
// 3709   {
// 3710     uint8 fallbackKey[SEC_KEY_LEN];
// 3711 
// 3712     ZDSecMgrReadKeyFromNv( ZCD_NV_PRECFGKEY, fallbackKey );
// 3713     SSP_UpdateNwkKey( fallbackKey, 0);
// 3714     SSP_SwitchNwkKey( 0 );
// 3715 
// 3716     // clear local copy of key
// 3717     osal_memset( fallbackKey, 0x00, SEC_KEY_LEN );
// 3718 
// 3719     // handle next step in authentication process
// 3720     ZDSecMgrAuthNwkKey();
// 3721   }
// 3722 }
// 3723 #endif // defined ( ZBA_FALLBACK_NWKKEY )
// 3724 
// 3725 #if defined ( NV_RESTORE )
// 3726 /******************************************************************************
// 3727  * @fn          ZDSecMgrClearNVKeyValues
// 3728  *
// 3729  * @brief       If NV_RESTORE is enabled and the status of the network needs
// 3730  *              default values this fuction clears ZCD_NV_NWKKEY,
// 3731  *              ZCD_NV_NWK_ACTIVE_KEY_INFO and ZCD_NV_NWK_ALTERN_KEY_INFO link
// 3732  *
// 3733  * @param       none
// 3734  *
// 3735  * @return      none
// 3736  */

        RSEG BANKED_CODE:HUGECODE:NOROOT(0)
// 3737 void ZDSecMgrClearNVKeyValues(void)
ZDSecMgrClearNVKeyValues:
          CFI Block cfiBlock69 Using cfiCommon0
          CFI Function ZDSecMgrClearNVKeyValues
        CODE
// 3738 {
        FUNCALL ZDSecMgrClearNVKeyValues, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 48, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 48, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrClearNVKeyValues, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 52, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 52, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrClearNVKeyValues, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 48, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 48, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrClearNVKeyValues, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 52, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 52, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrClearNVKeyValues, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 52, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 52, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        MOV       A,#-0xa
        LCALL     ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 10)
        ; Saved register size: 10
        ; Auto size: 38
        MOV       A,#-0x26
        LCALL     ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 48)
// 3739   nwkActiveKeyItems keyItems;
// 3740   nwkKeyDesc nwkKey;
// 3741 
// 3742   osal_memset(&keyItems, 0x00, sizeof(nwkActiveKeyItems));
        ; Setup parameters for call to function osal_memset
        MOV       R4,#0x15
        MOV       R5,#0x0
        MOV       R1,#0x0
        MOV       A,#0x11
        LCALL     ?XSTACK_DISP101_8
        LCALL     `??osal_memset::?relay`; Banked call to: osal_memset
// 3743 
// 3744   osal_nv_write(ZCD_NV_NWKKEY, 0, sizeof(nwkActiveKeyItems), &keyItems);
        ; Setup parameters for call to function osal_nv_write
        MOV       A,#0x11
        LCALL     ?XSTACK_DISP100_8
        MOV       ?V0,R0
        MOV       ?V1,R1
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 50)
        MOV       ?V0,#0x15
        MOV       ?V1,#0x0
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 52)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       R2,#-0x7e
        MOV       R3,#0x0
        LCALL     `??osal_nv_write::?relay`; Banked call to: osal_nv_write
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 48)
        MOV       A,R1
// 3745 
// 3746   // Initialize NV items for NWK Active and Alternate keys.
// 3747   osal_memset( &nwkKey, 0x00, sizeof(nwkKeyDesc) );
        ; Setup parameters for call to function osal_memset
        MOV       R4,#0x11
        MOV       R5,#0x0
        MOV       R1,#0x0
        MOV       R2,?XSP + 0
        MOV       R3,?XSP + 1
        LCALL     `??osal_memset::?relay`; Banked call to: osal_memset
// 3748 
// 3749   osal_nv_write(ZCD_NV_NWK_ACTIVE_KEY_INFO, 0, sizeof(nwkKeyDesc), &nwkKey);
        ; Setup parameters for call to function osal_nv_write
        MOV       R0,?XSP + 0
        MOV       R1,?XSP + 1
        MOV       ?V0,R0
        MOV       ?V1,R1
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 50)
        MOV       ?V0,#0x11
        MOV       ?V1,#0x0
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 52)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       R2,#0x3a
        MOV       R3,#0x0
        LCALL     `??osal_nv_write::?relay`; Banked call to: osal_nv_write
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 48)
        MOV       A,R1
// 3750 
// 3751   osal_nv_write(ZCD_NV_NWK_ALTERN_KEY_INFO, 0, sizeof(nwkKeyDesc), &nwkKey);
        ; Setup parameters for call to function osal_nv_write
        MOV       R0,?XSP + 0
        MOV       R1,?XSP + 1
        MOV       ?V0,R0
        MOV       ?V1,R1
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 50)
        MOV       ?V0,#0x11
        MOV       ?V1,#0x0
        MOV       R0,#?V0
        LCALL     ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 52)
        MOV       R4,#0x0
        MOV       R5,#0x0
        MOV       R2,#0x3b
        MOV       R3,#0x0
        LCALL     `??osal_nv_write::?relay`; Banked call to: osal_nv_write
        MOV       A,#0x4
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 48)
        MOV       A,R1
// 3752 }
        MOV       A,#0x26
        LCALL     ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 10)
        MOV       R7,#0x2
        LJMP      ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock69

        RSEG XDATA_ID:CODE:NOROOT(0)
`?<Initializer for requestNewTrustCenterLinkKey`:
        DATA8
        DB 1

        RSEG XDATA_ID:CODE:NOROOT(0)
`?<Initializer for requestLinkKeyTimeout>`:
        DATA32
        DD 5000

        RSEG XDATA_ID:CODE:NOROOT(0)
`?<Initializer for ZDSecMgrAppKeyType>`:
        DATA8
        DB 3

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrAddrStore::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrAddrStore

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrExtAddrStore::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrExtAddrStore

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrExtAddrLookup::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrExtAddrLookup

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrAddrClear::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrAddrClear

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrEntryInit::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrEntryInit

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrEntryLookup::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrEntryLookup

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrEntryLookupAMI::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrEntryLookupAMI

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrEntryLookupExt::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrEntryLookupExt

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrEntryLookupExtGetIndex::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrEntryLookupExtGetIndex

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrEntryLookupAMIGetIndex::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrEntryLookupAMIGetIndex

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrEntryFree::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrEntryFree

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrEntryNew::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrEntryNew

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrAppKeyGet::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrAppKeyGet

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrAppKeyReq::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrAppKeyReq

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrTclkReq::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrTclkReq

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrAppConfKeyReq::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrAppConfKeyReq

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrSendNwkKey::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrSendNwkKey

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrDeviceRemoveByExtAddr::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrDeviceRemoveByExtAddr

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrDeviceRemove::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrDeviceRemove

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrDeviceValidateRM::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrDeviceValidateRM

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrDeviceValidate::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrDeviceValidate

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrDeviceJoin::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrDeviceJoin

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrDeviceJoinDirect::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrDeviceJoinDirect

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrDeviceJoinFwd::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrDeviceJoinFwd

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrDeviceNew::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrDeviceNew

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrAssocDeviceAuth::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrAssocDeviceAuth

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrAuthNwkKey::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrAuthNwkKey

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrInit::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrInit

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrConfig::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrConfig

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrPermitJoining::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrPermitJoining

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrPermitJoiningTimeout::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrPermitJoiningTimeout

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrNewDeviceEvent::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrNewDeviceEvent

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrTCExtAddrCheck::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrTCExtAddrCheck

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrTCDataLoad::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrTCDataLoad

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrTransportKeyInd::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrTransportKeyInd

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrUpdateDeviceInd::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrUpdateDeviceInd

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrRemoveDeviceInd::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrRemoveDeviceInd

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrRequestKeyInd::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrRequestKeyInd

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrVerifyKeyInd::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrVerifyKeyInd

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrSwitchKeyInd::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrSwitchKeyInd

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrGenerateSeed::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrGenerateSeed

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrGenerateKeyFromSeed::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrGenerateKeyFromSeed

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrGenerateRndKey::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrGenerateRndKey

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrRequestAppKey::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrRequestAppKey

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrSetupPartner::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrSetupPartner

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??APSME_LinkKeySet::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    APSME_LinkKeySet

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrAuthenticationSet::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrAuthenticationSet

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrAuthenticationCheck::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrAuthenticationCheck

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??APSME_LinkKeyNVIdGet::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    APSME_LinkKeyNVIdGet

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??APSME_IsLinkKeyValid::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    APSME_IsLinkKeyValid

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??APSME_KeyFwdToChild::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    APSME_KeyFwdToChild

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrAddLinkKey::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrAddLinkKey

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrInitNV::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrInitNV

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrWriteNV::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrWriteNV

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrRestoreFromNV::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrRestoreFromNV

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrSetDefaultNV::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrSetDefaultNV

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrUpdateNV::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrUpdateNV

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrAPSRemove::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrAPSRemove

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??APSME_TCLinkKeyInit::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    APSME_TCLinkKeyInit

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??APSME_TCLinkKeySync::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    APSME_TCLinkKeySync

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??APSME_TCLinkKeyLoad::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    APSME_TCLinkKeyLoad

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??APSME_IsDefaultTCLK::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    APSME_IsDefaultTCLK

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrNwkKeyInit::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrNwkKeyInit

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrReadKeyFromNv::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrReadKeyFromNv

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrApsLinkKeyInit::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrApsLinkKeyInit

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrInitNVKeyTables::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrInitNVKeyTables

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrSaveApsLinkKey::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrSaveApsLinkKey

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrSaveTCLinkKey::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrSaveTCLinkKey

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrUpdateTCAddress::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrUpdateTCAddress

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
`??ZDSecMgrClearNVKeyValues::?relay`:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrClearNVKeyValues

        RSEG XDATA_ROM_C:CONST:REORDER:NOROOT(0)
        DATA8
`?<Constant {255, 255, 255, 255, 255, 255, 255,`:
        DB 255
        DB 255
        DB 255
        DB 255
        DB 255
        DB 255
        DB 255
        DB 255

        RSEG XDATA_ROM_C:CONST:REORDER:NOROOT(0)
        DATA32
__Constant_3e9:
        DD 1001

        RSEG XDATA_ROM_C:CONST:REORDER:NOROOT(0)
        DATA32
__Constant_b:
        DD 11

        RSEG XDATA_ROM_C:CONST:REORDER:NOROOT(0)
        DATA32
__Constant_1:
        DD 1

        RSEG XDATA_ROM_C:CONST:REORDER:NOROOT(0)
        DATA32
__Constant_a:
        DD 10

        END
// 3753 #endif // defined ( NV_RESTORE )
// 3754 
// 3755 /******************************************************************************
// 3756 ******************************************************************************/
// 
// 14 196 bytes in segment BANKED_CODE
//    420 bytes in segment BANK_RELAYS
//      4 bytes in segment CODE_C
//      6 bytes in segment XDATA_I
//      6 bytes in segment XDATA_ID
//     24 bytes in segment XDATA_ROM_C
//     87 bytes in segment XDATA_Z
// 
//    430 bytes of CODE     memory
//      8 bytes of CONST    memory (+ 16 bytes shared)
// 14 196 bytes of HUGECODE memory
//     93 bytes of XDATA    memory
//
//Errors: none
//Warnings: none
